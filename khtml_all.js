// --------------------------------------------------------------------------------------------
// khtml javascript library
// --------------------------------------------------------------------------------------------
// (C) Copyright 2010-2011 by Bernhard Zwischenbrugger, Florian Hengartner, Stefan Kemper
//
// Project Info:  http://www.khtml.org
//				  http://www.khtml.org/iphonemap/help.php
//
// This library is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
// 
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU Lesser General Public License for more details.
// 
// You should have received a copy of the GNU Lesser General Public License
// along with this library.  If not, see <http://www.gnu.org/licenses/>.
// --------------------------------------------------------------------------------------------
var khtml={};khtml.maplib={};khtml.maplib.base={};khtml.maplib.geometry={};khtml.maplib.overlay={};khtml.maplib.overlay.renderer={};khtml.maplib.parser={};khtml.maplib.ui={};khtml.maplib.util={};khtml.maplib.overlay.renderer={};khtml.maplib.version=function(){return"khtmlib_hsr v0.02"};khtml.maplib.Map=function(a){return new khtml.maplib.base.Map(a)};khtml.maplib.LatLng=function(a,b){return new khtml.maplib.geometry.LatLng(a,b)};khtml.maplib.standardimagepath="http://maplib.khtml.org/img/";khtml.maplib.base.helpers={};khtml.maplib.base.helpers.parseXml=function(a){var b;window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)):document.implementation&&document.implementation.createDocument&&(b=(new DOMParser).parseFromString(a,"text/xml"));return b};
khtml.maplib.base.helpers.contains=function(a,b){var e=[a.sw().lat(),a.ne().lat()],c=[a.sw().lng(),a.ne().lng()];return(khtml.maplib.base.helpers.between(e,b.sw().lat())||khtml.maplib.base.helpers.between(e,b.ne().lat()))&&(khtml.maplib.base.helpers.between(c,b.sw().lng())||khtml.maplib.base.helpers.between(c,b.ne().lng()))?!0:!1};khtml.maplib.base.helpers.overlaps=function(a,b){return a.sw().lng()>b.ne().lng()||a.ne().lng()<b.sw().lng()||a.sw().lat()>b.ne().lat()||a.ne().lat()<b.sw().lat()?!1:!0};
khtml.maplib.base.helpers.overlapsBuggy=function(a,b){var e=[a.sw().lat(),a.ne().lat()],c=[a.sw().lng(),a.ne().lng()],f=[b.sw().lat(),b.ne().lat()],d=[b.sw().lng(),b.ne().lng()];return(khtml.maplib.base.helpers.between(e,b.sw().lat())||khtml.maplib.base.helpers.between(e,b.ne().lat()))&&(khtml.maplib.base.helpers.between(c,b.sw().lng())||khtml.maplib.base.helpers.between(c,b.ne().lng()))||(khtml.maplib.base.helpers.between(f,a.sw().lat())||khtml.maplib.base.helpers.between(f,a.ne().lat()))&&(khtml.maplib.base.helpers.between(d,
a.sw().lng())||khtml.maplib.base.helpers.between(d,a.ne().lng()))?!0:!1};
khtml.maplib.base.helpers.extendBBox=function(a,b){if(!(a instanceof khtml.maplib.geometry.Bounds)){var e=new khtml.maplib.geometry.LatLng(-80,-170),c=new khtml.maplib.geometry.LatLng(90,180);a=new khtml.maplib.geometry.Bounds(c,e);a.sw(c);a.ne(e)}if(!b)return a;b instanceof khtml.maplib.geometry.LatLng?a=khtml.maplib.base.helpers.extendBBoxByPoint(a,b):(a=khtml.maplib.base.helpers.extendBBoxByPoint(a,b.sw()),a=khtml.maplib.base.helpers.extendBBoxByPoint(a,b.ne()));return a};
khtml.maplib.base.helpers.extendBBoxByPoint=function(a,b){var e=a.sw().lng(),c=a.ne().lat(),f=a.sw().lat(),d=a.ne().lng();b.lat()>c&&(c=b.lat());b.lat()<f&&(f=b.lat());b.lng()<e&&(e=b.lng());b.lng()>d&&(d=b.lng());e=new khtml.maplib.geometry.LatLng(f,e);c=new khtml.maplib.geometry.LatLng(c,d);return new khtml.maplib.geometry.Bounds(e,c)};khtml.maplib.base.helpers.between=function(a,b){return a[0]<=b&&b<=a[1]?!0:!1};
khtml.maplib.base.helpers.cloneObject=function(a){var b={},e;for(e in a)b[e]=typeof a[e]=="object"?khtml.maplib.base.helpers.cloneObject(a[e]):a[e];return b};khtml.maplib.base.helpers.convertObjectToArray=function(a){for(var b=[],e=0,c=a.length;e<c;e++)b.push(a[e]);return b};
khtml.maplib.base.helpers.eventAttach=function(a,b,e,c,f){var d=arguments.length>5?$a(arguments).slice(5,arguments.length):[],g=function(g){d.unshift(g||window.event);return e.apply(c?c:a,d)};a.addEventListener?(navigator.appName.indexOf("Netscape")==-1&&b=="DOMMouseScroll"&&(b="mousewheel"),navigator.userAgent.indexOf("Safari")!=-1?b=="DOMMouseScroll"?a.onmousewheel=g:a.addEventListener(b,g,f):a.addEventListener(b,g,f)):(b=b=="DOMMouseScroll"?"onmousewheel":"on"+b,a.attachEvent(b,g));return{o:a,
type:b,fn:g,c:f}};khtml.maplib.base.helpers.eventRemove=function(a){a.o.removeEventListener&&a.o.removeEventListener(a.type,a.fn,a.c)};khtml.maplib.base.helpers.mixin=function(a,b,e){if(e)if(e instanceof Array)for(var c=0;c<e.length;c++)a[e[c]]=b[e[c]];else b[e]&&(a[e]=b[e]);else for(c in b)a[c]=b[c]};
khtml.maplib.base.helpers.showOnMap=function(a,b){var e=[];a instanceof khtml.maplib.geometry.Bounds&&(khtml.maplib.base.Log.log("Bounds"),khtml.maplib.base.Log.log("Northwest / Topleft",a.nw()),khtml.maplib.base.Log.log("Northeast / Topright",a.ne()),khtml.maplib.base.Log.log("Southeast / Bottomright",a.se()),khtml.maplib.base.Log.log("Southwest / Bottomleft",a.sw()),e.push(a.nw()),e.push(a.ne()),e.push(a.se()),e.push(a.sw()));for(var c=0;c<e.length;c++){var f=document.createElement("div");f.style.width=
"1px";f.style.height="1px";f.style.color="red";f.style["font-size"]="2em";f.textContent="X";f=new khtml.maplib.overlay.Marker(e[c],f);b.addOverlay(f)}};khtml.maplib.base.helpers.cancelEvent=function(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation()};khtml.maplib.base.helpers.stopEventPropagation=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};khtml.maplib.base.helpers.isIE=function(){return navigator.userAgent.indexOf("MSIE")!=-1};
khtml.maplib.base.helpers.isParentNodeEmpty=function(a){if(khtml.maplib.base.helpers.isIE())return a.parentNode.nodeValue==null;return!a.parentNode};
khtml.maplib.base.helpers.parseLine=function(a){if(a instanceof khtml.maplib.geometry.LatLng)return a;if(a){if(typeof a=="string")a=khtml.maplib.base.helpers.parseLineString;if(typeof a=="object"){if(typeof a[0]=="string"&&typeof a[1]=="string"&&!isNaN(parseFloat(a[0]))&&!isNaN(parseFloat(a[1]))&&a.length==2){var b=parseFloat(a[1]),e=parseFloat(a[0]),c=khtml.maplib.LatLng(b,e);return c}if(typeof a[0]=="number"&&typeof a[0]=="number"&&a.length==2)a=new khtml.maplib.LatLng(a[0],a[1]);else for(c in a){var f=
a[c];f instanceof khtml.maplib.geometry.LatLng||(b=f[1],e=f[0],a[c]=typeof b=="number"&&typeof e=="number"&&f.length==2?new khtml.maplib.LatLng(b,e):khtml.maplib.base.helpers.parseLine(a[c]))}b=a}}else b=[];return b};khtml.maplib.base.helpers.parseLineString=function(a){if(typeof a=="string"){points=[];a=a.split(" ");for(var b=0;b<a.length;b++){var e=a[b].split(",");e.length==2&&(e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),points.push(new khtml.maplib.LatLng(e[0],e[1])))}}return points};
khtml.maplib.base.helpers.parseMultiLine=function(a){if(a&&typeof a=="object")for(var b in a){var e=a[b],c;for(c in e){var f=e[c];if(!(f instanceof khtml.maplib.geometry.LatLng)){var d=f[0];f=f[1];typeof d=="number"&&typeof f=="number"&&(e[c]=new khtml.maplib.LatLng(d,f))}}}else a=[];return a};var stop=0;
khtml.maplib.base.helpers.stringify=function(a,b,e){var c=!0;typeof a.push=="undefined"&&(c=!1);for(var f="",d=b?b+1:b===!1?!1:1,g=f="",m=0;m<d-1;m++)g+="   ";b!==!1&&(g="\n"+g,f=g+"   ");m="";for(var h in a)if(h!="owner"&&typeof a[h]!="function")if(a[h]instanceof khtml.maplib.geometry.Bounds)m+=f+'"bbox":',m+="["+a[h].sw().lng()+","+a[h].sw().lat()+",",m+=""+a[h].ne().lng()+","+a[h].ne().lat()+"]",m+=",";else if(a[h]instanceof khtml.maplib.geometry.LatLng)a.type!="Marker"&&(a.type=="Point"&&(m+=
'"coordinates":'),m+="["+a[h].lng()+","+a[h].lat()+"],");else if(typeof a[h]=="string"){if((h=="type"||e)&&h!="animVal")a[h]!="Marker"&&(m+=f+'"'+h+'":"'+a[h]+'",')}else if(console.log(h,b),c||h=="type"||h=="features"||a[h]&&a[h].type=="Feature"||h=="geometry"||h=="coordinates"||h=="properties"||h=="bbox"||h=="className")console.log(h,b),m+=c?f+khtml.maplib.base.helpers.stringify(a[h],d)+",":h=="properties"?f+'"'+h+'":'+khtml.maplib.base.helpers.stringify(a[h],d)+",":f+'"'+h+'":'+khtml.maplib.base.helpers.stringify(a[h],
d,!0)+",";m=m.substring(0,m.length-1);return c?"["+m+"]":"{"+m+g+"}"};khtml.maplib.base.helpers.rotate=function(a,b){var e="rotate("+b+"deg)";a.style.webkitTransform=e;a.style.MozTransform=e;a.style.OTransform=e;if(document.all)rad=b*(Math.PI*2/360),costheta=Math.cos(rad),sintheta=Math.sin(rad),a.filters.item(0).M11=costheta,a.filters.item(0).M12=-sintheta,a.filters.item(0).M21=sintheta,a.filters.item(0).M22=costheta};
khtml.maplib.base.helpers.Boundingbox=function(a){this.map=a;this.div=document.createElement("div");this.div.style.border="1px dotted blue";this.div.style.position="absolute";this.div.style.strokeDasharray="4,4";this.div.style.zIndex=1;this.div.style.pointerEvents="none";a.mapParent.appendChild(this.div);this.show=function(a){this.div.style.display="";var c=this.map.latlngToXY(a.sw());a=this.map.latlngToXY(a.ne());this.div.style.top=a.y-parseInt(this.div.style.borderWidth)+"px";this.div.style.left=
c.x-parseInt(this.div.style.borderWidth)+"px";this.div.style.width=a.x-c.x+"px";this.div.style.height=-a.y+c.y+"px";this.div.zIndex=10};this.hide=function(){b.div.style.display="none"};var b=this;this.map.addCallbackFunction(b.hide)};khtml.maplib.base.helpers.ajaxload="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA%3D%3D";
khtml.maplib.base.helpers.close="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAA5ElEQVR42tRTQYoEIQwsl/2Bl3gQoY9eBKEf5kvyG8G7h4Z+S38gIu5lp5lZ2R7YPm1BDhZJSFWiGmPgDj5wE7cbfD4/mBkAHprUj9yTTyn9OsGIMSLG+Fxwxc8SiAi9d4QQHskjhIDeO4jorQcq5wwiQmsN3nt479FaAxEh5zxJmyZIKalSClprL1FKQUpJXZr4DBH52xqZeRhjICKw1sJaCxGBMQbMPN41GFpriAicc6i1otYK5xxEBFrraQuThGVZAADbtp2amXms6woAOI7j0gO17/t5MN+HNfEvBf//M30NAKe7aRqUOIlfAAAAAElFTkSuQmCC";
khtml.maplib.base.helpers.imageNotSelectable=function(a){a.style.MozUserSelect="none";a.style.webkitUserSelect="none";a.style.webkitUserDrag="none";a.style.KhtmlUserSelect="none";a.style.OUserSelect="none";a.style.userSelect="none"};
khtml.maplib.base.helpers.setCursor=function(a,b){if(navigator.userAgent.indexOf("MSIE")!=-1)a.style.cursor=b=="grab"?"url('"+khtml.maplib.standardimagepath+"hand.cur'), default":b=="grabbing"?"url('"+khtml.maplib.standardimagepath+"fist.cur'), move":"pointer";else if(a.style.cursor="-moz-"+b,a.style.cursor!="-moz-"+b&&(a.style.cursor="-webkit-"+b,a.style.cursor!="-webkit-"+b&&(a.style.cursor="-ms-"+b,a.style.cursor!="-ms-"+b&&(a.style.cursor="-khtml-"+b,a.style.cursor!="-khtml-"+b&&(a.style.cursor=
b,a.style.cursor!=b)))))a.style.cursor="pointer"};
khtml.maplib.base.helpers.reduceToJSON=function(a,b){console.log(a);var e=["type","features","coordinates","style","className","baseVal","geometry","fill","stroke","strokeWidth","opacity","fillOpacity","strokeOpacity","dashArray","marker","icon","shadow","url","draggable","size","origin","anchor","width","height","x","y"];if(a instanceof khtml.maplib.geometry.LatLng)return[a.lng(),a.lat()];b||(b=0);if(!(b>15)){var c={};if(typeof a=="string"||typeof a=="number")return a;if(a instanceof Array){e=[];
for(var f=0;f<a.length;f++)e[f]=khtml.maplib.base.helpers.reduceToJSON(a[f],b+1);return e}if(a instanceof CSSStyleDeclaration){e={};for(f=0;f<a.length;f++)e[a[f]]=a[a[f]];return e}for(var d in a){var g=!0;for(f=0;f<e.length;f++)if(e[f]==d){g=!1;break}g||(c[d]=typeof a[d]=="string"?a[d]:khtml.maplib.base.helpers.reduceToJSON(a[d],b+1))}return c}};khtml.maplib.base.Map=function(a){typeof a=="string"&&(a=document.getElementById(a));(typeof a!="object"||null==a)&&console.log("Error: map is null or not an object. (map: "+a+")");this.addOverlay=function(g){if(null==g||g instanceof Array)return console.log('Map.addOverlay(): Illegal argument (was "null" or "Array")'),!1;this.overlays.push(g);typeof g.init=="function"&&g.init(this);this.renderOverlay(g)};this.addOverlays=function(g){if(g instanceof Array)for(var a=0;a<g.length;a++)this.addOverlay(g[a]);
else this.addOverlay(g)};this.renderOverlay=function(g){try{g.render()}catch(a){}};this.renderOverlays=function(){this.overlayDiv.style.display="";for(obj in this.overlays)this.overlays[obj].render()};this._hideOverlays=function(){this.overlayDiv.style.display="none";for(obj in this.overlays)this.overlays[obj].hide&&this.overlays[obj].hide(f)};this.removeOverlays=function(){for(;this.overlays.length>0;)this.overlays.pop().clear()};this.stopRenderOverlays=function(){for(obj in this.overlays)typeof this.overlays[obj].cancel==
"function"&&this.overlays[obj].cancel()};this.removeOverlay=function(g){for(var a=0;a<this.overlays.length;a++)if(g==this.overlays[a]){g.clear();this.overlays.splice(a,1);break}};this.callbackFunctions=[];this.addCallbackFunction=function(g){typeof g=="function"&&this.callbackFunctions.push(g)};this._executeCallbackFunctions=function(){for(var g=0;g<this.callbackFunctions.length;g++)this.callbackFunctions[g].call(this)};this.myTimer=function(g){this.reset=function(){this._isRunning=!1};this.isTimeRunning=
function(){if(!1==this._isRunning)return!1;if(this.time+this.myInterval>(new Date).getTime())return!1;this._isRunning=!1;return!0};this.start=function(){this._isRunning=!0;this.time=(new Date).getTime()};this.interval=function(g){if(typeof g!="undefined")this.myInterval=parseInt(g);return this.myInterval};this.reset();this.interval(g);return this};this.oldMoveY=this.oldMoveX=0;this.moving=!1;this._start=function(g){g.preventDefault?g.preventDefault():g.returnValue=!1;this.moving=this.center();this.downEvent=
g;this.moveAnimationBlocked=!0;if(g.touches.length==1){this.startMoveX=this.moveX-this.pageX(g.touches[0])/this.faktor/this.sc;this.startMoveY=this.moveY-this.pageY(g.touches[0])/this.faktor/this.sc;if(this.mousedownTime!=null&&(new Date).getTime()-this.mousedownTime<this._doubleclickTime){var a=Math.ceil(0.01+this._getZoom()-this.intZoom);this._autoZoomIn(this.pageX(g.touches[0]),this.pageY(g.touches[0]),a)}this.mousedownTime=(new Date).getTime();clearTimeout(this.zoomOutInterval);this.zoomOutInterval=
window.setInterval(function(){},20)}if(g.touches.length==2){window.clearInterval(this.zoomOutInterval);this.moveok=!1;a=this.pageX(g.touches[0]);var c=this.pageY(g.touches[0]),b=this.pageX(g.touches[1]);g=this.pageY(g.touches[1]);this.startDistance=Math.sqrt(Math.pow(b-a,2)+Math.pow(g-c,2));this.startZZ=this.position.zoom;g=(c+g)/2/this.faktor/this.sc;this.startMoveX=this.moveX-(a+b)/2/this.faktor/this.sc;this.startMoveY=this.moveY-g}this.oldMoveX=this.moveX;this.oldMoveY=this.moveY};this.moveok=
!0;this._move=function(g){g.preventDefault?g.preventDefault():g.returnValue=!1;this.moveEvent=g;if(g.touches.length==1&&this.moveok){this.lastMoveX=this.moveX;this.lastMoveY=this.moveY;this.lastMoveTime=new Date(g.timeStamp);this.moveX=this.pageX(g.touches[0])/this.faktor/this.sc+this.startMoveX;this.moveY=this.pageY(g.touches[0])/this.faktor/this.sc+this.startMoveY;if(!this.zoomOutStarted){if(Math.abs(this.moveX-this.oldMoveX)>5||Math.abs(this.moveY-this.oldMoveY)>5)window.clearInterval(this.zoomOutInterval),
this.zoomOutSpeed=0.01,this.mousedownTime=null;var a=new khtml.maplib.LatLng(this.lat,this.lng);this.setCenter2(a,this.position.zoom);this.moveAnimationBlocked=!1}if(Math.abs(this.moveX-this.oldMoveX)>5||Math.abs(this.moveY-this.oldMoveY)>5)this.mousedownTime=null}if(g.touches.length==2){this.mousedownTime=null;var c=this.pageX(g.touches[0]),b=this.pageY(g.touches[0]),f=this.pageX(g.touches[1]),d=this.pageY(g.touches[1]);a=Math.sqrt(Math.pow(f-c,2)+Math.pow(d-b,2))/this.startDistance;g=this.startZZ+
a-1;g>this.tileSource.maxzoom?(g=this.tileSource.maxzoom,a=this.zoomDeltaOld):this.zoomDeltaOld=a;c=(c+f)/2;b=(b+d)/2;faktor=Math.pow(2,g);f=c/faktor-this.width/2;d=b/faktor-this.height/2;a=Math.pow(2,a-1);this.moveX=(c+(f-f*a))/faktor+this.startMoveX;this.moveY=(b+(d-d*a))/faktor+this.startMoveY;a=new khtml.maplib.LatLng(this.lat,this.lng);this.setCenter2(a,g)}};this._end=function(g){g.preventDefault?g.preventDefault():g.returnValue=!1;window.clearInterval(this.zoomOutInterval);this.zoomOutStarted=
!1;this.zoomOutSpeed=0.01;if(g.touches.length==0&&(this.moveok=!0,this.moveAnimationMobile&&this.moveAnimationBlocked==!1)){var a=new Date(g.timeStamp)-this.lastMoveTime,c=(this.lastMoveX-this.moveX)/a*4;a=(this.lastMoveY-this.moveY)/a*4;var b=this.wheelSpeedConfig.animateMaxSpeed;c>b&&(c=b);a>b&&(a=b);c<-b&&(c=-b);a<-b&&(a=-b);b=Math.pow(2,this.zoom());this._animateMove(c,a,b)}if(g.touches.length==1)this.startMoveX=this.moveX-g.touches[0].pageX/this.faktor/this.sc,this.startMoveY=this.moveY-g.touches[0].pageY/
this.faktor/this.sc};this.pageX=function(g){try{return(g.pageX===void 0?g.clientX+document.body.scrollLeft:g.pageX)-this.mapLeft}catch(a){return this.lastMouseX}};this.pageY=function(g){try{return(g.pageY===void 0?g.clientY+document.body.scrollTop:g.pageY)-this.mapTop}catch(a){return this.lastMouseY}};this.doubleclickBlocked=!1;this._doubleclick=function(g){var a;if(!g)g=window.event;g.which?a=g.which==3:g.button&&(a=g.button==2);a?this._discretZoom(-1,this.pageX(g),this.pageY(g)):this._discretZoom(1,
this.pageX(g),this.pageY(g))};this._mousedown=function(g){this.mapParent.focus();g.preventDefault?g.preventDefault():window.event.returnValue=!1;this.downEvent=g;this.lastMouseX=this.pageX(g);this.lastMouseY=this.pageY(g);this.moveAnimationBlocked=!0;if(this.mousedownTime2!=null&&(new Date).getTime()-this.mousedownTime2<this._doubleclickTime2)this._doubleclick(g);else{this.mousedownTime2=(new Date).getTime();if(g.shiftKey){this.selectRectLeft=this.pageX(g);this.selectRectTop=this.pageY(g);this.selectRect=
document.createElement("div");this.selectRect.style.left=this.selectRectLeft+"px";this.selectRect.style.top=this.selectRectTop+"px";this.selectRect.style.border="1px solid gray";if(!this.internetExplorer)this.selectRect.style.opacity=0.5,this.selectRect.style.backgroundColor="white";this.selectRect.style.position="absolute";this.map.parentNode.appendChild(this.selectRect);khtml.maplib.base.helpers.setCursor(this.mapParent,"crosshair")}else this.moving=this.center(),this.startMoveX=this.moveX-this.pageX(g)/
this.faktor/this.sc,this.startMoveY=this.moveY-this.pageY(g)/this.faktor/this.sc,this.movestarted=!0,khtml.maplib.base.helpers.setCursor(this.mapParent,"grabbing");return!1}};this._mousemove=function(g){g.preventDefault?g.preventDefault():window.event.returnValue=!1;this.moveEvent=g;this.lastMouseX=this.pageX(g);this.lastMouseY=this.pageY(g);if(g.shiftKey){if(this.selectRect){this.selectRect.style.width=Math.abs(this.pageX(g)-this.selectRectLeft)+"px";this.selectRect.style.height=Math.abs(this.pageY(g)-
this.selectRectTop)+"px";if(this.pageX(g)<this.selectRectLeft)this.selectRect.style.left=this.pageX(g)+"px";if(this.pageY(g)<this.selectRectTop)this.selectRect.style.top=this.pageY(g)+"px"}}else if(this.movestarted)this.lastMoveX=this.moveX,this.lastMoveY=this.moveY,this.lastMoveTime=new Date(g.timeStamp),this.moveX=this.pageX(g)/this.faktor/this.sc+this.startMoveX,this.moveY=this.pageY(g)/this.faktor/this.sc+this.startMoveY,this.setCenter2(new khtml.maplib.LatLng(this.lat,this.lng),this.position.zoom),
this.moveAnimationBlocked=!1;return!1};this._mouseup=function(g){khtml.maplib.base.helpers.setCursor(this.mapParent,"grab");this.lastMouseX=this.pageX(g);this.lastMouseY=this.pageY(g);if(this.moveMarker)this.moveMarker=null;if(this.selectRect){var a=this.XYTolatlng(this.selectRect.offsetLeft,this.selectRect.offsetTop+this.selectRect.offsetHeight),c=this.XYTolatlng(this.selectRect.offsetLeft+this.selectRect.offsetWidth,this.selectRect.offsetTop);this._setBounds(new khtml.maplib.geometry.Bounds(a,c));
this.selectRect.parentNode.removeChild(this.selectRect);this.selectRect=null}a=new Date(g.timeStamp)-this.lastMoveTime;if(this.wheelSpeedConfig.moveAnimateDesktop&&a!=0&&this.movestarted&&this.moveAnimationBlocked==!1)g=(this.lastMoveX-this.moveX)/a,a=(this.lastMoveY-this.moveY)/a,c=this.wheelSpeedConfig.animateMaxSpeed,g>c&&(g=c),a>c&&(a=c),g<-c&&(g=-c),a<-c&&(a=-c),c=Math.pow(2,this.zoom()),this._animateMove(g,a,c);var b=this;setTimeout(function(){b.movestarted=!1},1)};this._mouseupIE=function(g){g.preventDefault?
g.preventDefault():g.returnValue=!1;this.lastMouseX=this.pageX(g);this.lastMouseY=this.pageY(g);this.setCenter2(this.XYTolatlng(this.lastMouseX,this.lastMouseY),this.zoom())};this.startZoomTime=null;this._mousewheel=function(g){g.preventDefault?g.preventDefault():g.returnValue=!1;this.mapParent.focus();if(!g)g=window.event;if(g.wheelDelta)var a=g.wheelDelta/60;else if(g.detail)a=-g.detail/3,this.lastWheelDelta*a<0&&(this.wheelSpeedConfig.digizoom||(a=0)),this.lastWheelDelta=-g.detail/3;a=a<0?-1:1;
if(this.wheelSpeedConfig.digizoom)this._discretZoom(a,this.pageX(g),this.pageY(g));else{if(!this.startZoomTime)this.startZoomTime=new Date,this.startZoomTime2=new Date,this.oldZoom=this.zoom(),this.speed=1;var c=new Date-this.startZoomTime,b=new Date-this.startZoomTime2;this.startZoomTime=new Date;if(c>300)this.startZoomTime2=new Date,this.oldZoom=this.zoom(),this.speed=1,b=0.1;this.speed*=2;if(this.speed>5)this.speed=5;a=this.oldZoom+b/3E3*this.speed*a*(g.shiftKey?0.1:1);if(a>this.position.maxZoom)a=
this.position.maxZoom;if(a<this.position.minZoom)a=this.position.minZoom;this.centerAndZoomXY(this.center(),a,this.pageX(g),this.pageY(g))}};this._shiftkeydown=function(g){g.shiftKey&&khtml.maplib.base.helpers.setCursor(this.mapParent,"crosshair")};this._shiftkeyup=function(){khtml.maplib.base.helpers.setCursor(this.mapParent,"grab")};this.zoomTimeouts=[];this.discretZoomBlocked=!1;this._discretZoom=function(g,a,c){if(!this.discretZoomBlocked){var b=this;this.discretZoomBlockedTimeout=setTimeout(function(){b.discretZoomBlocked=
!1},200);this.discretZoomBlocked=!0;for(var f=1;f<=20;f++)this.zoomTimeouts[f]&&clearTimeout(this.zoomTimeouts[f]);f=this.zoom();var d=g==1?Math.ceil(this.zoom()+0.9):Math.floor(this.zoom()-0.9);d=Math.abs(f-d);var e=0;for(f=1;f<=20;f++){var p=g*Math.sin(f/20*Math.PI/2)*d;this.zoomTimeouts[f]=this._discretZoomExec(a,c,p-e,f,20);e=p}}};this._discretZoomExec=function(g,a,c,b,f){var d=this;return setTimeout(function(){var e=d.zoom()+c;b==f&&(e=Math.round(e));d.centerAndZoomXY(d.center(),e,g,a)},b*20)};
this.digizoomblocked=!1;this.wheelZoomTimeout=this.digizoomblockedTimeout=null;this._animateMove=function(g,a,c){clearTimeout(this.animateMoveTimeout);if(Math.abs(g)<this.wheelSpeedConfig.animateMinSpeed/c&&Math.abs(a)<this.wheelSpeedConfig.animateMinSpeed/c)this.moving=!1;else{this.moveX+=-g;this.moveY+=-a;var b=this,f=Math.sqrt(Math.pow(g,2)+Math.pow(a,2)),d=g/f,e=a/f;this.animateMoveTimeout=window.setTimeout(function(){b._animateMove(g-d*b.wheelSpeedConfig.moveAnimationSlowdown/c,a-e*b.wheelSpeedConfig.moveAnimationSlowdown/
c,c)},20)}this.setCenter2(this.position.center,this.position.zoom)};this.autoZoomStartTime=this.autoZoomInTimeout=null;this._autoZoomIn=function(g,a,c){this.autoZoomInTimeout&&window.clearTimeout(this.autoZoomInTimeout);var b=0.2;c<0&&(b=-b);zoomGap=!1;Math.abs(c)<=Math.abs(b)&&(zoomGap=!0);var f=this.position.zoom+b;f=Math.round(f*1E3)/1E3;zoomGap&&(f=c<0?Math.floor(f):Math.ceil(f-0.2),b=f-this.position.zoom);faktor=Math.pow(2,f);var d=g-this.mapLeft-this.width/2,e=a-this.mapTop-this.height/2,p=
Math.pow(2,b);d-=d*p;e-=e*p;var E=this;p=(new Date).getMilliseconds();var u=this.autoZoomStartTime?p-this.autoZoomStartTime:0;this.autoZoomStartTime=p;if(u<100||zoomGap){f>=this.tileSource.minzoom&&f<=this.tileSource.maxzoom&&(this.moveX+=d/faktor,this.moveY+=e/faktor);var t=new khtml.maplib.LatLng(this.lat,this.lng);if(f>this.tileSource.maxzoom)f=this.tileSource.maxzoom;if(f<this.tileSource.minzoom)f=this.tileSource.minzoom;setTimeout(function(){E.setCenter2(t,f)},1)}var w=c-b;zoomGap?this.digizoomblocked=
!1:this.autoZoomInTimeout=window.setTimeout(function(){E._autoZoomIn(g,a,w)},40)};this.centerAndZoomXY=function(g,a,c,b){faktor=Math.pow(2,a);g=c-this.size.width/2;b-=this.size.height/2;c=a-this.zoom();c=Math.pow(2,c);g-=g*c;b-=b*c;a>=this.tileSource.minzoom&&a<=this.tileSource.maxzoom&&(this.moveX+=g/faktor,this.moveY+=b/faktor);g=new khtml.maplib.LatLng(this.lat,this.lng);if(a>this.tileSource.maxzoom)a=this.tileSource.maxzoom;if(a<this.tileSource.minzoom)a=this.tileSource.minzoom;this.setCenter2(g,
a)};this.centerAndZoom=function(a,c){this.moveY=this.moveX=0;if(c>this.tileSource.maxzoom)c=this.tileSource.maxzoom;if(c<this.tileSource.minzoom)c=this.tileSource.minzoom;this.record();this.setCenterNoLog(a,c)};this.render=function(){this.center(this.center())};this._setCenter3=function(a,c){this.moveY=this.moveX=0;this.setCenterNoLog(a,c)};this.setCenter2=function(a,c){this.record();this.setCenterNoLog(a,c)};this.setCenterNoLog=function(a,c){this.position.center=a;this.lat=a.lat();this.lng=a.lng();
c=parseFloat(c);if(c>this.tileSource.maxzoom)c=this.tileSource.maxzoom;if(c<this.tileSource.minzoom)c=this.tileSource.minzoom;this.position.center=a;this.position.zoom=c;this.layer(this.map,this.lat,this.lng,this.moveX,this.moveY,c);this._executeCallbackFunctions();this._getBounds()};this.center=function(a){typeof a!="undefined"&&this.centerAndZoom(a,this._getZoom());if(this.moveX!=0||this.moveY!=0)return a=new khtml.maplib.LatLng(this.movedLat,this.movedLng);return this.position.center};this.zoom=
function(a){typeof a!="undefined"&&this.centerAndZoom(this.position.center,a);return this.position.zoom};this.moveXY=function(a,c){this.moveX=parseFloat(a)/this.faktor/this.sc+this.moveDelayedX;this.moveY=parseFloat(c)/this.faktor/this.sc+this.moveDelayedY;this.setCenter2(this.center(),this.zoom())};this.tiles=function(a){this.clearMap();this.tileSource=a};this.tileOverlays=[];this.addTilesOverlay=function(a){this.tileOverlays.push(a);a=this.tileOverlays[this.tileOverlays.length-1];this.clearMap();
return a};this.removeTilesOverlay=function(a){for(var c=0;c<this.tileOverlays.length;c++)if(a==this.tileOverlays[c]){this.tileOverlays.splice(c,1);break}this.clearMap()};this._getCenter=function(){if(this.moveX!=0||this.moveY!=0)var a=new khtml.maplib.LatLng(this.movedLat,this.movedLng);else if(this.position.center)a=this.position.center;return a};this.bounds=function(a){if(typeof a!="undefined")this._setBounds(a);else return this.mapBounds};this.mapBounds=null;this._getBounds=function(){var a=this.XYTolatlng(0,
this.height),c=this.XYTolatlng(this.width,0);this.mapBounds=new khtml.maplib.geometry.Bounds(a,c)};this._setBounds=function(a){if(typeof khtml.maplib.geometry.Bounds=="undefined"||!(a instanceof khtml.maplib.geometry.Bounds))return!1;var b=a.sw();a=a.ne();var f=b.lat(),d=a.lat();b=b.lng();a=a.lng();f=e(f);var l=e(d);d=(b+a)/2;var n=c((f+l)/2);d=new khtml.maplib.LatLng(n,d);f=Math.abs(l-f);b=Math.abs(a-b);b/this.width>f/this.height?a=this.width:(b=f,a=this.height);b=Math.log(360/b/(512/a))/Math.log(2)+
1;if(b>this.tileSource.maxzoom)b=this.tileSource.maxzoom;if(b<this.tileSource.minzoom)b=this.tileSource.minzoom;this.position.center?this.wheelSpeedConfig.rectShiftAnimate?this.animatedGoto(d,b,this.wheelSpeedConfig.rectShiftAnimationTime):this.centerAndZoom(d,b):this.centerAndZoom(d,b)};this.animatedGotoStep=null;this.animatedGotoTimeout=[];this.animatedGoto=function(a,c,b){b/=10;var f=this._getCenter(),d=a.lat();a=a.lng();var e=f.lat(),o=f.lng(),p=this._getZoom(),E=(d-e)/b,u=(a-o)/b,t=(c-p)/b,w=
this.moveX/b,H=this.moveY/b,I=this.moveX,x=this.moveY;this.animatedGotoStep=0;for(var z=this;timeout=this.animatedGotoTimeout.pop();)clearTimeout(timeout);for(c=0;c<=b;c++)this.animatedGotoTimeout[c]=window.setTimeout(function(){z._animatedGotoExec(e,o,p,E,u,t,I,x,w,H)},10*c)};this._animatedGotoExec=function(a,c,b,f,d,e,o,p,E,u){this.moveX=-E;this.moveY=-u;a+=f*this.animatedGotoStep;c+=d*this.animatedGotoStep;b+=e*this.animatedGotoStep;this.animatedGotoStep++;this.centerAndZoom(new khtml.maplib.LatLng(a,
c),b)};this._getZoom=function(){return this.position.zoom};this._getIntZoom=function(){return this.intZoom};this.latlngToXY=function(a){var c=a.lat(),f=a.lng();c>90&&(c-=180);c<-90&&(c+=180);a=this._getIntZoom();tileTest=b(c,f,a);c=this._getCenter();a=b(c.lat(),c.lng(),a);c=(a[0]-tileTest[0])*this.tileW*this.sc-this.width/2;f=(a[1]-tileTest[1])*this.tileW*this.sc-this.height/2;a=[];a.x=-c;a.y=-f;return a};this.XYTolatlng=function(a,f){var d=this._getCenter();if(d){var e=Math.pow(2,this.intZoom),l=
d.lat();d=d.lng();d=b(l,d,this.intZoom);l=(d[0]+(a-this.width/2)/this.tileW/this.sc)/e*360-180;e=-c((d[1]+(f-this.height/2)/this.tileH/this.sc)/e*360-180)+0;return new khtml.maplib.LatLng(e,l)}};this.mouseToLatLng=function(a){var c=this.pageX(a);a=this.pageY(a);return this.XYTolatlng(c,a)};this.reSize=function(){var a=this;window.setTimeout(function(){a._getSize(a)},1050)};this._getSize=function(){this.width=this.map.parentNode.offsetWidth;this.height=this.map.parentNode.offsetHeight;var a=this.map,
c=0,b=0;do c+=a.offsetLeft,b+=a.offsetTop,a=a.offsetParent;while(a.offsetParent);this.mapTop=b;this.mapLeft=c};this.recordArray=[];this.record=function(){var a=this._getCenter();if(a){var c=a.lat();a=a.lng();var b=this._getZoom();this.recordArray.push([c,a,b])}};this.play=function(a){if(!(a<1)&&!(a>this.recordArray.length-1)){a=this.recordArray[a];var c=new khtml.maplib.LatLng(a[0],a[1]);this.moveY=this.moveX=0;this._setCenter3(c,a[2])}};this.layerDrawLastFrame=null;this.doTheOverlays=!0;this.finalDraw=
!1;this.moveDelayedY=this.moveDelayedX=this.layerOldZoom=0;this.layerTimer=new this.myTimer(300);this.layer=function(a,c,b,f,d,e){this.stopRenderOverlays();e||(e=this._getZoom());var o=this.wheelSpeedConfig.digizoom?Math.floor(e):Math.round(e);this.layerDrawLastFrame&&window.clearTimeout(this.layerDrawLastFrame);if(this.layerTimer.isTimeRunning()||this.finalDraw==!1){var p=this;o=function(){p.finalDraw=!0;p.layer(a,c,b,f,d,e)};this.visibleZoom=parseInt(this.visibleZoom);this.visibleZoom=parseInt(this.visibleZoom);
if(!p.finalDraw)this.layerDrawLastFrame=window.setTimeout(o,100);if(this.layerTimer.isTimeRunning()){this.moveDelayedX=f;this.moveDelayedY=d;return}}this.layerTimer.start();for(o=this.moveDelayedY=this.moveDelayedX=0;o<22;o++)if(this.layers[o])this.layers[o].layerDiv.style.visibility="hidden";o=this.wheelSpeedConfig.digizoom?Math.floor(e):Math.round(e);if(this.layerOldZoom>e&&!this.finalDraw&&this.layers[o]&&!this.layers[o].loadComplete)this.visibleZoom=o+1;this.intZoom=o;if(o>this.tileSource.maxzoom)o=
this.tileSource.maxzoom;if(!this.visibleZoom)this.oldIntZoom=this.visibleZoom=o;this.faktor=Math.pow(2,o);this.sc=Math.pow(2,e-o);this.loadingZoomLevel=o;if(this.visibleZoom<o&&Math.abs(this.visibleZoom-o)<40)this.loadingZoomLevel=parseInt(this.visibleZoom)+1;this.draw(this.map,c,b,f,d,this.loadingZoomLevel,e,this.tileSource.src);this.layers[this.loadingZoomLevel].layerDiv.style.visibility="";if(o!=this.visibleZoom)this.visibleZoom<o+2?(this.draw(this.map,c,b,f,d,this.visibleZoom,e,this.tileSource.src),
this.layers[this.visibleZoom].layerDiv.style.visibility=""):this.layers[this.visibleZoom].layerDiv.style.visibility="hidden";if(o==this.visibleZoom)this.draw(this.map,c,b,f,d,this.visibleZoom-1,e,this.tileSource.src),this.layers[this.visibleZoom-1].layerDiv.style.visibility="hidden";if(this.layers[this.loadingZoomLevel].loadComplete&&this.visibleLayer!=o)this.layers[this.loadingZoomLevel].loadComplete=!1,this._hideLayer(this.visibleZoom),this.visibleZoom=this.loadingZoomLevel;this.quadtreeTimeout&&
clearTimeout(this.quadtreeTimeout);if(this.loadingZoomLevel!=o)p=this,this.quadtreeTimeout=window.setTimeout(function(){p.layer(a,c,b,f,d)},200);this.oldIntZoom!=this.intZoom&&this.oldIntZoom!=this.visibleZoom&&this._hideLayer(this.oldIntZoom);this.oldIntZoom=o;this.delayedOverlay&&window.clearTimeout(this.delayedOverlay);this.doTheOverlays||this.finalDraw||this.layerOldZoom==this.zoom()?(o=new Date,this.lastDX=this.moveX,this.lastDY=this.moveY,this.renderOverlays(),this.layerOldZoom=this.zoom(),
this.doTheOverlays=new Date-o>10&&!this.finalDraw?!1:!0):this._hideOverlays();p=this;this.layerBlockTimeout&&clearTimeout(this.layerBlockTimeout);this.layerBlockTimeout=window.setTimeout(function(){p.layerTimer.reset()},20);this.finalDraw=!1};this.draw=function(a,f,d,k,l,n,o,p){this.framesCounter++;var E=this;window.setTimeout(function(){E.framesCounter--},1E3);var u=Math.pow(2,n);if(this.layers[n])t=this.layers[n].layerDiv,w=e(f)-this.layers[n].startLat,d-=this.layers[n].startLng;else{w=b(f,d,n);
this.layers[n]=[];this.layers[n].startTileX=w[0];this.layers[n].startTileY=w[1];this.layers[n].startLat=e(f);this.layers[n].startLng=d;this.layers[n].images={};var t=document.createElement("div");t.setAttribute("zoomlevel",n);t.style.position="absolute";w=a.childNodes;a=!1;for(d=w.length-1;d>=0;d--)f=w.item(d),f.getAttribute("zoomlevel")<n&&(this.map.insertBefore(t,f),a=!0);a||this.map.appendChild(t);this.layers[n].layerDiv=t;var w=0;d=0}t.style.visibility="hidden";t.style.opacity=1;t.style.filter=
"alpha(opacity=100)";this.movedLng=(this.layers[n].startTileX/u-k/this.tileW)*360-180+d;this.movedLat=-c((this.layers[n].startTileY/u-l/this.tileH)*360-180-w);w=b(this.movedLat,this.movedLng,n);k=w[0];d=w[1];l=Math.floor(k);a=Math.floor(d);f=this.layers[n].startTileX;var H=this.layers[n].startTileY;k=k-f-(-f+Math.floor(f));var I=d-H-(-H+Math.floor(H)),x;for(x in this.layers[n].images)this.layers[n].images[x].visibility=!1;d=this.width;var z=this.height;B=Math.pow(2,o-n);minX=Math.floor(-d/2/B/this.tileW+
k);maxX=Math.ceil(d/2/B/this.tileW+k);minY=Math.floor(-z/2/B/this.tileH+I);maxY=Math.ceil(z/2/B/this.tileH+I);for(d=minX;d<maxX;d++)for(z=minY;z<maxY;z++){var y=Math.floor(f+d),q=Math.floor(H+z),C=y%u,A=q;C<0&&(C+=u);if(!(A<0)&&!(A>=u)){var F=p(C,A,n);y=F+"-"+y+"-"+q;minsc=this.wheelSpeedConfig.digizoom?1:0.5;if(this.layers[n].images[y]==null&&B>=minsc){q=document.createElement("img");q.style.visibility="hidden";q.style.position="absolute";q.style.padding="0px";q.style.margin="0px";q.style.borderWidth=
"0px";q.style.left=d*this.tileW+"px";q.style.top=z*this.tileH+"px";q.style.width=this.tileW+"px";q.style.height=this.tileH+"px";if(this.tileSource.opacity)q.style.opacity=this.tileSource.opacity;t.childNodes.length>0?t.insertBefore(q,t.childNodes.item(0)):t.appendChild(q);this.layers[n].images[y]={};this.layers[n].images[y].img=q;this.layers[n].images[y].array=[];this.layers[n].images[y].array.push(q);this.layers[n].loadComplete=!1;for(ov in this.tileOverlays){var G=this.tileOverlays[ov],D=q.cloneNode(!0);
G=G.src(C,A,n);D.setAttribute("overlay",ov);khtml.maplib.base.helpers.eventAttach(D,"load",this._imgLoaded,this,!1);t.appendChild(D);D.setAttribute("src",G);this.layers[n].images[y].array.push(D)}khtml.maplib.base.helpers.eventAttach(q,"load",this._imgLoaded,this,!1);khtml.maplib.base.helpers.eventAttach(q,"error",this._imgError,this,!1);q.setAttribute("src",F)}if(!this.css3d&&this.layers[n].images[y]){C=this.layers[n].images[y].array;for(A=0;A<C.length;A++){var J=w[0]-l+Math.floor(k);D=w[1]-a+Math.floor(I);
var K=Math.round(this.tileW*B);G=Math.round(this.tileH*B);F=Math.floor(-J*K+d*K);q=Math.floor(-D*G+z*G);J=Math.floor(-J*K+(d+1)*K);D=Math.floor(-D*G+(z+1)*G);C[A].style.left=F+"px";C[A].style.top=q+"px";C[A].style.height=J-F+"px";C[A].style.width=D-q+"px"}}this.layers[n].images[y]&&(this.layers[n].images[y].visibility=!0)}}for(x in this.layers[n].images)if(this.layers[n].images[x].visibility){if(this.layers[n].images[x].array[0].getAttribute("loaded")=="yes"){p=this.layers[n].images[x].array;for(u=
0;u<p.length;u++)if(p[u].getAttribute("loaded")=="yes")p[u].style.visibility=""}}else{p=this.layers[n].images[x].array;for(u=0;u<p.length;u++)this.layers[n].images[x].array[u].style.visibility="hidden",this.layers[n].images[x].array[u].getAttribute("loaded")!="yes"&&t.removeChild(this.layers[n].images[x].array[u]);delete this.layers[n].images[x].img;delete this.layers[n].images[x]}var B=Math.pow(2,o-n);F=-k*this.tileW;q=-I*this.tileH;if(this.css3d)t.style["-webkit-transform-origin"]=-1*F+"px "+-1*
q+"px",t.style.webkitTransform="translate3d("+F+"px,"+q+"px,0px)  "+(" scale3d("+B+","+B+",1) ");t.style.visibility="";t.style.opacity=1;t.style.filter="";t=o=0;for(x in this.layers[this.loadingZoomLevel].images)t++,q=this.layers[this.loadingZoomLevel].images[x].array[0],q.getAttribute("loaded")!="yes"&&o++;this.notLoadedImages=o;o<1&&(this.layers[this.loadingZoomLevel].loadComplete=!0);this.loadingZoomLevel==n&&this._imgLoadInfo(t,o)};this.fadeOutTimeout=null;this._fadeOut=function(a,c){this.fadeOutTimeout&&
clearTimeout(this.fadeOutTimeout);if(c>0){a.style.opacity=c;a.style.filter="alpha( opacity="+c*100+" )";var b=this;this.fadeOutTimeout=setTimeout(function(){b._fadeOut(a,c-0.2)},40)}else a.style.visibility="hidden"};this._hideLayer=function(a){if(this.intZoom!=a&&this.layers[a])this.layers[a].layerDiv.style.opacity=1,this.layers[a].layerDiv.style.filter="alpha(opacity=100)",this._fadeOut(this.layers[a].layerDiv,1);if(this.layers[a])for(var c in this.layers[a].images)if(this.layers[a].images[c]&&this.layers[a].images[c].img&&
this.layers[a].images[c].img.getAttribute("loaded")!="yes"&&a!=this.intZoom){for(var b=this.layers[a].images[c].array,f=0;f<b.length;f++)this.layers[a].layerDiv.removeChild(this.layers[a].images[c].array[f]);delete this.layers[a].images[c].img;delete this.layers[a].images[c]}};this._imgLoaded=function(a){a=a.target?a.target:a.srcElement;var c=!0;a.style.visibility="";a.setAttribute("loaded","yes");if(a.parentNode){for(var b=0,f=0,d=a.parentNode.getAttribute("zoomlevel"),e=0;e<a.parentNode.getElementsByTagName("img").length;e++){var o=
a.parentNode.getElementsByTagName("img").item(e);o.getAttribute("overlay")||(f++,o.getAttribute("loaded")!="yes"&&(b++,c=!1))}this.notLoadedImages=b;this.loadingZoomLevel==d&&this._imgLoadInfo(f,b);if((this.layers[d].loadComplete=c)&&this.loadingZoomLevel==d)this._hideLayer(this.visibleZoom),this._hideLayer(this.visibleZoom+1),this.visibleZoom=d}};this._imgError=function(a){var c=a.target?a.target:a.srcElement;c.parentNode&&(c.src!="http://khtml.org/notfound.png"&&c.setAttribute("src","http://khtml.org/notfound.png"),
this._imgLoaded(a))};var b=function(a,c,b){return[(c+180)/360*(1<<b),(1-Math.log(Math.tan(a*Math.PI/180)+1/Math.cos(a*Math.PI/180))/Math.PI)/2*(1<<b)]};this._calculateMapSize=function(){var a=this.mapParent.getBoundingClientRect();return{top:a.top+document.body.scrollTop,left:a.left+document.body.scrollLeft,width:a.width,height:a.height,deltaTop:a.top+document.body.scrollTop,deltaLeft:a.left+document.body.scrollLeft,deltaBottom:a.bottom,deltaRight:a.right}};this.redraw=function(){this._setMapPosition()};
this._setMapPosition=function(){this.size=this._calculateMapSize();var a=this.mapParent;a.currentStyle||window.getComputedStyle&&document.defaultView.getComputedStyle(a,null);this.mapTop=this.size.top;this.mapLeft=this.size.left;this.width=this.size.width;this.height=this.size.height;relativetop=this.size.deltaTop;relativeleft=this.size.deltaLeft;this.clone.style.top="0px";this.clone.style.left="0px";this.clone.style.width="100%";this.clone.style.height="100%";this.clone.style.position="relative";
this.clone.style.overflow="hidden";this.map.style.left="50%";this.map.style.top="50%";this._getCenter()&&this._getZoom()&&this.centerAndZoom(this._getCenter(),this._getZoom());this._copyright()};this.clearMap=function(){if(this.map){for(;this.map.firstChild;)this.map.removeChild(this.map.firstChild);for(;this.layers.length>0;)this.layers.pop();this.redraw()}};var e=function(a){return 180/Math.PI*Math.log(Math.tan(Math.PI/4+a*(Math.PI/180)/2))},c=function(a){return 180/Math.PI*(2*Math.atan(Math.exp(a*
Math.PI/180))-Math.PI/2)};this._imgLoadInfo=function(a,c){if(!this.loadInfoDiv)this.loadInfoDiv=document.createElement("div"),this.loadInfoDiv.style.position="absolute",this.loadInfoDiv.style.top="0px",this.loadInfoDiv.style.right="0px",this.loadInfoDiv.style.backgroundColor="white",this.loadInfoDiv.style.border="1px solid gray",this.loadInfoDiv.style.fontSize="10px",this.map.parentNode.appendChild(this.loadInfoDiv);if(c==0)this.loadInfoDiv.style.display="none";else{for(this.loadInfoDiv.style.display=
"";this.loadInfoDiv.firstChild;)this.loadInfoDiv.removeChild(this.loadInfoDiv.firstChild);this.loadInfoDiv.appendChild(document.createTextNode(c+" images to load"))}};this.copyrightdiv=null;this._copyright=function(){if(this.copyrightdiv==null)this.copyrightdiv=document.createElement("div"),this.overlayDiv.appendChild(this.copyrightdiv);for(;this.copyrightdiv.firstChild;)this.copyrightdiv.removeChild(this.copyrightdiv.firstChild);var a=document.createElement("img"),c=document.createElement("a");c.setAttribute("href",
"http://maplib.khtml.org");c.setAttribute("target","_blank");a.setAttribute("src","http://maplib.khtml.org/favicon.png");a.style.border="0px solid black";a.style.position="absolute";a.style.backgroundColor="transparent";a.style.margin="0px";a.style.padding="0px";var b=this.size.height-26;a.style.top=b+"px";a.style.left="3px";a.style.width="24px";a.style.height="24px";c.appendChild(a);this.copyrightdiv.appendChild(c);a=document.createElement("a");a.appendChild(document.createTextNode("openstreetmap"));
a.style.position="absolute";a.style.top=b+2+"px";a.style.left="28px";a.style.textDecoration="none";a.style.color="gray";a.setAttribute("href","http://www.openstreetmap.org/copyright");this.copyrightdiv.appendChild(a)};this.internetExplorer=!1;if(navigator.userAgent.indexOf("MSIE")!=-1)this.internetExplorer=!0;if(navigator.userAgent.indexOf("Android")!=-1){var f=this;setInterval(function(){f.layerTimer.reset()},300)}this.position={};this.tiles({maxzoom:18,minzoom:1,src:function(a,c,b){switch((a+c)%
3){case 0:var f="a";break;case 1:f="b";break;case 2:f="c";break;default:f="f"}return"http://"+f+".tile.openstreetmap.org/"+b+"/"+a+"/"+c+".png"},copyright:"osm"});this.wheelSpeedConfig=[];this.wheelSpeedConfig.acceleration=2;this.wheelSpeedConfig.maxSpeed=2;this.wheelSpeedConfig.animate=!1;navigator.userAgent.indexOf("AppleWebKit")!=-1&&(this.wheelSpeedConfig.animate=!0);navigator.userAgent.indexOf("Opera")!=-1&&(this.wheelSpeedConfig.animate=!1);this.wheelSpeedConfig.animate=!1;this.wheelSpeedConfig.digizoom=
!0;this.wheelSpeedConfig.zoomAnimationSlowdown=0.02;this.wheelSpeedConfig.animationFPS=50;this.wheelSpeedConfig.moveAnimateDesktop=!0;this.wheelSpeedConfig.rectShiftAnimate=!1;this.wheelSpeedConfig.rectShiftAnimationTime=500;this.wheelSpeedConfig.animateMinSpeed=0.4;this.wheelSpeedConfig.animateMaxSpeed=200;this.wheelSpeedConfig.moveAnimationSlowdown=0.4;this.framesCounter=this.wheelEventCounter=0;this.mapParent=a;khtml.maplib.base.helpers.setCursor(this.mapParent,"grab");this.clone=a.cloneNode(!0);
this.clone=document.createElement("div");this.clone.removeAttribute("id");a.firstChild?a.insertBefore(this.clone,a.firstChild):a.appendChild(this.clone);this.map=document.createElement("div");this.map.style.position="relative";this.clone.appendChild(this.map);this.overlayDiv=document.createElement("div");this.overlayDiv.style.position="absolute";this.clone.appendChild(this.overlayDiv);this._setMapPosition();this.overlays=[];if(khtml.maplib.overlay.GeoJson){var d=new khtml.maplib.overlay.GeoJson;this.addOverlay(d);
this.featureCollection=d.featureCollection}this.distanceMeasuring="no";this.measureLine=this.moveMarker=null;this.moveAnimationMobile=!0;this.moveAnimationBlocked=this.moveAnimationDesktop=!1;this.lastMouseX=this.width/2;this.lastMouseY=this.height/2;this.layers=[];this.intZoom=this.oldVisibleZoom=this.visibleZoom=null;this.lastMoveTime=this.lastMoveY=this.lastMoveX=this.moveY=this.moveX=0;this.zoomDeltaOld=1;this.startMoveY=this.startMoveX=0;this.sc=1;this.blocked=!1;this.tileH=this.tileW=256;this.position.zoom=
1;this.movestarted=!1;this.mousedownTime=null;this._doubleclickTime=400;this.mousedownTime2=null;this._doubleclickTime2=500;this.zoomOutTime=1E3;this.zoomOutSpeed=0.01;this.zoomOutInterval=null;this.zoomOutStarted=!1;this.zoomSpeedTimer=null;this.zoomAcceleration=1;this.css3d=!1;if(navigator.userAgent.indexOf("iPhone OS")!=-1)this.css3d=!0;if(navigator.userAgent.indexOf("iPad")!=-1)this.css3d=!1;if(navigator.userAgent.indexOf("Safari")!=-1)this.css3d=navigator.userAgent.indexOf("Mac")!=-1?!1:!0;if(navigator.userAgent.indexOf("iPhone OS")!=
-1)this.css3d=!0;if(navigator.userAgent.indexOf("Android")!=-1)this.css3d=!1;this.internetExplorer?(d=a,navigator.userAgent.indexOf("Windows Phone OS")!=-1&&khtml.maplib.base.helpers.eventAttach(d,"mouseup",this._mouseupIE,this,!1)):d=window;khtml.maplib.base.helpers.eventAttach(window,"resize",this._setMapPosition,this,!1);navigator.userAgent.indexOf("Konqueror")!=-1&&(d=a);khtml.maplib.base.helpers.eventAttach(a,"touchstart",this._start,this,!1);khtml.maplib.base.helpers.eventAttach(a,"touchmove",
this._move,this,!1);khtml.maplib.base.helpers.eventAttach(a,"touchend",this._end,this,!1);khtml.maplib.base.helpers.eventAttach(d,"mousemove",this._mousemove,this,!1);khtml.maplib.base.helpers.eventAttach(a,"mousedown",this._mousedown,this,!1);khtml.maplib.base.helpers.eventAttach(d,"mouseup",this._mouseup,this,!0);khtml.maplib.base.helpers.eventAttach(d,"orientationchange",this.reSize,this,!1);khtml.maplib.base.helpers.eventAttach(a,"DOMMouseScroll",this._mousewheel,this,!1);khtml.maplib.base.helpers.eventAttach(a,
"dblclick",this._doubleclick,this,!1);khtml.maplib.base.helpers.eventAttach(d,"keydown",this._shiftkeydown,this,!1);khtml.maplib.base.helpers.eventAttach(d,"keyup",this._shiftkeyup,this,!1);khtml.maplib.base.helpers.eventAttach(a,"contextmenu",function(a){a.preventDefault()},this,!1)};khtml.maplib.geometry.Bounds=function(a,b){this.enlarge=function(a){a.lng()>this.southwest.lng()&&a.lng()>this.northeast.lng()&&this.northeast.lng(a.lng());a.lng()<this.southwest.lng()&&a.lng()<this.northeast.lng()&&this.southwest.lng(a.lng());a.lat()>this.southwest.lat()&&a.lat()>this.northeast.lat()&&this.northeast.lat(a.lat());a.lat()<this.southwest.lat()&&a.lat()<this.northeast.lat()&&this.southwest.lat(a.lat())};this.sw=function(a){if(a)this.southwest=a;return this.southwest};this.se=function(){return new khtml.maplib.LatLng(this.southwest.lat(),
this.northeast.lng())};this.ne=function(a){if(a)this.northeast=a;return this.northeast};this.nw=function(){return new khtml.maplib.LatLng(this.northeast.lat(),this.southwest.lng())};this.getCenter=function(){return this.center};this.getOpticalCenter=function(a){var b=a.latlngToXY(this.southwest),d=a.latlngToXY(this.northeast);return a.XYTolatlng(Math.abs(b.x+d.x)/2,Math.abs(b.y+d.y)/2)};this.getZoomLevel=function(a){origZoom=a.getZoom();var b=a.latlngToXY(this.southwest),d=a.latlngToXY(this.northeast),
g=a.width/Math.abs(b.x-d.x);a=a.height/Math.abs(b.y-d.y);if(g>a)var e=a;g<=a&&(e=g);return origZoom+Math.log(e)/Math.log(2)};this.getDistance=function(){return this.distance(this.southwest.lat(),this.southwest.lng(),this.northeast.lat(),this.northeast.lng())};this.getInnerRadius=function(){var a=this.distance(this.center.lat(),this.southwest.lng(),this.center.lat(),this.northeast.lng()),b=this.distance(this.southwest.lat(),this.center.lng(),this.northeast.lat(),this.center.lng());return a>b?b/2:a/
2};this.distance=function(a,b,d,g){a=a*Math.PI/180;d=d*Math.PI/180;return Math.acos(Math.sin(a)*Math.sin(d)+Math.cos(a)*Math.cos(d)*Math.cos(g*Math.PI/180-b*Math.PI/180))*180/Math.PI/360*4E7};this.intersects=function(a){if(!(a instanceof khtml.maplib.geometry.Bounds))return khtml.maplib.base.Log.warn('Bounds.intersects(): Illegal argument. Has to be "khtml.maplib.geometry.Bounds"!'),!1;var b=Math.min(this.sw().lat(),this.ne().lat()),d=Math.max(this.sw().lat(),this.ne().lat()),g=Math.min(this.sw().lng(),
this.ne().lng()),e=Math.max(this.sw().lng(),this.ne().lng()),h=[];h.push(a.ne());h.push(a.se());h.push(a.sw());h.push(a.nw());for(a=0;a<h.length;a++){var k=h[a],l=k.lat()>=b&&k.lat()<=d;k=k.lng()>=g&&k.lng()<=e;if(l&&k)return!0}return!1};this.createBoundsFrom2Points=function(a,b){var d=new khtml.maplib.LatLng(Math.min(a.lat(),b.lat()),Math.min(a.lng(),b.lng())),g=new khtml.maplib.LatLng(Math.max(a.lat(),b.lat()),Math.max(a.lng(),b.lng()));return{sw:d,ne:g}};var e=this.createBoundsFrom2Points(a,b);
this.southwest=e.sw;this.northeast=e.ne;this.center=new khtml.maplib.LatLng((this.southwest.lat()+this.northeast.lat())/2,(this.southwest.lng()+this.northeast.lng())/2)};khtml.maplib.geometry.LatLng=function(a,b){this.callbackFunctions=[];this.addCallbackFunction=function(a){typeof a=="function"&&this.callbackFunctions.push(a)};this.removeCallbackFunction=function(a){for(var c=0;c<this.callbackFunctions.length;c++)this.callbackFunctions[c]==a&&this.callbackFunctions.splice(c,1)};this._executeCallbackFunctions=function(){for(var a=0;a<this.callbackFunctions.length;a++)this.callbackFunctions[a].call(this)};this.lat=function(a){if(typeof a=="number")this.latitude=a,
this._executeCallbackFunctions();else if(typeof a=="string")this.latitude=parseFloat(a),this._executeCallbackFunctions();return this.latitude};this.lng=function(a){if(typeof a=="number")this.longitude=a,this._executeCallbackFunctions();else if(typeof a=="string")this.longitude=parseFloat(a),this._executeCallbackFunctions();return this.longitude};this.equals=function(a){if(null==a)return!1;if(!(a instanceof khtml.maplib.LatLng))return khtml.maplib.base.Log.warn("Point.equals(): Error - illegal argument!",
a),!1;return a.lat()===this.lat()&&a.lng()===this.lng()};a instanceof khtml.maplib.geometry.LatLng?(this.lat(a.lat()),this.lng(a.lng())):typeof a=="object"?(a.lat&&this.lat(a.lat),a.lng&&this.lng(a.lng)):(this.lat(a),this.lng(b))};khtml.maplib.geometry.Feature=function(a,b){var e=this;if(a.type=="FeatureCollection")return new khtml.maplib.geometry.FeatureCollection(a,b);this.type="Feature";this.events=[];this.geometry={};a.geometry?(this.geometry.coordinates=khtml.maplib.base.helpers.parseLine(a.geometry.coordinates),this.geometry.type=a.geometry.type):(this.geometry.coordinates=khtml.maplib.base.helpers.parseLine(a.coordinates),this.geometry.type=a.type);this.style=a.style?a.style:{};this.className=a.className?a.className:
{};if(a.properties)this.properties=a.properties;if(a.infobox)this.infobox=a.infobox;if(a.title)this.title=a.title;this.init=function(a){this.parentNode=a;this.documentElement=a.documentElement;if(!this.bbox)this.bbox=this.makeBounds()};this.eventAttach=function(a,b,d,g){this.element&&khtml.maplib.base.helpers.eventAttach(this.element,a,b,d,g);this.events.push({eventType:a,method:b,context:d,bubble:g})};this.eventRemove=function(){console.log("not implemented")};this.makeBounds=function(a){if(!a)a=
this.geometry.coordinates;var b=90,d=-90,g=180,e=-180;if(a instanceof khtml.maplib.geometry.LatLng){if(a.lat){var h=a.lng(),k=a.lat();k>d&&(d=k);k<b&&(b=k);h>e&&(e=h);h<g&&(g=h)}}else for(var l=0;l<a.length;l++)a[l]instanceof khtml.maplib.geometry.LatLng?(h=a[l].lng(),k=a[l].lat(),k>d&&(d=k),k<b&&(b=k),h>e&&(e=h),h<g&&(g=h)):(h=this.makeBounds(a[l]),h.sw().lat()<b&&(b=h.sw().lat()),h.sw().lng()<g&&(g=h.sw().lng()),h.ne().lat()>d&&(d=h.ne().lat()),h.ne().lng()>e&&(e=h.ne().lng()));a=new khtml.maplib.LatLng(b,
g);d=new khtml.maplib.LatLng(d,e);return new khtml.maplib.geometry.Bounds(a,d)};this.render=function(){if(e.documentElement){if(!e.parentNode)e.parentNode=e.featureCollection;if(khtml.maplib.base.helpers.overlaps(e.documentElement.map.bounds(),e.bbox))switch(e.style.display="",e.documentElement.backend){case "svg":e.renderSVG(e);break;case "canvas":e.renderCanvas(e);break;default:console&&console.log&&console.log("backend unknown",e.parentNode.backend)}else e.style.display="none";e.geometry.type==
"Point"&&e.renderMarker(e.parentNode.element)}};this.renderMarker=function(){if(!this.mmarker){if(!a.marker)a.marker={};this.marker=a.marker;this.mmarker=new khtml.maplib.overlay.Marker({position:this.geometry.coordinates,map:this.documentElement.map,title:a.title,icon:a.marker.icon,shadow:a.marker.shadow,draggable:a.marker.draggable});if(a.marker.infobox)this.mmarker.box=new khtml.maplib.overlay.InfoWindow({content:a.marker.infobox}),this.mmarker.attachEvent("click",function(){this.box.open(this.mapObj,
this)})}};old=null;this.doSVGPath=function(a,b,d){var g=0,e=0,h=1,k=1;if(a.documentElement.element.finished&&a.documentElement.element&&a.documentElement.element.topright)g=a.documentElement.element.topright.y,e=a.documentElement.element.bottomleft.x,k=a.documentElement.element.bottomleft.y-g,h=(a.documentElement.element.topright.x-e)/a.documentElement.map.size.width,k/=a.documentElement.map.size.height,old=g;for(var l="",n=0;n<b.length;n++)if(b[n]instanceof khtml.maplib.geometry.LatLng){var o=this.documentElement.map.latlngToXY(b[n]);
o={x:o.x-e,y:o.y-g};o.x/=h;o.y/=k;n==0?l=" M"+o.x+" "+o.y:l+=" L"+o.x+" "+o.y;d&&n==b.length-1&&(l+=" z")}else l+=this.doSVGPath(a,b[n],d);return l};this.renderSVG=function(a){if(a.geometry.type!="Point"){var b=!1;if(a.geometry.type=="LinearRing"||a.geometry.type=="Polygon"||a.geometry.type=="MultiPolygon")b=!0;b=this.doSVGPath(a,a.geometry.coordinates,b);if(!this.element){this.element=document.createElementNS("http://www.w3.org/2000/svg","path");this.element.feature=a;this.parentNode.element.appendChild(this.element);
for(var d=0;d<a.events.length;d++){var g=a.events[d];khtml.maplib.base.helpers.eventAttach(this.element,g.eventType,g.method,g.context,g.bubble)}}this.element.setAttribute("d",b);if(a.geometry.type=="Polygon"||a.geometry.type=="MultiPolygon")this.element.setAttribute("fill-rule","evenodd");else{if(!this.style)this.style={};this.style.fill="none"}for(var e in this.style)try{this.element.style[e]=this.style[e]}catch(h){}this.style=this.element.style;this.element.className.baseVal=a.className.baseVal;
this.element.style.display=typeof this.display!="undefined"?this.display:""}};this.doCanvasPath=function(a,b,d,g,e,h){e||(e=0);h||(h=0);if(!(a=="Polygon"&&e>0&&h>0))b.globalCompositeOperation="destination-over";for(h=0;h<d.length;h++)if(d[h]instanceof khtml.maplib.geometry.LatLng){var k=this.documentElement.map.latlngToXY(d[h]),l={};l.x=k.x-this.documentElement.deltaX;l.y=k.y-this.documentElement.deltaY;h==0?b.moveTo(l.x,l.y):b.lineTo(l.x,l.y);g&&h==d.length-1&&(k=this.documentElement.map.latlngToXY(d[0]),
b.lineTo(k.x,k.y))}else this.doCanvasPath(a,b,d[h],g,e+1,h)};this.renderCanvas=function(a){if(a.geometry.type!="Point"){if(!a.canvasStyle){var b=this.documentElement.canvasStyler.makeCanvasStyle(a);a.canvasStyle=b}b=!1;if(a.geometry.type=="LinearRing"||a.geometry.type=="Polygon"||a.geometry.type=="MultiPolygon")b=!0;var d=this.documentElement.context;d.beginPath();for(var g in a.canvasStyle)d[g]=a.canvasStyle[g];this.doCanvasPath(a.geometry.type,d,a.geometry.coordinates,b);d.stroke();d.fill()}};b&&
this.init(b);this.toJSON=function(){return khtml.maplib.base.helpers.reduceToJSON(this)}};khtml.maplib.geometry.FeatureCollection=function(a,b){this.type="FeatureCollection";this.style={};this.className={};if(b){this.parentNode=b;this.documentElement=b.documentElement?this.parentNode.documentElement:b;this.map=this.parentNode.map;if(this.parentNode.context)this.context=this.parentNode.context;if(this.documentElement.backend=="svg")this.element=document.createElementNS("http://www.w3.org/2000/svg","g"),this.parentNode.element&&this.parentNode.element.appendChild(this.element)}if(!this.features)this.features=
[];this.childNodes=this.features;if(this.documentElement&&this.documentElement.backend=="svg"){if(a.style)for(var e in a.style)this.style[e]=a.style[e];this.style=this.element.style;this.className=this.element.className;if(a.className)this.className.baseVal=a.className.baseVal}if(a)this.properties=a.properties;this.init=function(c){if(this.documentElement.backend=="svg"){if(!this.element)this.element=document.createElementNS("http://www.w3.org/2000/svg","g"),this.style=this.element.style,this.style.fill=
"green";c.element.appendChild(this.element)}this.parentNode=c;this.documentElement=this.parentNode.documentElement;if(a&&a.features)for(c=0;c<a.features.length;c++)this.appendChild(a.features[c]);if(this.features)for(c=0;c<this.features.length;c++)this.features[c].element||this.features[c].init(this)};this.appendChild=function(a){var b=!1;if(!a.element&&!a.mmarker)a.render?(a.parentNode=this,a.documentElement=this.documentElement):a=new khtml.maplib.geometry.Feature(a,this);else{b=!0;for(var d=0;d<
a.parentNode.features.length;d++)if(a.parentNode.features[d]==a){if(this==a.parentNode&&d==a.parentNode.features.length-1)return a;a.parentNode.features.splice(d,1);a.element&&this.element&&this.element.appendChild(a.element);break}}this.features.push(a);if(this.documentElement)a.documentElement=this.documentElement,this.documentElement.recurseLinksDirty=!0;a.parentNode=this;b||a.init(this);a.render();return a};this.insertBefore=function(a,b){var d=!1;if(!b)if(this.features[0])b=this.features[0];
else return this.appendChild(a),!1;if(a==b)return a;if(!a.element&&!a.marker)a=new khtml.maplib.geometry.Feature(a);else if(d=!0,a.parentNode)for(var g=0;g<a.parentNode.features.length;g++)if(a.parentNode.features[g]==a){a.parentNode.features.splice(g,1);break}for(g=0;g<this.features.length;g++)if(this.features[g]==b){this.features.splice(g,0,a);a.element&&this.element.insertBefore(a.element,b.element);break}this.documentElement.recurseLinksDirty=!0;a.parentNode=this;d||a.init(this);a.render();this.makeBounds();
return a};this.removeChild=function(a){if(a){a.mmarker&&a.mmarker.destroy();for(var b=0;b<this.features.length;b++)if(this.features[b]==a){if(this.features[b].preceding)this.features[b].preceding.following=this.features[b].following;if(this.features[b].following)this.features[b].following.preceding=this.features[b].preceding;try{this.element.removeChild(this.features[b].element)}catch(d){}this.features.splice(b,1);break}this.documentElement.backend=="canvas"&&this.documentElement.render(!0)}};this.replaceChild=
function(a,b){var d=this.insertBefore(a,b);this.removeChild(b);return d};this.render=function(){};this.toJSON=function(){return khtml.maplib.base.helpers.reduceToJSON(this)};this.makeBounds=function(){this.bbox=null;for(var a=0;a<this.features.length;a++)if(this.features[a].makeBounds){var b=this.features[a].bbox?this.features[a].bbox:this.features[a].makeBounds();this.bbox=khtml.maplib.base.helpers.extendBBox(this.bbox,b)}return this.bbox}};khtml.maplib.overlay.MarkerImage=function(a,b,e,c){if(a)this.url=a;if(b)this.size=b;if(e)this.origin=e;if(c)this.anchor=c};khtml.maplib.overlay.MarkerOptions=function(a,b,e,c,f,d,g,m,h,k,l,n,o){if(c)this.draggable=c;if(d)this.icon=d;if(g)this.map=g;if(h)this.position=h;if(k)this.raiseOnDrag=k;if(l)this.shadow=l;if(n)this.shape=n;if(o)this.title=o};
khtml.maplib.overlay.Marker=function(a){this.setPosition=function(a){a&&(this.position.lat(a.lat()),this.position.lng(a.lng()),this.render());return this.position};this.getPosition=function(){return this.position};this.pixelOffset=function(){var a=[];!isNaN(parseInt(this.marker.style.width))&&!isNaN(parseInt(this.marker.style.height))?(a.x=parseInt(this.marker.style.width)/2,a.y=parseInt(this.marker.style.height)):a={x:0,y:0};return a};this.clear=function(){if(this.marker&&this.marker.parentNode)try{this.owner.overlayDiv.markerDiv.removeChild(this.marker),
this.shadow&&this.owner.overlayDiv.shadowDiv.removeChild(this.shadow)}catch(a){}};this.destroy=function(){this.mapObj.removeOverlay(this)};this.callbackFunctions=[];this.addCallbackFunction=function(a){typeof a=="function"&&this.callbackFunctions.push(a)};this._executeCallbackFunctions=function(){for(var a=0;a<this.callbackFunctions.length;a++)this.callbackFunctions[a].call(this)};this._setCursor=function(a){this.MarkerOptions.shape&&navigator.userAgent.indexOf("MSIE")==-1&&navigator.userAgent.indexOf("iPhone")==
-1&&navigator.userAgent.indexOf("iPad")==-1?(khtml.maplib.base.helpers.setCursor(this.marker,""),khtml.maplib.base.helpers.setCursor(this.area,a)):khtml.maplib.base.helpers.setCursor(this.marker,a)};this.moving=!1;this._mousedown=function(a){this.moving=!0;this.clickx=this.marker.offsetLeft-this.mapObj.pageX(a)+this.dx;this.clicky=this.marker.offsetTop-this.mapObj.pageY(a)+this.dy;a.preventDefault?a.preventDefault():window.event.returnValue=!1;a.stopPropagation?a.stopPropagation():window.event.cancelBubble=
!0;a=navigator.userAgent.indexOf("MSIE")!=-1?this.mapObj.mapParent:window;khtml.maplib.base.helpers.eventAttach(a,"mousemove",this._mousemove,this,!1);khtml.maplib.base.helpers.eventAttach(a,"mouseup",this._mouseup,this,!1);khtml.maplib.base.helpers.setCursor(this.mapObj.mapParent,"grabbing");this._setCursor("grabbing")};this._mousemove=function(a){if(this.moving){this.x=this.mapObj.pageX(a)+this.clickx;this.y=this.mapObj.pageY(a)+this.clicky;this.position.lat(this.mapObj.XYTolatlng(this.x,this.y).lat());
this.position.lng(this.mapObj.XYTolatlng(this.x,this.y).lng());this.render();a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0;this.marker.style.zIndex=1E6;if(this.shadow)this.shadow.style.zIndex=1E6;if((this.MarkerOptions.raiseOnDrag==null||this.MarkerOptions.raiseOnDrag==!0)&&!this.raised){this.dragcross=document.createElement("div");this.dragcross.style.position="absolute";this.dragcross.dx=8;this.dragcross.dy=8;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?(a=document.createElement("div"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+dragcross_image+"')",a.style.width="100%",a.style.height="100%"):(a=document.createElement("img"),a.style.backgroundColor="transparent",a.style.padding="0px",a.style.margin="0px",a.setAttribute("src",dragcross_image));this.dragcross.style.width="16px";this.dragcross.style.height="16px";this.dragcross.appendChild(a);this.dragcross.style.left=this.x-this.dragcross.dx+"px";this.dragcross.style.top=
this.y-this.dragcross.dy+"px";this.owner.overlayDiv.markerDiv.appendChild(this.dragcross);var b=this;window.clearInterval(this.markerDropInterval);this.markerRaiseInterval=window.setInterval(function(){b._raiseMarker()},5);this.raised=!0}this._mousemoveMap()}};this._mouseup=function(){if(this.moving)this.position.lat(this.mapObj.XYTolatlng(this.x,this.y).lat()),this.position.lng(this.mapObj.XYTolatlng(this.x,this.y).lng()),this.moving=!1,e=b=mapMoveSpeed=1,window.clearInterval(this.mapmoveInterval);
var a=this.mapObj.latlngToXY(this.position);this.marker.style.zIndex=this.mapObj.size.height+a.y;if(this.shadow)this.shadow.style.zIndex=a.y;if((this.MarkerOptions.raiseOnDrag==null||this.MarkerOptions.raiseOnDrag==!0)&&this.raised){this.owner.overlayDiv.markerDiv.removeChild(this.dragcross);var c=this;window.clearInterval(this.markerRaiseInterval);this.markerDropInterval=window.setInterval(function(){c._dropMarker()},5);this.raised=!1}khtml.maplib.base.helpers.setCursor(this.mapObj.mapParent,"grab");
this._setCursor("pointer");this.render();this._executeCallbackFunctions()};this._touchstart=function(a){a.touches.length==1?(this.moving=!0,this.touchx=this.marker.offsetLeft-this.mapObj.pageX(a.touches[0]),this.touchy=this.marker.offsetTop-this.mapObj.pageY(a.touches[0]),khtml.maplib.base.helpers.eventAttach(window,"touchmove",this._touchmove,this,!0),khtml.maplib.base.helpers.eventAttach(window,"touchend",this._touchend,this,!0)):this.moving=!1};this._touchmove=function(a){if(a.touches.length==
1&&this.moving){this.x=this.mapObj.pageX(a.touches[0])+this.touchx+this.dx;this.y=this.mapObj.pageY(a.touches[0])+this.touchy+this.dy;this.position.lat(this.mapObj.XYTolatlng(this.x,this.y).lat());this.position.lng(this.mapObj.XYTolatlng(this.x,this.y).lng());this.render();if(!this.clicked)a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0;this.marker.style.zIndex=1E6;if(this.shadow)this.shadow.style.zIndex=1E6;if((this.MarkerOptions.raiseOnDrag==null||this.MarkerOptions.raiseOnDrag==
!0)&&!this.raised){this.dragcross=document.createElement("div");this.dragcross.style.position="absolute";this.dragcross.dx=8;this.dragcross.dy=8;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(a=document.createElement("div"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+dragcross_image+"')",a.style.width="100%",a.style.height="100%"):(a=document.createElement("img"),a.style.backgroundColor="transparent",
a.style.padding="0px",a.style.margin="0px",a.setAttribute("src",dragcross_image));this.dragcross.style.width="16px";this.dragcross.style.height="16px";this.dragcross.appendChild(a);this.dragcross.style.left=this.x-this.dragcross.dx+"px";this.dragcross.style.top=this.y-this.dragcross.dy+"px";this.owner.overlayDiv.markerDiv.appendChild(this.dragcross);var b=this;window.clearInterval(this.markerDropInterval);this.markerRaiseInterval=window.setInterval(function(){b._raiseMarker()},20);this.raised=!0}this._mousemoveMap()}};
this._touchend=function(){if(this.moving)this.position.lat(this.mapObj.XYTolatlng(this.x,this.y).lat()),this.position.lng(this.mapObj.XYTolatlng(this.x,this.y).lng()),this.moving=!1,e=b=mapMoveSpeed=1,window.clearInterval(this.mapmoveInterval);var a=this.mapObj.latlngToXY(this.position);this.marker.style.zIndex=a.y;if(this.shadow)this.shadow.style.zIndex=a.y;if((this.MarkerOptions.raiseOnDrag==null||this.MarkerOptions.raiseOnDrag==!0)&&this.raised){this.owner.overlayDiv.markerDiv.removeChild(this.dragcross);
var c=this;window.clearInterval(this.markerRaiseInterval);this.markerDropInterval=window.setInterval(function(){c._dropMarker()},20);this.raised=!1}window.clearInterval(this.mapmoveInterval);this.render()};this._raiseMarker=function(){this.dy+=5;this.shadow&&(this.shadow.dx-=3.75,this.shadow.dy+=3.75);this.render();if(isNaN(this.i))this.i=0;this.i+=5;this.i>20&&window.clearInterval(this.markerRaiseInterval)};this._dropMarker=function(){isNaN(this.i)?this.i=0:this.i>=5?(this.i-=5,this.dy-=5,this.shadow&&
(this.shadow.dx+=3.75,this.shadow.dy-=3.75),this.render()):window.clearInterval(this.markerDropInterval)};var b=1,e=1;this._mousemoveMap=function(){var a=this;this.mapObj.latlngToXY(this.position).x<this.mapObj.size.width/10?(b=(1-this.mapObj.latlngToXY(this.position).x/(this.mapObj.size.width/10))*10,this.mapObj.latlngToXY(this.position).y<this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),e=(1-this.mapObj.latlngToXY(this.position).y/(this.mapObj.size.height/10))*10,this.mapmoveInterval=
window.setInterval(function(){a.mapObj.moveXY(b,e)},10)):this.mapObj.latlngToXY(this.position).y>this.mapObj.size.height-this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),e=(1-(this.mapObj.size.height-this.mapObj.latlngToXY(this.position).y)/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(b,-e)},10)):(window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(b,0)},10))):this.mapObj.latlngToXY(this.position).x>
this.mapObj.size.width-this.mapObj.size.width/10?(b=(1-(this.mapObj.size.width-this.mapObj.latlngToXY(this.position).x)/(this.mapObj.size.width/10))*10,this.mapObj.latlngToXY(this.position).y<this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),e=(1-this.mapObj.latlngToXY(this.position).y/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-b,e)},10)):this.mapObj.latlngToXY(this.position).y>this.mapObj.size.height-this.mapObj.size.height/
10?(window.clearInterval(this.mapmoveInterval),e=(1-(this.mapObj.size.height-this.mapObj.latlngToXY(this.position).y)/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-b,-e)},10)):(window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-b,0)},10))):this.mapObj.latlngToXY(this.position).y<this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),e=(1-this.mapObj.latlngToXY(this.position).y/
(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(0,e)},10)):this.mapObj.latlngToXY(this.position).y>this.mapObj.size.height-this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),e=(1-(this.mapObj.size.height-this.mapObj.latlngToXY(this.position).y)/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(0,-e)},10)):(window.clearInterval(this.mapmoveInterval),e=b=1)};this.makeMoveable=function(){this.MarkerOptions.shape?
(khtml.maplib.base.helpers.eventAttach(this.area,"mousedown",this._mousedown,this,!1),khtml.maplib.base.helpers.eventAttach(this.area,"touchstart",this._touchstart,this,!1)):(khtml.maplib.base.helpers.eventAttach(this.marker,"mousedown",this._mousedown,this,!1),khtml.maplib.base.helpers.eventAttach(this.marker,"touchstart",this._touchstart,this,!1));this.MarkerOptions.draggable=!0};this.clickDetectY=this.clickDetectX=-1;this._touchclickdetectstart=function(a){if(a.touches.length==1)this.clickDetectY=
this.clickDetectX=-1,this.clicked=!0};this._touchclickdetectmove=function(a){if(a.touches.length==1&&(this.clickDetectX=a.touches[0].pageX,this.clickDetectY=a.touches[0].pageY,this.MarkerOptions.draggable))a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0};this._touchclickdetectstop=function(a){if(a.touches.length==0&&this.clickDetectX==-1&&this.clickDetectY==-1)this.originalClickFunction(),this.clicked=!1};this._mouseclickdetectstart=function(a){this.leftclick=!1;if(!a)a=window.event;
if(a.which)this.leftclick=a.which==1;else if(a.button)this.leftclick=a.button==0||a.button==1};this._mouseclickdetectmove=function(){this.leftclick=!1};this._mouseclickdetectstop=function(){this.leftclick&&this.originalClickFunction()};this.attachEvent=function(a,b,c,d){c||(c=this);d||(d=!1);if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){if(a=="click")this.originalClickFunction=b,this.MarkerOptions.shape?(khtml.maplib.base.helpers.eventAttach(this.area,
"touchstart",this._touchclickdetectstart,c,d),khtml.maplib.base.helpers.eventAttach(this.area,"touchmove",this._touchclickdetectmove,c,d),khtml.maplib.base.helpers.eventAttach(this.area,"touchend",this._touchclickdetectstop,c,d)):(khtml.maplib.base.helpers.eventAttach(this.marker,"touchstart",this._touchclickdetectstart,c,d),khtml.maplib.base.helpers.eventAttach(this.marker,"touchmove",this._touchclickdetectmove,c,d),khtml.maplib.base.helpers.eventAttach(this.marker,"touchend",this._touchclickdetectstop,
c,d))}else if(a=="click")this.originalClickFunction=b,this.MarkerOptions.shape?(khtml.maplib.base.helpers.eventAttach(this.area,"mousedown",this._mouseclickdetectstart,c,d),khtml.maplib.base.helpers.eventAttach(this.area,"mousemove",this._mouseclickdetectmove,c,d),khtml.maplib.base.helpers.eventAttach(this.area,"mouseup",this._mouseclickdetectstop,c,d)):(khtml.maplib.base.helpers.eventAttach(this.marker,"mousedown",this._mouseclickdetectstart,c,d),khtml.maplib.base.helpers.eventAttach(this.marker,
"mousemove",this._mouseclickdetectmove,c,d),khtml.maplib.base.helpers.eventAttach(this.marker,"mouseup",this._mouseclickdetectstop,c,d))};this.init=function(a){this.owner=a;this.mapObj=a instanceof khtml.maplib.base.Map?a:a.map;this.x=this.mapObj.latlngToXY(this.position).x;this.y=this.mapObj.latlngToXY(this.position).y;if(!this.owner.overlayDiv.markerDiv)this.owner.overlayDiv.markerDiv=document.createElement("div"),this.owner.overlayDiv.appendChild(this.owner.overlayDiv.markerDiv),this.owner.overlayDiv.markerDiv.setAttribute("id",
"markerDiv");if(this.shadow&&!this.owner.overlayDiv.shadowDiv)this.owner.overlayDiv.shadowDiv=document.createElement("div"),this.owner.overlayDiv.insertBefore(this.owner.overlayDiv.shadowDiv,this.owner.overlayDiv.markerDiv),this.owner.overlayDiv.shadowDiv.setAttribute("id","shadowDiv");this.owner.overlayDiv.markerDiv.appendChild(this.marker);this.shadow&&this.owner.overlayDiv.shadowDiv.appendChild(this.shadow);this.MarkerOptions.draggable==!0?this.makeMoveable():(khtml.maplib.base.helpers.eventAttach(this.marker,
"mousedown",function(){if(!this.MarkerOptions.draggable)this.clicked=!0},this,!1),khtml.maplib.base.helpers.eventAttach(this.marker,"mousemove",function(){this.MarkerOptions.draggable||(this.clicked==!0?this._setCursor("grabbing"):this._setCursor("pointer"))},this,!1),a=navigator.userAgent.indexOf("MSIE")!=-1?this.mapObj.mapParent:window,khtml.maplib.base.helpers.eventAttach(a,"mouseup",function(){if(!this.MarkerOptions.draggable)this.clicked=!1,this._setCursor("pointer")},this,!1))};this.render=
function(){if(this.marker&&this.position&&!isNaN(this.position.lat())&&!isNaN(this.position.lng())){if(this.moving)var a=this.x,b=this.y;else b=this.mapObj.latlngToXY(this.position),a=b.x,b=b.y,this.x=a,this.y=b;if((a<-this.width||b<-this.height||a>this.mapObj.size.width+this.width||b>this.mapObj.size.height+this.height)&&!this.moving){if(this.marker.style.display="none",this.shadow)this.shadow.style.display="none"}else{this.marker.style.display="";this.marker.style.left=a-this.dx+"px";this.marker.style.top=
b-this.dy+"px";if(this.shadow)this.shadow.style.display="",this.shadow.style.left=a-this.shadow.dx+"px",this.shadow.style.top=b-this.shadow.dy+"px";if(this.dragcross)this.dragcross.style.left=a-this.dragcross.dx+"px",this.dragcross.style.top=b-this.dragcross.dy+"px";if(!this.moving&&(this.marker.style.zIndex=this.mapObj.size.height+parseInt(b),this.shadow))this.shadow.style.zIndex=parseInt(b)}if(!this.owner.overlayDiv.markerDiv)this.owner.overlayDiv.markerDiv=document.createElement("div"),this.owner.overlayDiv.appendChild(this.owner.overlayDiv.markerDiv),
this.owner.overlayDiv.markerDiv.setAttribute("id","markerDiv");if(this.shadow&&!this.owner.overlayDiv.shadowDiv)this.owner.overlayDiv.shadowDiv=document.createElement("div"),this.owner.overlayDiv.insertBefore(this.owner.overlayDiv.shadowDiv,this.owner.overlayDiv.markerDiv),this.owner.overlayDiv.shadowDiv.setAttribute("id","shadowDiv");this.marker.parentNode||this.owner.overlayDiv.markerDiv.appendChild(this.marker);this.shadow&&!this.shadow.parentNode&&this.owner.overlayDiv.shadowDiv.appendChild(this.shadow)}};
this.nodeName=this.nodeType="Marker";this.geometry={};this.geometry.type="Point";this.type="Marker";this.constructor.number++;var c=document.createElement("div");c.style.position="absolute";this.marker=c;if(a){this.MarkerOptions=a;if(a.position)this.position=a.position,this.geometry.coordinates=a.position;if(a.icon){if((typeof a.icon=="string"||typeof a.icon=="object")&&!a.icon.url)a.icon.url=a.icon;typeof a.icon.url=="object"&&(c.appendChild(a.icon.url),a.title&&c.setAttribute("title",a.title),this._setCursor("pointer"));
if(typeof a.icon.url=="string"){var f=document.createElement("img");f.style.backgroundColor="transparent";f.style.padding="0px";f.style.margin="0px";f.setAttribute("src",a.icon.url);if(a.icon.origin){if(a.icon.origin.x)f.style.left=a.icon.origin.x;if(a.icon.origin.y)f.style.top=a.icon.origin.y}f.style.border=0;f.style.margin=0;f.style.padding=0;khtml.maplib.base.helpers.imageNotSelectable(f);c.appendChild(f);a.shape&&navigator.userAgent.indexOf("MSIE")==-1&&navigator.userAgent.indexOf("iPhone")==
-1&&navigator.userAgent.indexOf("iPad")==-1?(f.setAttribute("usemap","#shapemap"+this.constructor.number),f=document.createElement("map"),f.setAttribute("id","shapemap"+this.constructor.number),f.setAttribute("name","shapemap"+this.constructor.number),d=document.createElement("area"),d.setAttribute("shape",a.shape.type),d.setAttribute("coords",a.shape.coord),a.title&&d.setAttribute("title",a.title),d.style.cursor="pointer",d.style.display="block",f.appendChild(d),c.appendChild(f),this.area=d):(this.area=
this.MarkerOptions.shape=null,a.title&&f.setAttribute("title",a.title),this._setCursor("pointer"))}a.icon.anchor?(this.dy=a.icon.anchor.y?Math.abs(parseInt(a.icon.anchor.y)):0,this.dx=a.icon.anchor.x?Math.abs(parseInt(a.icon.anchor.x)):0):this.dy=this.dx=0;a.icon.size?(a.icon.size.width?(this.width=Math.abs(parseInt(a.icon.size.width)),c.style.width=this.width+"px",c.style.overflow="hidden"):c.style.width="auto",a.icon.size.height?(this.height=Math.abs(parseInt(a.icon.size.height)),c.style.height=
this.height+"px",c.style.overflow="hidden"):c.style.height="auto"):(c.style.width="auto",c.style.height="auto");if(a.shadow){d=document.createElement("div");d.style.position="absolute";this.shadow=d;if((typeof a.shadow=="string"||typeof a.shadow=="object")&&!a.shadow.url)a.shadow.url=a.shadow;if(a.shadow.url){this.shadow.dy=a.shadow.anchor.y?Math.abs(parseInt(a.shadow.anchor.y)):0;this.shadow.dx=a.shadow.anchor.x?Math.abs(parseInt(a.shadow.anchor.x)):0;if(a.shadow.size.width)d.style.width=Math.abs(parseInt(a.shadow.size.width))+
"px",d.style.overflow="hidden";if(a.shadow.size.height)d.style.height=Math.abs(parseInt(a.shadow.size.height))+"px",d.style.overflow="hidden";if(typeof a.shadow.url=="object")d.appendChild(a.shadow.url);else if(typeof a.shadow.url=="string")f=document.createElement("img"),f.style.backgroundColor="transparent",f.style.padding="0px",f.style.margin="0px",f.setAttribute("src",a.shadow.url),f.style.position="absolute",f.style.left=a.shadow.origin.x?a.shadow.origin.x+"px":0,f.style.top=a.shadow.origin.y?
a.shadow.origin.y+"px":0,khtml.maplib.base.helpers.imageNotSelectable(f),d.appendChild(f);this.shadow.dx=this.dx;this.shadow.dy=this.dy}}}else{d=document.createElement("div");d.style.position="absolute";this.shadow=d;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(f=document.createElement("div"),f.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',src='"+standardmarker_shadow+"')",f.style.width=
"100%",f.style.height="100%"):(f=document.createElement("img"),f.style.backgroundColor="transparent",f.style.padding="0px",f.style.margin="0px",f.setAttribute("src",standardmarker_shadow));f.style.position="absolute";f.style.left="0px";f.style.top="0px";khtml.maplib.base.helpers.imageNotSelectable(f);d.style.width="42px";d.style.height="36px";d.appendChild(f);this.shadow.dx=2;this.shadow.dy=36;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?(f=document.createElement("div"),f.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',src='"+standardmarker_image+"')",f.style.width="100%",f.style.height="100%"):(f=document.createElement("img"),f.style.backgroundColor="transparent",f.style.padding="0px",f.style.margin="0px",f.setAttribute("src",standardmarker_image));f.style.border=0;f.style.margin=0;f.style.padding=0;khtml.maplib.base.helpers.imageNotSelectable(f);navigator.userAgent.indexOf("MSIE")==-1?f.setAttribute("usemap",
"#shapemap"+this.constructor.number):a&&a.title&&f.setAttribute("title",a.title);c.style.width="20px";c.style.height="36px";c.appendChild(f);if(navigator.userAgent.indexOf("MSIE")==-1&&navigator.userAgent.indexOf("iPhone")==-1&&navigator.userAgent.indexOf("iPad")==-1){f=document.createElement("map");f.setAttribute("id","shapemap"+this.constructor.number);f.setAttribute("name","shapemap"+this.constructor.number);var d=document.createElement("area");d.setAttribute("href","javascript:void(0)");d.setAttribute("shape",
standardmarker_shape.type);d.setAttribute("coords",standardmarker_shape.coord);a&&a.title&&d.setAttribute("title",a.title);d.style.cursor="pointer";d.style.display="block";f.appendChild(d);c.appendChild(f);this.area=d;this.MarkerOptions.shape={}}else this.area=this.MarkerOptions.shape=null,this._setCursor("pointer");this.dx=2;this.dy=36;c.style.width="20px";c.style.height="36px"}a.map&&a.map.addOverlay(this)}else this.MarkerOptions={},this.MarkerOptions.draggable=!1,this.dy=this.dx=0,this._setCursor("pointer")};
khtml.maplib.overlay.Marker.number=0;
navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(dragcross_image=khtml.maplib.standardimagepath+"./dragcross_nor.png",standardmarker_image=khtml.maplib.standardimagepath+"./standardmarker_nor.png",standardmarker_shadow=khtml.maplib.standardimagepath+"./standardmarkershadow_nor.png"):(dragcross_image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxMTAxQzYzNzA4MjI2ODExOERCQkMxRjgyMEJGMzlFNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxNjVGMDcwMEMxMDAxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxNjVGMDZGRkMxMDAxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjExMDFDNjM3MDgyMjY4MTE4REJCQzFGODIwQkYzOUU1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjExMDFDNjM3MDgyMjY4MTE4REJCQzFGODIwQkYzOUU1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/o5aeQAAAThJREFUeNpi8fX1ZaAEMEFpUSCWJkGfChDzwwzgBOItQHwMiHWJ0GwPxCeBeCkQM8MM+A7EclBDnPBoTgDiXUAsBNIM0gsy4B0QuwHxMiDmAeLtUIXooB2I5wMxGxB3ALEnEH+BhcEvII6GSrBBFTZC5UAuXA3EFVB1iUBcCTOVBc0WkMR9IJ4GxHVArAnFOlCXBgHxQWQNLFicOguIHwHxOiAOhYrdA2J3IL6DKxrRAQ+a3A+o8xmIMaAC6md2KH0FiLVwRTOyAbDAa0cKjzAgtoH6WxpqiAc2AySAeC80+r5D/d4BlfsIjeYFUK9tRI5mkAGK0JRlAw08ByBeg+ZSWPR1oLsUZMBTaOieAmJzKI0LVEIN+gtNueBoBJnuDxX8TkReAHnlJhCfRU4HX0jMxcdhDIAAAwCWaUA1qBZjTAAAAABJRU5ErkJggg==",standardmarker_image=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA69pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wUmlnaHRzPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvcmlnaHRzLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcFJpZ2h0czpNYXJrZWQ9IkZhbHNlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InV1aWQ6RkNCNEU4MzM0OTA4REYxMUE2MURCMjI3RURERjU5RjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTY1RjA3MDRDMTAwMTFFMDhDNzNDM0Y5QTQ5QjQ1OTgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTY1RjA3MDNDMTAwMTFFMDhDNzNDM0Y5QTQ5QjQ1OTgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0RTM3MEU5QkUxMjM2ODExOERCQkMxRjgyMEJGMzlFNSIg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",
standardmarker_shadow="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAkCAYAAAD/yagrAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpGREJEQjUxMTUyMjQ2ODExOERCQkMxRjgyMEJGMzlFNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxNjVGMDcwOEMxMDAxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxNjVGMDcwN0MxMDAxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZEQkRCNTExNTIyNDY4MTE4REJCQzFGODIwQkYzOUU1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZEQkRCNTExNTIyNDY4MTE4REJCQzFGODIwQkYzOUU1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+aE6NVAAAAhZJREFUeNrslutugkAQhVlQvGvTS9offf93a9PGajUIsrudjWeSyQYRAds0WZKTVSHycebMLMpaG/2HQwXQABpAA2gADaABNIAG0DagSqne/rNiVeK7PGyFTic8A/sEZZiEFGMdQAkkgQ1Jk0pSQTrisz1x9g+qBFhKGpHG0AhKARzjegtQB3cg7UjfWB208Um7gjKgg5mR5qQF1gl+HwpXlQfqHM1JW9IH6Z20cQ/ggw46upgCcEW6xzqDm6mIgZ9bmc8jHqYUrpYyr21BOYdjgD2QHkl3cHFYkce6RpL5teJc1BU0BqQDfCY9kZb4Lanp8KrDoPSc0Qxudh5PCrlzZX4lvQBy5JW47uB8lgDbIJtvpDXAjd/1gxZlH6JZVlgvQVoPUKOz96QvNNEnHC1wTdS19KpmgNuaQc4O5nBxB8g1Oj5DU5lzN74W1IqSOQemohkYiOF4mB/hFM9L1l4A6qoG6tpMRtx0DmcNYErcVO44Oa7PsB7ELnQR8NpmUiKfEzE3F4DcA5zdkdtj6YEZf1+vLF2LLVSJ7XGOLl+gGgUiwDnTZ140bBO4tqC+i0sxL9nFDZzMa8rY6j2yKagSe7h0MRZ7s9+tvb7YNgGNUVbOIruo4d62gYs3B41R6ikgOYu5yCJ3rb0V5CVQJZxcAlaJUZShefQtAZuCsptjnOc5WHgdHf01aCJecrXQrwGeA/0RYACGHUt80iKakgAAAABJRU5ErkJggg==");
standardmarker_shape={coord:[13,0,15,1,16,2,17,3,18,4,18,5,19,6,19,7,19,8,19,9,19,10,19,11,19,12,19,13,18,14,18,15,17,16,16,17,15,18,13,19,8,20,8,21,8,22,7,23,7,24,7,25,7,26,6,27,6,28,6,29,5,30,5,31,5,32,4,33,4,34,3,35,1,35,1,34,1,33,1,32,1,31,1,30,2,29,2,28,2,27,3,26,3,25,3,24,4,23,4,22,4,21,4,20,5,19,4,18,3,17,2,16,1,15,1,14,0,13,0,6,1,4,2,3,3,2,4,1,6,0,13,0],type:"poly"};khtml.maplib.overlay.InfoWindowOptions=function(a,b,e,c,f){if(a)this.content=a;if(f)this.position=f};
khtml.maplib.overlay.InfoWindow=function(a){this.infobox=document.createElement("div");this.infobox.style.position="absolute";this.infobox.style.left="-1000px";this.infobox.style.whiteSpace="nowrap";upperleftdiv=document.createElement("div");upperleftdiv.style.position="absolute";upperleftdiv.style.width="10px";upperleftdiv.style.height="10px";upperleftdiv.style.top=0;upperleftdiv.style.left=0;upperleftdiv.style.overflow="hidden";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?(upperleftimg=document.createElement("div"),upperleftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+corner_image+"')",upperleftimg.style.width="100%",upperleftimg.style.height="100%"):(upperleftimg=document.createElement("img"),upperleftimg.setAttribute("src",corner_image));upperleftimg.style.position="absolute";upperleftimg.style.top=0;upperleftimg.style.left=0;khtml.maplib.base.helpers.imageNotSelectable(upperleftimg);upperleftdiv.appendChild(upperleftimg);this.infobox.appendChild(upperleftdiv);
this.upperdiv=document.createElement("div");this.upperdiv.style.position="absolute";this.upperdiv.style.height="10px";this.upperdiv.style.left="10px";this.upperdiv.style.top=0;this.upperdiv.style.borderTop="1px solid gray";this.upperdiv.style.backgroundColor="white";this.infobox.appendChild(this.upperdiv);upperrightdiv=document.createElement("div");upperrightdiv.style.position="absolute";upperrightdiv.style.width="10px";upperrightdiv.style.height="10px";upperrightdiv.style.top=0;upperrightdiv.style.right=
0;upperrightdiv.style.overflow="hidden";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(upperrightimg=document.createElement("div"),upperrightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+corner_image+"')",upperrightimg.style.width="100%",upperrightimg.style.height="100%"):(upperrightimg=document.createElement("img"),upperrightimg.setAttribute("src",corner_image));upperrightimg.style.position=
"absolute";upperrightimg.style.top=0;upperrightimg.style.right=0;khtml.maplib.base.helpers.imageNotSelectable(upperrightimg);upperrightdiv.appendChild(upperrightimg);this.infobox.appendChild(upperrightdiv);this.leftdiv=document.createElement("div");this.leftdiv.style.position="absolute";this.leftdiv.style.width="10px";this.leftdiv.style.top="10px";this.leftdiv.style.left=0;this.leftdiv.style.borderLeft="1px solid gray";this.leftdiv.style.backgroundColor="white";this.infobox.appendChild(this.leftdiv);
lowerleftdiv=document.createElement("div");lowerleftdiv.style.position="absolute";lowerleftdiv.style.width="10px";lowerleftdiv.style.height="10px";lowerleftdiv.style.bottom=0;lowerleftdiv.style.left=0;lowerleftdiv.style.overflow="hidden";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(lowerleftimg=document.createElement("div"),lowerleftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+corner_image+
"')",lowerleftimg.style.width="100%",lowerleftimg.style.height="100%"):(lowerleftimg=document.createElement("img"),lowerleftimg.setAttribute("src",corner_image));lowerleftimg.style.position="absolute";lowerleftimg.style.bottom=0;lowerleftimg.style.left=0;khtml.maplib.base.helpers.imageNotSelectable(lowerleftimg);lowerleftdiv.appendChild(lowerleftimg);this.infobox.appendChild(lowerleftdiv);this.rightdiv=document.createElement("div");this.rightdiv.style.position="absolute";this.rightdiv.style.width=
"10px";this.rightdiv.style.top="10px";this.rightdiv.style.right=0;this.rightdiv.style.borderRight="1px solid gray";this.rightdiv.style.backgroundColor="white";this.infobox.appendChild(this.rightdiv);lowerrightdiv=document.createElement("div");lowerrightdiv.style.position="absolute";lowerrightdiv.style.width="10px";lowerrightdiv.style.height="10px";lowerrightdiv.style.bottom=0;lowerrightdiv.style.right=0;lowerrightdiv.style.overflow="hidden";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?(lowerrightimg=document.createElement("div"),lowerrightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+corner_image+"')",lowerrightimg.style.width="100%",lowerrightimg.style.height="100%"):(lowerrightimg=document.createElement("img"),lowerrightimg.setAttribute("src",corner_image));lowerrightimg.style.position="absolute";lowerrightimg.style.bottom=0;lowerrightimg.style.right=0;khtml.maplib.base.helpers.imageNotSelectable(lowerrightimg);lowerrightdiv.appendChild(lowerrightimg);
this.infobox.appendChild(lowerrightdiv);this.lowerdiv=document.createElement("div");this.lowerdiv.style.position="absolute";this.lowerdiv.style.height="10px";this.lowerdiv.style.left="10px";this.lowerdiv.style.bottom=0;this.lowerdiv.style.borderBottom="1px solid gray";this.lowerdiv.style.backgroundColor="white";this.infobox.appendChild(this.lowerdiv);khtml.maplib.base.helpers.setCursor(this.infobox,"default");this.infobox.content=document.createElement("div");this.infobox.content.style.position="absolute";
this.infobox.content.style.backgroundColor="white";if(a.content)this.infobox.content.innerHTML=a.content;this.infobox.appendChild(this.infobox.content);this.infobox.pointer=document.createElement("div");this.infobox.pointer.style.position="absolute";this.infobox.pointer.style.bottom="0";this.infobox.pointer.style.left="0";for(var b=0;b<10;b++){el=document.createElement("div");el.style.position="absolute";el.style.overflow="hidden";el.style.cursor="default";el.style.height=pointerheight/10+1+"px";
el.style.width=pointerwidth/2+4-pointerwidth/10/2*b+2+"px";el.style.bottom=-(b+1)*pointerheight/10+"px";el.style.left=pointerwidth/2-5*b-(10-b)/2+"px";if(navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7){var e=document.createElement("div");e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+pointer_image+"')";e.style.width="100%";e.style.height="100%"}else e=document.createElement("img"),e.setAttribute("src",
pointer_image);e.style.cursor="default";e.style.position="absolute";e.style.top=-b*pointerheight/10+"px";e.style.left=-pointerwidth/2+5*b+(10-b)/2+"px";e.style.zIndex=0;khtml.maplib.base.helpers.imageNotSelectable(e);el.appendChild(e);this.infobox.pointer.appendChild(el)}this.infobox.appendChild(this.infobox.pointer);this.closebutton=document.createElement("div");this.closebutton.style.position="absolute";navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)?
(this.closebutton.style.height="28px",this.closebutton.style.width="28px",this.closebutton.style.top="0px",this.closebutton.style.right="0px"):(this.closebutton.style.height="10px",this.closebutton.style.width="10px",this.closebutton.style.top="4px",this.closebutton.style.right="4px");this.closebutton.style.padding="0";this.closebutton.style.zIndex="10000";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(el=document.createElement("div"),
el.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+close_image+"')",el.style.width="100%",el.style.height="100%"):(el=document.createElement("img"),el.setAttribute("src",close_image));el.style.opacity=0.6;el.style.cursor="pointer";el.style.position="absolute";navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)?(el.style.width="20px",el.style.height="20px",el.style.top="4px",el.style.right="4px"):(el.style.width="10px",
el.style.height="10px",el.style.top=0,el.style.right=0);khtml.maplib.base.helpers.imageNotSelectable(el);el.setAttribute("onmouseover","javascript:this.style.opacity='1'");el.setAttribute("onmouseout","javascript:this.style.opacity='0.6'");this.closebutton.appendChild(el);this.infobox.appendChild(this.closebutton);khtml.maplib.base.helpers.eventAttach(this.closebutton,"click",function(){this.close()},this,!1);shadow={};this.shadow=document.createElement("div");this.shadow.style.position="absolute";
this.shadow.style.left="-1000px";this.shadow.upperleftdiv=document.createElement("div");this.shadow.upperleftdiv.style.position="absolute";this.shadow.upperleftdiv.style.width="30px";this.shadow.upperleftdiv.style.height="20px";this.shadow.upperleftdiv.style.top=0;this.shadow.upperleftdiv.style.overflow="hidden";shadow.upperleftimg=document.createElement("img");shadow.upperleftimg.style.position="absolute";shadow.upperleftimg.style.top=0;shadow.upperleftimg.style.left="-309px";navigator.userAgent.indexOf("MSIE")!=
-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.upperleftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.upperleftimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.upperleftimg);this.shadow.upperleftdiv.appendChild(shadow.upperleftimg);this.shadow.appendChild(this.shadow.upperleftdiv);this.shadow.upperrightdiv=document.createElement("div");this.shadow.upperrightdiv.style.position=
"absolute";this.shadow.upperrightdiv.style.width="30px";this.shadow.upperrightdiv.style.height="20px";this.shadow.upperrightdiv.style.top=0;this.shadow.upperrightdiv.style.right=0;this.shadow.upperrightdiv.style.overflow="hidden";shadow.upperrightimg=document.createElement("img");shadow.upperrightimg.style.position="absolute";shadow.upperrightimg.style.top=0;shadow.upperrightimg.style.right=0;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?shadow.upperrightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.upperrightimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.upperrightimg);this.shadow.upperrightdiv.appendChild(shadow.upperrightimg);this.shadow.appendChild(this.shadow.upperrightdiv);this.shadow.upperdiv=document.createElement("div");this.shadow.upperdiv.style.position="absolute";this.shadow.upperdiv.style.height=this.shadow.upperrightdiv.style.height;
this.shadow.upperdiv.style.top=this.shadow.upperleftdiv.style.top;this.shadow.upperdiv.style.overflow="hidden";shadow.upperimg=document.createElement("img");shadow.upperimg.style.position="absolute";shadow.upperimg.style.top=0;shadow.upperimg.style.right="-"+this.shadow.upperrightdiv.style.width;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.upperimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
shadow_image+"')":shadow.upperimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.upperimg);this.shadow.upperdiv.appendChild(shadow.upperimg);this.shadow.appendChild(this.shadow.upperdiv);this.shadow.lowerleftdiv=document.createElement("div");this.shadow.lowerleftdiv.style.position="absolute";this.shadow.lowerleftdiv.style.height="54px";this.shadow.lowerleftdiv.style.bottom=0;this.shadow.lowerleftdiv.style.left=0;this.shadow.lowerleftdiv.style.overflow="hidden";
shadow.lowerleftimg=document.createElement("img");shadow.lowerleftimg.style.position="absolute";shadow.lowerleftimg.style.bottom=0;shadow.lowerleftimg.style.left=0;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.lowerleftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.lowerleftimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.lowerleftimg);
this.shadow.lowerleftdiv.appendChild(shadow.lowerleftimg);this.shadow.appendChild(this.shadow.lowerleftdiv);this.shadow.lowerrightdiv=document.createElement("div");this.shadow.lowerrightdiv.style.position="absolute";this.shadow.lowerrightdiv.style.height="54px";this.shadow.lowerrightdiv.style.bottom=0;this.shadow.lowerrightdiv.style.overflow="hidden";shadow.lowerrightimg=document.createElement("img");shadow.lowerrightimg.style.position="absolute";shadow.lowerrightimg.style.bottom=0;shadow.lowerrightimg.style.right=
"-300px";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.lowerrightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.lowerrightimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.lowerrightimg);this.shadow.lowerrightdiv.appendChild(shadow.lowerrightimg);this.shadow.appendChild(this.shadow.lowerrightdiv);this.shadow.rightdiv=document.createElement("div");
this.shadow.rightdiv.style.position="absolute";this.shadow.rightdiv.style.top=this.shadow.upperrightdiv.style.height;this.shadow.rightdiv.style.right=0;this.shadow.rightdiv.style.overflow="hidden";shadow.rightimg=document.createElement("img");shadow.rightimg.style.position="absolute";shadow.rightimg.style.top="-"+this.shadow.upperrightdiv.style.height;shadow.rightimg.style.right=0;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=
7?shadow.rightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.rightimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.rightimg);this.shadow.rightdiv.appendChild(shadow.rightimg);this.shadow.appendChild(this.shadow.rightdiv);this.shadow.leftdiv=document.createElement("div");this.shadow.leftdiv.style.position="absolute";this.shadow.leftdiv.style.top=this.shadow.upperleftdiv.style.height;this.shadow.leftdiv.style.left=
0;this.shadow.leftdiv.style.overflow="hidden";shadow.leftimg=document.createElement("img");shadow.leftimg.style.position="absolute";shadow.leftimg.style.bottom="-"+this.shadow.lowerleftdiv.style.height;shadow.leftimg.style.left=0;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.leftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.leftimg.setAttribute("src",shadow_image);
khtml.maplib.base.helpers.imageNotSelectable(shadow.leftimg);this.shadow.leftdiv.appendChild(shadow.leftimg);this.shadow.appendChild(this.shadow.leftdiv);this.shadow.middlediv=document.createElement("div");this.shadow.middlediv.style.position="absolute";this.shadow.middlediv.style.top=this.shadow.upperleftdiv.style.height;this.shadow.middlediv.style.overflow="hidden";shadow.middleimg=document.createElement("img");shadow.middleimg.style.position="absolute";shadow.middleimg.style.top="-"+this.shadow.upperleftdiv.style.height;
shadow.middleimg.style.left=parseInt(shadow.upperleftimg.style.left)-parseInt(this.shadow.upperleftdiv.style.height)+"px";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.middleimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.middleimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.middleimg);this.shadow.middlediv.appendChild(shadow.middleimg);
this.shadow.appendChild(this.shadow.middlediv);this.shadow.pointer=document.createElement("div");this.shadow.pointer.style.position="absolute";this.shadow.pointer.style.overflow="hidden";this.shadow.pointer.style.width="140px";this.shadow.pointer.style.height="54px";this.shadow.pointer.style.bottom=0;shadow.pointerimg=document.createElement("img");shadow.pointerimg.style.position="absolute";shadow.pointerimg.style.bottom=0;shadow.pointerimg.style.left="-255px";navigator.userAgent.indexOf("MSIE")!=
-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.pointerimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.pointerimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.pointerimg);this.shadow.pointer.appendChild(shadow.pointerimg);this.shadow.appendChild(this.shadow.pointer);this.render=function(){typeof this.anchorObject=="object"?(this.xy=this.mapObj.latlngToXY(this.anchorObject.getPosition()),
this.offset=this.anchorObject.pixelOffset?this.anchorObject.pixelOffset():{x:0,y:0}):a?(this.xy=a.position?this.mapObj.latlngToXY(a.position):this.mapObj.latlngToXY(this.mapObj.getCenter()),a.pixelOffset?(this.offset.x=a.pixelOffset.x?a.pixelOffset.x:0,this.offset.y=a.pixelOffset.y?a.pixelOffset.y:0):this.offset={x:0,y:0}):this.xy=this.mapObj.latlngToXY(this.mapObj.getCenter());this.infobox.style.left=this.xy.x+this.offset.x-(parseInt(this.infobox.style.width)-pointerwidth)/2+"px";this.infobox.style.bottom=
-this.xy.y+this.offset.y+pointerheight-1+"px";this.infobox.style.zIndex=parseInt(this.xy.y)+this.mapObj.size.height;this.shadow.style.left=parseInt(this.infobox.style.left)+pointerheight/2+"px";this.shadow.style.bottom=parseInt(this.infobox.style.bottom)-pointerheight+"px";this.shadow.style.zIndex=parseInt(this.xy.y);this.opened&&this._moveMap()};this.open=function(a,b){this.mapObj=a;this.anchorObject=b;if(!this.mapObj.overlayDiv.infoboxShadowDiv)this.mapObj.overlayDiv.infoboxShadowDiv=document.createElement("div"),
this.mapObj.overlayDiv.appendChild(this.mapObj.overlayDiv.infoboxShadowDiv),this.mapObj.overlayDiv.infoboxShadowDiv.setAttribute("id","infoboxShadowDiv");this.shadow.parentNode&&this.shadow.parentNode.removeChild(this.shadow);this.mapObj.overlayDiv.infoboxShadowDiv.appendChild(this.shadow);if(!this.mapObj.overlayDiv.infoboxDiv)this.mapObj.overlayDiv.infoboxDiv=document.createElement("div"),this.mapObj.overlayDiv.appendChild(this.mapObj.overlayDiv.infoboxDiv),this.mapObj.overlayDiv.infoboxDiv.setAttribute("id",
"infoboxDiv");this.infobox.parentNode&&this.infobox.parentNode.removeChild(this.infobox);this.mapObj.overlayDiv.infoboxDiv.appendChild(this.infobox);this.opened=!0;this.mapObj.addOverlay(this);this.infobox.style.width=parseInt(this.infobox.content.offsetWidth)>250?parseInt(this.infobox.content.offsetWidth)+20+"px":"270px";if(parseInt(this.infobox.content.offsetWidth)>parseInt(this.mapObj.size.width)-40)this.infobox.style.width=parseInt(this.mapObj.size.width)-20+"px",this.infobox.style.whiteSpace=
"normal";if(parseInt(this.infobox.content.offsetWidth)>640)this.infobox.style.width="660px",this.infobox.style.whiteSpace="normal";this.infobox.content.style.left="10px";this.infobox.content.style.width=parseInt(this.infobox.style.width)-20+"px";this.infobox.style.height=parseInt(this.infobox.content.offsetHeight)>60?parseInt(this.infobox.content.offsetHeight)+20+"px":"80px";if(parseInt(this.infobox.content.offsetHeight)>parseInt(this.mapObj.size.height)-40-pointerheight-this.offset.y)this.infobox.style.height=
this.mapObj.size.height-pointerheight-this.offset.y-20+"px",this.infobox.content.style.overflowY="scroll",this.infobox.content.style.overflow="auto",this.infobox.content.style.WebkitOverflowScrolling="touch";this.upperdiv.style.width=parseInt(this.infobox.style.width)-20+"px";this.leftdiv.style.height=parseInt(this.infobox.style.height)-20+"px";this.rightdiv.style.height=parseInt(this.infobox.style.height)-20+"px";this.lowerdiv.style.width=parseInt(this.infobox.style.width)-20+"px";this.infobox.content.style.top=
"10px";this.infobox.content.style.height=parseInt(this.infobox.style.height)-20+"px";this.infobox.pointer.style.left=(parseInt(this.infobox.style.width)-pointerwidth)/2+"px";this.shadow.style.width=parseInt(this.infobox.style.width)+Math.floor(parseInt(this.infobox.style.height)/2)+"px";this.shadow.style.height=Math.ceil(parseInt(this.infobox.style.height)/2)+pointerheight/2+"px";this.shadow.pointer.style.left=parseInt(this.infobox.pointer.style.left)-pointerheight/2+"px";this.shadow.lowerleftdiv.style.width=
this.shadow.pointer.style.left;this.shadow.upperleftdiv.style.left=Math.floor(parseInt(this.infobox.style.height)/2)-(parseInt(this.shadow.lowerrightdiv.style.height)-pointerheight/2)-9+"px";this.shadow.lowerrightdiv.style.left=parseInt(this.shadow.pointer.style.left)+parseInt(this.shadow.pointer.style.width)+"px";this.shadow.lowerrightdiv.style.width=parseInt(this.shadow.style.width)-parseInt(this.shadow.pointer.style.left)-parseInt(this.shadow.pointer.style.width)-parseInt(this.shadow.upperleftdiv.style.left)+
9+"px";this.shadow.upperdiv.style.left=parseInt(this.shadow.upperleftdiv.style.left)+parseInt(this.shadow.upperleftdiv.style.width)+"px";this.shadow.upperdiv.style.width=parseInt(this.shadow.style.width)-parseInt(this.shadow.upperleftdiv.style.left)-parseInt(this.shadow.upperleftdiv.style.width)-parseInt(this.shadow.upperrightdiv.style.width)+"px";this.shadow.rightdiv.style.width=Math.floor(parseInt(this.infobox.style.height)/2)+"px";this.shadow.rightdiv.style.height=parseInt(this.shadow.style.height)-
74+"px";this.shadow.leftdiv.style.width=Math.floor(parseInt(this.infobox.style.height)/2)+"px";this.shadow.leftdiv.style.height=parseInt(this.shadow.style.height)-74+"px";this.shadow.middlediv.style.left=this.shadow.leftdiv.style.width;this.shadow.middlediv.style.width=parseInt(this.shadow.style.width)-parseInt(this.shadow.leftdiv.style.width)-parseInt(this.shadow.rightdiv.style.width)+"px";this.shadow.middlediv.style.height=parseInt(this.shadow.style.height)-parseInt(this.shadow.upperdiv.style.height)-
parseInt(this.shadow.lowerleftdiv.style.height)+"px";khtml.maplib.base.helpers.eventAttach(this.infobox,"DOMMouseScroll",khtml.maplib.base.helpers.cancelEvent,this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox,"dblclick",khtml.maplib.base.helpers.cancelEvent,this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox.content,"mousedown",khtml.maplib.base.helpers.cancelEvent,this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox.content,"touchstart",khtml.maplib.base.helpers.cancelEvent,
this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox.content,"touchmove",khtml.maplib.base.helpers.cancelEvent,this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox,"mousedown",function(a){khtml.maplib.base.helpers.stopEventPropagation(a);khtml.maplib.base.helpers.cancelEvent(a)},this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox.content,"contextmenu",khtml.maplib.base.helpers.cancelEvent,this,!1);if(this.anchorObject){var c=this;this.anchorObject.position.addCallbackFunction(function(){c.render()})}};
this.clear=function(){if(this.infobox&&this.infobox.parentNode)try{this.infobox.parentNode.removeChild(this.infobox)}catch(a){}if(this.shadow&&this.shadow.parentNode)try{this.shadow.parentNode.removeChild(this.shadow)}catch(b){}this.opened=!1};this.close=function(){this.mapObj.removeOverlay(this)};this.setContent=function(a){this.infobox.content.innerHTML=a};var c=1,f=1;this._moveMap=function(){var a=this;this.infobox.offsetLeft+parseInt(this.infobox.style.width)>this.mapObj.size.width-10?(this.infobox.offsetLeft+
parseInt(this.infobox.style.width)<this.mapObj.size.width?c=10-(this.mapObj.size.width-(this.infobox.offsetLeft+parseInt(this.infobox.style.width))):c<20&&c++,this.infobox.offsetTop<10?(this.infobox.offsetTop>0?f=10-this.infobox.offsetTop:f<20&&f++,window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-c,f)},10)):this.xy.y>this.mapObj.size.height-10?(this.xy.y<this.mapObj.size.height?f=10-(this.mapObj.size.height-this.xy.y):f<20&&f++,window.clearInterval(this.mapmoveInterval),
this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-c,-f)},10)):(window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-c,0)},10))):this.infobox.offsetLeft<10?(this.infobox.offsetLeft>0?c=10-this.infobox.offsetLeft:c<20&&c++,this.infobox.offsetTop<10?(this.infobox.offsetTop>0?f=10-this.infobox.offsetTop:f<20&&f++,window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(c,f)},
10)):this.xy.y>this.mapObj.size.height-10?(this.xy.y<this.mapObj.size.height?f=10-(this.mapObj.size.height-this.xy.y):f<20&&f++,window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(c,-f)},10)):(window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(c,0)},10))):this.infobox.offsetTop<10?(this.infobox.offsetTop>0?f=10-this.infobox.offsetTop:f<20&&f++,window.clearInterval(this.mapmoveInterval),
this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(0,f)},10)):this.xy.y>this.mapObj.size.height-10?(this.xy.y<this.mapObj.size.height?f=10-(this.mapObj.size.height-this.xy.y):f<20&&f++,window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(0,-f)},10)):(window.clearInterval(this.mapmoveInterval),mapMoveSpeed=1,this.opened=!1)};this._clickdetectstart=function(a){if(a.touches.length==1)this.clickDetectY=this.clickDetectX=-1};this._clickdetectmove=
function(a){if(a.touches.length==1)this.clickDetectX=a.touches[0].pageX,this.clickDetectY=a.touches[0].pageY};this._clickdetectstop=function(a){a.touches.length==0&&this.clickDetectX==-1&&this.clickDetectY==-1&&this.close()};khtml.maplib.base.helpers.eventAttach(this.closebutton,"touchstart",this._clickdetectstart,this,!1);khtml.maplib.base.helpers.eventAttach(this.closebutton,"touchmove",this._clickdetectmove,this,!1);khtml.maplib.base.helpers.eventAttach(this.closebutton,"touchend",this._clickdetectstop,
this,!1)};var pointerwidth=90,pointerheight=70;
if(navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7)var pointer_image=khtml.maplib.standardimagepath+"./pointer_nor.png",corner_image=khtml.maplib.standardimagepath+"./corners_nor.png",shadow_image=khtml.maplib.standardimagepath+"./shadow_nor.png",close_image=khtml.maplib.standardimagepath+"./close_nor.png";else pointer_image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABGCAYAAABMvIPiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowNDgwMTE3NDA3MjA2ODExOERCQkRDOEYwREVGMEUzQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNzQ4NEUxRkMwQkMxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNzQ4NEUxRUMwQkMxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkVBRjUzOEVGN0UyMDY4MTE4REJCREM4RjBERUYwRTNBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA0ODAxMTc0MDcyMDY4MTE4REJCREM4RjBERUYwRTNBIi8+IDwvcmRmOkRlc2NyaXB0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",corner_image=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpFREY1MzhFRjdFMjA2ODExOERCQkRDOEYwREVGMEUzQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCMERGRjZBNEMwQkIxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCMERGRjZBM0MwQkIxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkYxRjUzOEVGN0UyMDY4MTE4REJCREM4RjBERUYwRTNBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkVERjUzOEVGN0UyMDY4MTE4REJCREM4RjBERUYwRTNBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+qUowwgAAAgJJREFUeNqslF1kW2EYx5+T0y1ChIRxktGrfBDGOCE3vYhcHSmj7GpUu5vdjVHKbCRh097sYlezq+1mjUQJIzLKmJBQCSHycRESJRLCiIREpbL/E++ptouk69mfv/N4znl/53m/HikWi9ECWeFn8BNYhRWRP4NL8LHweTQavTZwbQHsBXygqqrD5/OR0+kkq9U6fzEYDNa73e56rVbbqlQqB0jtCfClpCsV3oc/A7QbCARIURRaplarRcVikQA/RJWv9bwcCoX0+EswGNyJRCKXFS2T3W4nt9tNk8lkI5FI3APnJ+dN+jRR2bamafQvMpvNFA6HGfwmHo9rOpDLecfTvIssFguJsR8AlRm4jcSDVWu2TLx5Ho/Hj1Bj4KbX6yWjEoxNBqp8NIxKMFSTLMvKbXZ1lWw2Gz8emiRJov8hwZFN0+n093g8NgwcjUb86PEannY6HcNAwThlYLrRaBgGCkaagUelUqlvpEqGNZvNGsITBvLk9/mi30XoQJRMJi8QvkKTuNDv8tdyufwpm83ScDi8NazX61Eul+PwLWAnN7vND0z7vFAobOBcyi6Xayksn89TKpUaoT++BOzjogbLZb+Hv2cymW/tdvuR3+8nh8Mx742z2WxeUb/fp3q9zuv2C98+B6y1qmNX4EC1Wt2CnyJ2w4/FD8swL35a+C/9EWAAn8a43yIKi2QAAAAASUVORK5CYII=",
shadow_image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA90AAAF0CAYAAAA+QlqJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTVGMzFDQzlDMEQ3MTFFMDhDNzNDM0Y5QTQ5QjQ1OTgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTVGMzFDQzhDMEQ3MTFFMDhDNzNDM0Y5QTQ5QjQ1OTgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmRpZDo1QUJFM0JCQjU5MjA2ODExOTEwOUY4MjY5NjY1RDIxRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1QUJFM0JCQjU5MjA2ODExOTEwOUY4MjY5NjY1RDIxRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnYug9wAABhFSURBVHja7N2LUhs7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",
close_image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowOTgwMTE3NDA3MjA2ODExOERCQkRDOEYwREVGMEUzQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNzQ4NEUyM0MwQkMxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNzQ4NEUyMkMwQkMxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA5ODAxMTc0MDcyMDY4MTE4REJCREM4RjBERUYwRTNBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA5ODAxMTc0MDcyMDY4MTE4REJCREM4RjBERUYwRTNBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jr2YPQAAAUVJREFUeNpitLe3Z6AmYMIhzk+EXiFiDewF4pNALIHHMDkgPgPE0wgZ2AXERUCsDsQHcBgKMuwwECsCcSYQT8ZlYDsQlyLxYYZKI4kpQg2TQxLLAeIJ6AbCbEMHIEP3Qg1VwWIYDMRCzYAbeB+I3YD4Iw5Dj0ENk8Yi/xqInaFmoHj5FFTiI45wk8BhmAMQX8AVKWehhr4jItm8gBp2jVCyOYvHpXgNw5ewCYH/QPyd2IRtDI1ZfLlFEikt4jXQEmqYEBGulIOmU0VcBoIM247DZU+gMYov16AYCHLRLhyG3QFiC2gkvMAiLw01VAjZQFAyKcCi+CbUoKfQGMVl6CxYUkP28lwgTkHiX0MyDJsFMNAExWDAgmYTyFBmIM6HpsUXOFztDI08kPp6ZElGHCU2GxD/IqKAfUdswv5FRLLBmj0BAgwAom1FkjBGocAAAAAASUVORK5CYII=";khtml.maplib.overlay.SimpleMarker=function(a,b,e){this.nodeName=this.nodeType="SimpleMarker";this.geometry={};this.geometry.coordinates=a;this.geometry.type="Point";this.type="SimpleMarker";var c=document.createElement("div");c.appendChild(b);c.style.position="absolute";if(e){if(e.dy)c.style.top=typeof e.dy=="number"?e.dy+"px":e.dy;if(e.dx)c.style.left=typeof e.dx=="number"?e.dx+"px":e.dx}else c.style.top="0px",c.style.left="0px";var f=document.createElement("div");f.style.position="absolute";f.appendChild(c);
this.marker=f;this.point=a;this.options=e;this.el=b;this.init=function(a){this.style=this.marker.style;this.owner=a;this.marker.owner=this;this.mapObj=a instanceof khtml.maplib.base.Map?a:a.map;a.overlayDiv.appendChild(this.marker)};this.render=function(){if(this.mapObj&&this.marker&&this.point&&!isNaN(this.point.lat())&&!isNaN(this.point.lng())){var a=this.mapObj.latlngToXY(this.point);a.x<0||a.y<0?this.marker.style.display="none":(this.marker.style.display="",this.marker.style.left=a.x+"px",this.marker.style.top=
a.y+"px");this.marker.parentNode||this.owner.overlayDiv.appendChild(this.marker)}};this.position=function(a){if(a)this.point=a,this.render();return this.point};this.hide=function(){this.marker.style.display="none"};this.clear=function(){this.marker&&this.marker.parentNode&&this.marker.parentNode.removeChild(this.marker)};this.destroy=function(){this.clear()};this.moveable=function(a){(this.enabled=a)?(this.downevent=khtml.maplib.base.helpers.eventAttach(this.marker,"mousedown",this.down,this,!0),
this.moveevent=khtml.maplib.base.helpers.eventAttach(window,"mousemove",this.move,this,!0),this.upevent=khtml.maplib.base.helpers.eventAttach(window,"mouseup",this.up,this,!0)):(khtml.maplib.base.helpers.eventRemove(this.downevent),khtml.maplib.base.helpers.eventRemove(this.moveevent),khtml.maplib.base.helpers.eventRemove(this.upevent))};this.moving=!1;this.dy=this.dx=0;this.down=function(a){this.moving=!0;this.dx=this.marker.offsetLeft-this.mapObj.pageX(a);this.dy=this.marker.offsetTop-this.mapObj.pageY(a)};
this.move=function(a){if(this.moving){this.mapObj.pageX(a);this.mapObj.pageY(a);var b=this.mapObj.mouseToLatLng(a);this.point.lat(b.lat());this.point.lng(b.lng());this.render();a.stopPropagation()}};this.up=function(){this.moving=!1}};khtml.maplib.overlay.WMS=function(a){this.type="Feature";this.geometry={};this.geometry.type="WMS";this.options=a;this.delayTimeout=null;this.init=function(a){this.owner=a;this.map=this.owner.map instanceof khtml.maplib.Map?this.owner.map:a};this.render=function(){if(map.finalDraw){this.bounds=this.map.bounds();this.map.bounds().getCenter();var a=this.map.bounds().sw().lat(),b=this.map.bounds().ne().lat(),f=this.map.bounds().sw().lng(),d=this.map.bounds().ne().lng(),g=this.map.size.width,m=this.map.size.height,
h="",k;for(k in this.options.layers)h+=this.options.layers[k]+",";h=h.substring(0,h.length-1);a=this.options.url+"?SERVICE=WMS&REQUEST=GetMap&VERSION=1.1.0&FORMAT="+(this.options.parameters.FORMAT?this.options.parameters.FORMAT:"image/png")+"&SRS=EPSG%3A4326&TILED=false&LAYERS="+h+"&BBOX="+f+","+a+","+d+","+b+"&WIDTH="+g+"&HEIGHT="+m;this.tempImg=document.createElement("img");this.tempImg.setAttribute("src",a);khtml.maplib.base.helpers.eventAttach(this.tempImg,"load",this._imgLoaded,this.marker,!1)}else this.map.zoom(),
this.oldZoom=this.map.zoom()};var b=this;this._imgLoaded=function(){var a=b.options.opacity,c={dx:-b.map.size.width/2,dy:-b.map.size.height/2};b.groundOverlay&&b.map.removeOverlay(b.groundOverlay);b.tempImg.style.opacity=a;b.groundOverlay=new khtml.maplib.overlay.GroundOverlay(b.bounds,b.tempImg,c);b.map.addOverlay(b.groundOverlay)}};khtml.maplib.overlay.GroundOverlay=function(a,b,e){this.geometry={};this.geometry.type="GroundOverlay";this.options=e;this.type="Feature";this._createRenderElement=function(){var a=document.createElement("div");a.appendChild(this.el);a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.margin="0px";a.style.padding="0px";if(this.options){if(this.options.dy)a.style.top=this.options.dy;if(this.options.dx)a.style.left=this.options.dx}return a};this._calcImageSize=function(){var a=
this.map.latlngToXY(this.bbox.sw()),b=this.map.latlngToXY(this.bbox.ne()),d=this.map.latlngToXY(this.bbox.nw());dx=b.x-a.x;dy=a.y-b.y;this.renderElement.style.width=dx;this.renderElement.style.height=dy;this.renderElement.style.left=d.x+"px";this.renderElement.style.top=d.y+"px";if((a=this.renderElement.getElementsByTagName("img")[0])&&a.tagName=="IMG")a.width=dx,a.height=dy};this.init=function(a){this.owner=a;this.map=a instanceof khtml.maplib.base.Map?a:a.map;khtml.maplib.base.helpers.rotate(this.renderElement,
this.rotation*-1)};this.render=function(){this.renderElement&&this.point&&!isNaN(this.point.lat())&&!isNaN(this.point.lng())&&this.map&&(null==this.renderElement.parentNode&&this.owner.overlayDiv.appendChild(this.renderElement),this._calcImageSize())};this.bounds=function(){if(this.rotation){khtml.maplib.base.Log.log("lng: "+this.bbox.sw().lng()+"; lat:"+this.bbox.sw().lat());var a=this._transformPoint(this.bbox.sw());khtml.maplib.base.Log.log("lng: "+a.lng()+"; lat:"+a.lat());var b=this._transformPoint(this.bbox.se()),
d=this._transformPoint(this.bbox.ne()),g=this._transformPoint(this.bbox.nw()),e=Math.min(a.lng(),b.lng(),d.lng(),g.lng()),h=Math.min(a.lat(),b.lat(),d.lat(),g.lat()),k=Math.max(a.lng(),b.lng(),d.lng(),g.lng());a=Math.max(a.lat(),b.lat(),d.lat(),g.lat());khtml.maplib.base.Log.log("in bounds");return new khtml.maplib.geometry.Bounds(new khtml.maplib.LatLng(h,e),new khtml.maplib.geometry.Point(a,k))}else return this.bbox};this._transformPoint=function(a){var b=this.bbox.getCenter(),d=b.lng();b=b.lat();
var g=this.rotation*Math.PI/180;khtml.maplib.base.Log.log("theta: "+g);khtml.maplib.base.Log.log("rotation: "+this.rotation);var e=a.lng();a=a.lat();a=new khtml.maplib.LatLng(b-(e-d)*Math.sin(g)+(a-b)*Math.cos(g),d+(e-d)*Math.cos(g)+(a-b)*Math.sin(g));d=new khtml.maplib.overlay.SimpleMarker(a,"http://www.din-5008-richtlinien.de/bilder/punkt.gif",{dx:-1,dy:-1});map.addOverlay(d);return a};this.position=function(a){if(a)this.point=a;return this.point};this.clear=function(){this.renderElement.parentNode.removeChild(this.renderElement)};
this.makeMoveable=function(){khtml.maplib.base.helpers.eventAttach(this.renderElement,"mousedown",this.down,this,!1);khtml.maplib.base.helpers.eventAttach(window,"mousemove",this.move,this,!0);khtml.maplib.base.helpers.eventAttach(window,"mouseup",this.up,this,!0)};this.moving=!1;this.dy=this.dx=0;this.down=function(a){this.moving=!0;this.dx=this.renderElement.offsetLeft-this._map.pageX(a);this.dy=this.renderElement.offsetTop-this._map.pageY(a)};this.move=function(a){if(this.moving){var b=this._map.pageX(a)+
this.dx,d=this._map.pageY(a)+this.dy;this.point=this._map.XYTolatlng(b,d);this.render();a.stopPropagation()}};this.up=function(){this.moving=!1};this.options=e;this.el=b;this.bbox=a;this.point=this.bbox.nw();if(e!=void 0&&e.rotation!=void 0)this.rotation=e.rotation;this.renderElement=this._createRenderElement()};khtml.maplib.overlay.renderer.Styler=function(){function a(a,f){if(a.search(/^rgb\(/)!=-1){khtml.maplib.base.Log.log("test1");var d;d=a.replace("rgb(","rgba(");return d=d.replace(")",","+f+")")}a[0]!="#"&&(a=="none"?(a="000000",f=0):a="#"+b[a]);d="rgba(";a.charAt(0)=="#"&&(a=a.substr(1));a.length==3&&(a=a.charAt(0)+a.charAt(0)+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2));a=a.toUpperCase();var g=0;for(i=0;i<a.length;i++){var m;for(j=0;j<e.length;j++)if(a.charAt(i)==e[j]){m=j;break}i%2==0?g=m*16:
(g+=m,d+=i==a.length-1?g+","+f+")":g+", ")}return d}this.classes=[];this.makeCanvasStyle=function(a){if(a.canvasStyle&&!a.documentElement.map.finalDraw)return a.canvasStyle;for(var b=a,d=null,e=[],m=a.style;!b.map;)e.push(b),b=b.parentNode;for(b=e.length-1;b>=0;b--){var h=e[b];if(h.className){this.classes[h.className.baseVal]||(this.classes[h.className.baseVal]=this.getCssStyles(h.className.baseVal));var k=this.classes[h.className.baseVal];d=d?this.mergeStyles(k,d):k;h.style&&(d=this.mergeStyles(h.style,
d))}}d&&(d=this.mergeStyles(m,d));if(a.geometry.type!="Polygon"&&a.geometry.type!="MultiPolygon")d.fillOpacity=0;d=this.cssToCanvas(d);return a.canvasStyle=d};this.mergeStyles=function(a,b){var d={},e;for(e in a)d[e]=a[e];d.opacity?b.opacity!=void 0&&(d.opacity*=b.opacity):d.opacity=b.opacity;d.fillOpacity?b.fillOpacity!=void 0&&(d.fillOpacity*=b.fillOpacity):d.fillOpacity=b.fillOpacity;d.strokeOpacity?b.strokeOpacity!=void 0&&(d.strokeOpacity*=b.strokeOpacity):d.strokeOpacity=b.strokeOpacity;if(!d.stroke)d.stroke=
b.stroke;if(!d.fill)d.fill=b.fill;if(!d.strokeWidth)d.strokeWidth=parseFloat(b.strokeWidth);d.strokeWidth=parseFloat(d.strokeWidth);return d};this.rgba=[];this.cssToCanvas=function(b){if(!b.stroke)b.stroke="none";if(!b.fill)b.fill="black";if(b.opacity==void 0)b.opacity=1;if(b.strokeOpacity==void 0)b.strokeOpacity=1;if(b.fillOpacity==void 0)b.fillOpacity=1;if(!b.strokeWidth)b.strokeWidth=1;if(b.stroke){var f=b.opacity*b.strokeOpacity,d=b.stroke+"_"+f;this.rgba[d]||(this.rgba[d]=a(b.stroke,f));d=b.stroke;
var e=f,m=this.rgba[b.stroke+"_"+f]}if(b.fill){f=b.opacity*b.fillOpacity;this.rgba[b.fill+"_"+f]||(this.rgba[b.fill+"_"+f]=a(b.fill,f));var h=b.fill,k=f;f=this.rgba[b.fill+"_"+f]}else h=0,k=1,f=0;return{strokeStyle:m,fillStyle:f,lineWidth:b.strokeWidth,fillRGB:h,strokeRGB:d,fillOpacity:k,strokeOpacity:e}};this.getCssStyles=function(a){for(var b={},d=0;d<document.styleSheets.length;d++){var e=document.styleSheets[d];e=e.cssRules?e.cssRules:e.rules;if(!e)break;for(r=0;r<e.length;r++){var m=e[r].style.cssText;
selectorText=e[r].selectorText;if(selectorText=="."+a){m=m.split(";");for(var h=0;h<m.length;h++){var k=m[h].split(":");if(k.length>1){var l=k[0].replace(/^\s/,"");k=k[1].replace(/^\s/,"");if(l=="stroke")b.stroke=k;if(l=="fill")b.fill=k;if(l=="stroke-width")b.strokeWidth=parseFloat(k);if(l=="opacity")b.opacity=parseFloat(k);if(l=="fill-opacity")b.fillOpacity=parseFloat(k);if(l=="stroke-opacity")b.strokeOpacity=parseFloat(k)}}}}}return b};var b={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",
aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",
darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",
ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",
mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",
peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",
white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"]};khtml.maplib.overlay.GeoJson=function(){this.backend="svg";this.deltaY=this.deltaX=this.count=0;this.init=function(a){this.map=a;this.root&&this.root.parentNode.removeChild(this.root);this.element&&(this.element.parentNode.removeChild(this.element),delete this.element);this.root=document.createElement("div");this.root.style.position="absolute";this.root.setAttribute("GeoJson","root");this.root.setAttribute("id","root");this.map.overlayDiv.appendChild(this.root);this.load({type:"FeatureCollection"})};
this.load=function(a){if(!this.element&&(this.element=this.renderElement(this.root),this.backend=="canvas"))this.context=this.element.getContext("2d"),this.canvasStyler=new khtml.maplib.overlay.renderer.Styler;this.parentNode=this.featureCollection=this.recurseInit(a);this.recurseLinksDirty=!0};this.bounds=this.lastzoom=null;this.render=function(a){if(this.featureCollection)if(this.recurseLinksDirty&&this.recurseLink(),!a&&(!this.map.finalDraw||this.map.moving)){if(this.element.finished)this.visibleElement=
this.element;else{if(!this.oldelement)return;this.visibleElement=this.oldelement}if(this.visibleElement.bounds)this.visibleElement.style.display="",this.visibleElement.bottomleft=this.map.latlngToXY(this.visibleElement.bounds.sw()),this.visibleElement.topright=this.map.latlngToXY(this.visibleElement.bounds.ne()),a=this.visibleElement.bottomleft.x,this.visibleElement.style.top=this.visibleElement.topright.y+"px",this.visibleElement.style.left=a+"px",this.visibleElement.style.width=this.visibleElement.topright.x-
this.visibleElement.bottomleft.x+"px",this.visibleElement.style.height=-this.visibleElement.topright.y+this.visibleElement.bottomleft.y+"px"}else{if(!this.element)this.element=this.renderElement();if(this.element.finished)this.oldelement&&this.root.removeChild(this.oldelement),this.backend=="canvas"?(this.oldelement=this.element,this.element=this.renderElement()):this.oldelement=this.element.cloneNode(!0),this.root.appendChild(this.oldelement),this.oldelement.bounds=this.element.bounds,this.oldelement.style.display=
"",this.element.style.display="none",this.element.finished=!1,this.element.topright=null,this.element.setAttribute("viewBox","0 0 "+this.map.size.width+" "+this.map.size.height);this.element.style.top="0px";this.element.style.left="0px";this.element.style.width=this.map.size.width+"px";this.element.style.height=this.map.size.height+"px";this.element.bounds=this.map.bounds();this.lastzoom=this.map.zoom();this.clear();a=this.featureCollection;this.recurse(a,a);this.deltaY=this.deltaX=0}};this.makeGroupElements=
function(a,b){a.element=document.createElementNS("http://www.w3.org/2000/svg","g");a.element.bounds=this.map.bounds();b.appendChild(a.element);for(var e=0;e<a.features.length;e++)a.features[e].type=="FeatureCollection"&&this.makeGroupElements(a.features[e],a.element);a.style=a.element.style};this.renderbackend=function(a){var b=this.featureCollection.toJSON();this.root.removeChild(this.element);delete this.element;this.backend=a;this.load(b);this.render(!0)};this.draw=function(){this.recurseLinksDirty=
!0;this.render(!0)};this.hide=function(){this.root.style.display="none"};this.recurse=function(a,b){var e=this;this.busy=!0;if(!(this.topright||!this.map.doTheOverlays&&!this.map.finalDraw)){if(b)var c=new Date-b;else b=new Date,c=0;if(a&&a.following)if(c<50){for(c=0;c<100;c++){if(!a)break;a.render();a=a.following}if(a)e.recurse(a.following,b);else{e.cleanup();return}}else setTimeout(function(){e.recurse(a.following,new Date)},0);else e.cleanup();a&&a.render()}};this.cleanup=function(){this.oldelement&&
(this.root.removeChild(this.oldelement),delete this.oldelement);this.element.style.display="";this.element.finished=!0;this.root.style.display=""};this.recurseInit=function(a,b,e){b||(b=a);var c=b.type=="FeatureCollection"?new khtml.maplib.geometry.FeatureCollection(b,this):new khtml.maplib.geometry.Feature(b,this);if(e)c.parentNode=e;if(e)c.documentElement=e.documentElement;if(e)c.owner=e;if(b.type=="FeatureCollection"&&b.features)for(e=0;e<b.features.length;e++){var f=this.recurseInit(a,b.features[e],
c);c.features.push(f)}return c};this.recurseLinksDirty=!0;this.recurseLink=function(a,b,e){if(!a)this.removeLinks(),a=this.featureCollection,this.last=null;e||(e=0);b||(b=a);if(this.last)b.preceding=this.last,this.last.following=b;this.last=b;if(b.type=="FeatureCollection"){for(var c=0;c<b.features.length;c++){this.recurseLink(a,b.features[c],e+1);if(c==0)b.features[c].precedingSibling=null;if(c>0)b.features[c].precedingSibling=b.features[c-1];if(c<b.features.length-1)b.features[c].followingSibling=
b.features[c+1];if(c==b.features.length-1)b.features[c].followingSibling=null}if(b.features[0])b.firstChild=b.features[0],b.lastChild=b.features[b.features.length-1]}if(e==0)this.recurseLinksDirty=!1};this.removeLinks=function(a){if(!a)a=this.featureCollection;if(a.features)for(var b=0;b<a.features.length;b++)this.removeLinks(a.features[b]);a.following=null;a.preceding=null;a.followingSibling=null;a.precedingSibling=null};this.initFeature=function(a){return new khtml.maplib.geometry.Feature(a)};this.clear=
function(){};this.renderElement=function(){switch(this.backend){case "svg":var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.height=this.map.size.height+"px";a.style.width=this.map.size.width+"px";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.setAttribute("viewBox","0 0 "+this.map.size.width+" "+this.map.size.height);this.root.appendChild(a);return a;case "canvas":return a=document.createElement("canvas"),a.style.height=this.map.size.height+"px",a.style.width=
this.map.size.width+"px",a.setAttribute("height",this.map.size.height),a.setAttribute("width",this.map.size.width),a.style.position="absolute",a.style.top="0px",a.style.left="0px",this.context=a.getContext("2d"),this.root.appendChild(a),a;case "vml":break;default:console.log("not implemented")}}};khtml.maplib.parser.MapCSS=function(){function a(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}this.size="width:16px;height:16px;";this.mapcss=document.styleSheets[0]?document.styleSheets[0]:document.createStyleSheet("dyn css","projection,tv,screen");this.parse=function(b){var e=0,c="";b=("__"+b+"__").split("");var f={singleQuote:!1,doubleQuote:!1,regex:!1,blockComment:!1,lineComment:!1,condComp:!1},d=0;for(c=b.length;d<c;d++)if(f.regex){if(b[d]==="/"&&b[d-1]!=="\\")f.regex=!1}else if(f.singleQuote){if(b[d]===
"'"&&b[d-1]!=="\\")f.singleQuote=!1}else if(f.doubleQuote){if(b[d]==='"'&&b[d-1]!=="\\")f.doubleQuote=!1}else if(f.blockComment){if(b[d]==="*"&&b[d+1]==="/")b[d+1]="",f.blockComment=!1;b[d]=""}else if(f.lineComment){if(b[d+1]==="\n"||b[d+1]==="\r")f.lineComment=!1;b[d]=""}else if(f.condComp){if(b[d-2]==="@"&&b[d-1]==="*"&&b[d]==="/")f.condComp=!1}else if(f.doubleQuote=b[d]==='"',f.singleQuote=b[d]==="'",b[d]==="/")b[d+1]==="*"&&b[d+2]==="@"?f.condComp=!0:b[d+1]==="*"?(b[d]="",f.blockComment=!0):b[d+
1]==="/"?(b[d]="",f.lineComment=!0):f.regex=!0;b=b.join("").slice(2,-2);var g=b.split(/\r\n|\r|\n/);b=[];for(f=0;f<g.length;f++)d=!1,c=a(g[f]).split(/{/),c[1]&&(d=c[1].split(/}/)[0],c="",d&&(b[e]=c+g[f],e++));console.log(b);for(f=0;f<b.length;f++)if(c=b[f].split(/{/),c[1]){d=a(c[1].split(/}/)[0]);console.log(d);e=c[0];selectors=e.split(",");newstring="";for(c=0;c<selectors.length;c++){g=newstring;var m=selectors[c],h=m.split("["),k=h[0].split("|");k[1]&&(k=k[1],k=k.substring(1,k.length),k.split("-"),
k.split("-")[1]&&k.split("-"));k=h[0].substring(0,4)=="node"?"div.osm_marker":"path";for(var l=1;l<h.length;l++){var n=h[l],o=n.split("]")[0];o=o.split("|")[0];n=n.split("]")[1].split(":");o=o.replace(":","_");n=/[0-9a-zA-Z=_]*/;n=/^[0-9a-zA-Z=_]*$/;n.test(o)&&(k+="[mapcss_"+o+"]")}if((n=m.split(":"))&&n[1])n[1]=a(n[1]),n[1]=="hover"&&(k+=" :"+n[1],console.log(k));newstring=g+(k+",")}c=newstring=newstring.substring(0,newstring.length-1);d=d.split(";");g="";for(m=0;m<d.length;m++)if(h="",k=d[m])l=
k.split(":"),l[1]&&(k=a(l[0]),l=a(l[1]),k=="fill-color"&&(k="fill"),k=="color"&&(k="stroke"),k=="width"&&(k="stroke-width"),k=="icon-image"&&(k="background-image",l="url("+l+")",h="width:16px;height:16px;"),g+=k+":"+l+";"+h);d=g;g=1;m=18;e=e.split("[")[0];if(e.split("|").length>0&&(e=e.split("|")[1]))e=e.substring(1,e.length),e=e.split("-")[0],g=e[0],e[1]&&(m=e[1]);for(e=g;e<=m;e++)if(c!="path"&&c!="div"){h=".z"+e+" "+c+" {"+d+"}";if(g!=1||m!=18)h=".z"+e+" "+c+" {"+d+"}";else{h=c+" {"+d+"}";this.mapcss.insertRule(h,
0);break}this.mapcss.insertRule(h,0)}}}};khtml.maplib.parser.Osm=function(){function a(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}this.nodes=[];this.ways=[];this.mapcssjson={};this.data=function(){return this.featureCollection};this.style=function(a){console.log(a,this.mapcssjson);var e=[],c;for(c in this.mapcssjson)e.push(c);e.sort(function(a,b){return parseFloat(a)-parseFloat(b)});for(var f=0;f<e.length;f++){c=e[f];var d=new khtml.maplib.overlay.FeatureCollection;this.add(a,d,c);map.featureCollection.appendChild(d)}};this.lineStyle=
function(a,e){for(var c in a.properties)for(var f=0;f<this.mapcssjson[e].length;f++){var d=this.mapcssjson[e][f];if(d.selector.properties&&(d.selector.properties[c]==a.properties[c]||d.selector.properties[c]===!0)){for(var g in d.rules)d.rules[g]&&(a.style[g]=d.rules[g]);if(d.selector.special)a.geometry.type="MultiPolygon"}else a.style.opacity=1}};this.add=function(a,e,c){for(var f=a.getElementsByTagName("node"),d=0;d<f.length;d++){var g=f[d],m=g.getAttribute("id");if(!this.nodes[m]){var h=g.getElementsByTagName("tag");
g=new khtml.maplib.LatLng(g.getAttribute("lat"),g.getAttribute("lon"));this.nodes[m]=g;m=document.createElement("div");if(h.length>0){var k=new khtml.maplib.overlay.SimpleMarker(g,m);k.properties={};for(g=0;g<h.length;g++){var l=h[g],n=l.getAttribute("k");l=l.getAttribute("v");m.setAttribute("mapcss_"+n,l);k.properties[n]=l}m.className="osm_marker";k.moveable(!0)}}}a=a.getElementsByTagName("way");for(f=0;f<a.length;f++)if(h=a[f],m=c+"_"+h.getAttribute("id"),!this.ways[m]){d=new khtml.maplib.geometry.Feature("MultiLineString");
d.close=!0;d.id=m;g=h.getElementsByTagName("nd");for(n=0;n<g.length;n++)l=g[n].getAttribute("ref"),this.nodes[l]!=void 0&&d.geometry.coordinates.push(this.nodes[l]);h=h.getElementsByTagName("tag");for(g=0;g<h.length;g++)l=h[g],n=l.getAttribute("k"),l=l.getAttribute("v"),d.properties[n]=l;this.lineStyle(d,c);(d.style.stroke||d.style.fill)&&e.appendChild(d);this.ways[m]=d}};this.mapcss=function(b){cssjson=[];console.log("parse");b=("__"+b+"__").split("");for(var e={singleQuote:!1,doubleQuote:!1,regex:!1,
blockComment:!1,lineComment:!1,condComp:!1},c=0,f=b.length;c<f;c++)if(e.regex){if(b[c]==="/"&&b[c-1]!=="\\")e.regex=!1}else if(e.singleQuote){if(b[c]==="'"&&b[c-1]!=="\\")e.singleQuote=!1}else if(e.doubleQuote){if(b[c]==='"'&&b[c-1]!=="\\")e.doubleQuote=!1}else if(e.blockComment){if(b[c]==="*"&&b[c+1]==="/")b[c+1]="",e.blockComment=!1;b[c]=""}else if(e.lineComment){if(b[c+1]==="\n"||b[c+1]==="\r")e.lineComment=!1;b[c]=""}else if(e.condComp){if(b[c-2]==="@"&&b[c-1]==="*"&&b[c]==="/")e.condComp=!1}else if(e.doubleQuote=
b[c]==='"',e.singleQuote=b[c]==="'",b[c]==="/")b[c+1]==="*"&&b[c+2]==="@"?e.condComp=!0:b[c+1]==="*"?(b[c]="",e.blockComment=!0):b[c+1]==="/"?(b[c]="",e.lineComment=!0):e.regex=!0;b=b.join("").slice(2,-2);b=b.replace(/@.*\n/g,"");b=b.replace(/[ \t\n]+/g," ");b=b.split(/\}/);for(e=0;e<b.length;e++){c=b[e].split(/\{/);f=c[0].split(/,/);for(var d=0;d<f.length;d++)if(c[1]){for(var g={},m=c[1].split(";"),h=0;h<m.length;h++){var k=a(m[h]).split(":"),l=k[0];k=k[1];l!=""&&(g[l]=a(k))}m={};l=f[d].split("[");
if(l[0].indexOf("|")==-1)h=l[0];else{k=l[0].split("|");h=a(k[0]);var n=k[1];k=0;var o=25;if(n)n=n.substring(1,n.length),n=n.split("-")[0],k=n[0],n[1]&&(o=n[1]),m.zoom={},m.zoom.min=k,m.zoom.max=o}if(l[1])for(k=1;k<l.length;k++){if(!m.properties)m.properties={};if(l[k].indexOf("=")==-1){k=l[k];var p=k.split("]");m.properties[p[0]]=!0}else o=l[k].split("="),p=a(o[1]).split("]"),m.properties[o[0]]=p[0]}if(p&&p[1]){k=p[1];if(p[1].indexOf("::")!=-1)l=a(p[1]).split("::"),m.subpart=l[1],l.length>0&&(k=l[0]);
l=a(k).split("/:/");m.special={};for(k=0;k<l.length;k++)l[k]&&(m.special[l[k]]=!0)}m.type=h;cssjson.push({selectororig:f[d],rules:g,selector:m})}}p=cssjson;for(b=0;b<p.length;b++)for(s in p[b].rules)switch(s){case "color":p[b].rules.stroke=p[b].rules[s];break;case "fill-color":p[b].rules.fill=p[b].rules[s];break;case "dashes":p[b].rules["stroke-dasharray"]=p[b].rules[s];break;case "width":p[b].rules["stroke-width"]=p[b].rules[s]}cssjson=p;cssjsonz=this.zindex(cssjson);console.log(cssjsonz);this.mapcssjson=
cssjsonz};this.zindex=function(a){for(var e=0;e<a.length;e++){var c=0;a[e].rules["z-index"]&&(c=a[e].rules["z-index"]);this.mapcssjson[c]||(console.log("---"+c),this.mapcssjson[c]=[]);this.mapcssjson[c].push(a[e])}return this.mapcssjson}};khtml.maplib.parser.Gpx=function(a){this.parse=function(){for(var a=[],e=this.dom.getElementsByTagName("trkseg"),c=0;c<e.length;c++){for(var f=[],d=e.item(c).getElementsByTagName("trkpt"),g=0;g<d.length;g++){var m=d.item(g),h=parseFloat(m.getAttribute("lat"));m=parseFloat(m.getAttribute("lon"));f.push([m,h])}a.push(f)}return{type:"MultiLineString",coordinates:a}};this.setDom=function(a){this.dom=typeof a=="string"?khtml.maplib.base.helpers.parseXml(a):a};this.setDom(a);return this.parse()};khtml.maplib.parser.Kml=function(a){function b(a,b){try{var d=a.getElementsByTagName(b).item(0).firstChild.nodeValue}catch(e){d=""}return d}this.styles=[];var e=new khtml.maplib.geometry.Feature({type:"FeatureCollection"});a.appendChild(e);this.folders=[];this.parse=function(a){a=a.getElementsByTagName("Document").item(0);for(var b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(d.nodeType==1)switch(d.tagName){case "Folder":d=this.parseFolder(d);e.appendChild(d);break;case "Style":this.parseStyle(d)}}return e};
this.parseStyle=function(a){for(var e=0;e<a.childNodes.length;e++){var d=a.childNodes[e];if(d.nodeType==1){var g=a.getAttribute("id");this.styles[g]={};switch(d.tagName){case "LineStyle":d=b(d,"width");this.styles[g].strokeWidth=d;break;case "PolyStyle":d=b(d,"color");g=this.styles[g];var m=d;d=parseInt(m.substring(0,2),16)/256;var h=parseInt(m.substring(2,4),16),k=parseInt(m.substring(4,6),16);m=parseInt(m.substring(6,8),16);g.fill="rgba("+h+","+k+","+m+","+d+")"}}}};this.parseFolder=function(a){var e=
b(a,"name"),d={name:e};d.placeMarks=[];this.folders.push(d);var g=new khtml.maplib.geometry.Feature({type:"FeatureCollection"});d.feature=g;for(var m=0;m<a.childNodes.length;m++){var h=a.childNodes[m];e=b(h,"name");e={name:e};d.placeMarks.push(e);if(h.nodeType==1){switch(h.tagName){case "Placemark":var k=this.parsePlacemark(g,h);break;case "GroundOverlay":this.parseGroundOverlay(g,h)}if(k)g.appendChild(k),e.feature=k}}return g};this.parseGroundOverlay=function(a,e){var d=b(e.getElementsByTagName("Icon").item(0),
"href"),g=document.createElement("img");g.setAttribute("src",d);d=e.getElementsByTagName("LatLonBox")[0];var m=b(d,"north"),h=b(d,"east"),k=b(d,"south"),l=b(d,"west");d.getElementsByTagName("rotation");d=new khtml.maplib.geometry.Bounds(new khtml.maplib.LatLng(k,l),new khtml.maplib.LatLng(m,h));g=new khtml.maplib.overlay.GroundOverlay(d,g,{});map.addOverlay(g)};this.parsePlacemark=function(a,e){try{var d=b(e,"styleUrl")}catch(g){}for(var m=0;m<e.childNodes.length;m++){var h=e.childNodes[m];if(h.nodeType==
1)switch(h.tagName){case "Polygon":var k={type:"Feature"};k.geometry={type:"Polygon"};var l=b(h,"coordinates");l=l.replace(/\n/g," ");l=l.replace(/ +/g," ");l=l.replace(/^ +/,"");l=l.replace(/ +$/,"");h=l.split(" ");k.geometry.coordinates=[];for(m=0;m<h.length;m++){var n=h[m].split(",")[1];l=h[m].split(",")[0];k.geometry.coordinates.push([l,n])}h=d.substring(1,d.length);k.style=this.styles[h];k=a.appendChild(new khtml.maplib.geometry.Feature(k));break;case "Point":k={type:"Feature"},k.geometry={type:"Point"},
l=b(h,"coordinates"),n=l.split(",")[1],l=l.split(",")[0],k.geometry.coordinates=[l,n],k.marker={},k.marker.infobox=b(h.parentNode,"description"),k=a.appendChild(new khtml.maplib.geometry.Feature(k))}}return k}};khtml.maplib.ui.KeyBoard=function(){this.zoomtime=400;this.init=function(a){this.map=a;khtml.maplib.base.helpers.eventAttach(a.mapParent,"keydown",this.keydown,this,!1)};this.keydown=function(a){switch(a.keyCode){case 37:this.moveit(30,0);break;case 38:this.moveit(0,30);break;case 39:this.moveit(-30,0);break;case 40:this.moveit(0,-30);break;case 35:this.moveit(this.map.size.width*0.4,0);break;case 36:this.moveit(-this.map.size.width*0.4,0);break;case 33:this.moveit(0,this.map.size.height*0.4);break;
case 34:this.moveit(0,-this.map.size.height*0.4);break;case 187:case 61:case 43:this.zoomin();break;case 189:case 190:case 109:case 45:this.zoomout();break;default:return}a.preventDefault?a.preventDefault():a.returnValue=!1};this.render=function(){};this.zoomingIn=!1;this.zoomin=function(){var a=Math.ceil(this.map.zoom()+0.1);this.zoomingIn&&a++;this.map.animatedGoto(this.map.center(),a,this.zoomtime);var b=this;setTimeout(function(){b.zoomingIn=!1},this.zoomtime);this.zoomingIn=!0};this.zoomout=
function(){var a=Math.floor(this.map.zoom()-0.1);this.zoomingOut&&a--;this.map.animatedGoto(this.map.center(),a,this.zoomtime);var b=this;setTimeout(function(){b.zoomingOut=!1},this.zoomtime);this.zoomingOut=!0};this.keyup=function(){};this.moveit=function(a,b){for(var e=a/20,c=b/20,f=0;f<20;f++){var d=Math.cos(3*(-10+f)/20)*5;this.moveitexec(e*d,c*d,f)}};this.moveitexec=function(a,b,e){setTimeout(function(){this.map.moveXY(a,b)},20*e)}};khtml.maplib.ui.Zoombar=function(){this.moving=!1;this._cancelEvent=function(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation()};this._stopEventPropagation=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};this._calcZFromY=function(a){return 22-a/10};this._zoom=function(a){a=a.type=="touchstart"||a.type=="touchmove"?this.map.pageY(a.touches[0]):this.map.pageY(a)+this.dy;this.map.centerAndZoom(this.map.center(),this._calcZFromY(a))};this.dy=0;this._down=function(a){var b=a.target?
a.target:a.srcElement;this._cancelEvent(a);this.moving=!0;this.dy=b==this.scrollhandle?this.scrollhandle.offsetTop-this.map.pageY(a)+10:0;this._zoom(a);this._stopEventPropagation(a)};this._move=function(a){this._cancelEvent(a);this.moving&&(this._zoom(a),this.render(),this._stopEventPropagation(a))};this._up=function(a){this._cancelEvent(a);this.moving=!1;this._stopEventPropagation(a)};this.init=function(a){this.map=a;a=a.mapParent.getElementsByTagName("*");for(var b=0;b<a.length;b++){var e=a.item(b);
if(e.className=="scrollhandle")this.scrollhandle=e;if(e.className=="zoombar")this.zoombar=e}a=navigator.userAgent.indexOf("MSIE")!=-1?this.map.mapParent:window;if(!this.zoombar)this.zoombar=this._createZoombar();if(!this.scrollhandle)this.scrollhandle=this._createScrollhandle();khtml.maplib.base.helpers.eventAttach(this.zoombar,"mousedown",this._down,this,!1);khtml.maplib.base.helpers.eventAttach(a,"mousemove",this._move,this,!1);khtml.maplib.base.helpers.eventAttach(a,"mouseup",this._up,this,!1);
khtml.maplib.base.helpers.eventAttach(this.zoombar,"touchstart",this._down,this,!1);khtml.maplib.base.helpers.eventAttach(this.zoombar,"touchmove",this._move,this,!1);khtml.maplib.base.helpers.eventAttach(this.zoombar,"touchend",this._up,this,!1)};this.render=function(){this.scrollhandle.style.top=(21-this.map.zoom())*10+"px";this.scrollhandle.firstChild.nodeValue=Math.round(this.map.zoom())};this._createZoombar=function(){var a=document.createElement("div");a.setAttribute("style","position:absolute;left:10px;width:30px;height:221px;");
var b=document.createElement("div");b.setAttribute("style","position:absolute;left:7px;top:20px;height:200px;width:11px;background-color:white; overflow:hidden;-moz-border-radius: 5px; -webkit-border-radius: 5px;border:1px solid grey;cursor:pointer;box-shadow:inset 2px 2px 3px #e8e8e8;");a.appendChild(b);this.map.overlayDiv.appendChild(a);return a};this._createScrollhandle=function(){var a=document.createElement("div");a.setAttribute("style","position:absolute;left:3px;top:-10px;width:20px;height:20px;background-color:lightgrey;opacity:0.8; border:1px solid grey;-moz-border-radius: 5px; -webkit-border-radius: 5px;text-align:center;cursor:pointer;box-shadow:1px 1px 4px grey;");
a.appendChild(document.createTextNode("T"));this.zoombar.appendChild(a);return a}};khtml.maplib.util.Http=function(){this._get=function(a,b,e,c){try{return jQuery.get(a,b,e,c)}catch(f){khtml.maplib.base.Log.warn("Exception occured! Did you include the jQuery library?"),khtml.maplib.base.Log.exception(f)}};this.get=function(a,b,e,c){return this._get(a,b,e,c).error(function(a){khtml.maplib.base.Log.error("khtml.maplib.util.Http.get(): request failed!",a)})}};khtml.maplib.util.Urlparam=function(a){HTTP_GET_VARS=[];strGET=document.location.search.substr(1,document.location.search.length);if(strGET!=""){gArr=strGET.split("&");for(i=0;i<gArr.length;++i)v="",vArr=gArr[i].split("="),vArr.length>1&&(v=vArr[1]),HTTP_GET_VARS[unescape(vArr[0])]=unescape(v)}this.GET=function(a){if(!HTTP_GET_VARS[a])return"undefined";return HTTP_GET_VARS[a]};this.GET("lat")!="undefined"&&this.GET("lon")!="undefined"&&a.center(new khtml.maplib.LatLng(parseFloat(this.GET("lat")),
parseFloat(this.GET("lon"))));this.GET("zoom")!="undefined"&&a.zoom(parseFloat(this.GET("zoom")));this.GET("mlat")!="undefined"&&this.GET("mlon")!="undefined"&&new khtml.maplib.overlay.Marker({position:new khtml.maplib.LatLng(parseFloat(this.GET("mlat")),parseFloat(this.GET("mlon"))),map:a})};khtml.maplib.util.scriptTagProxy=function(a,b){var e=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript";c.onload=function(){e.removeChild(c)};c.src=a;e.appendChild(c);searchResult=b;return c};khtml.maplib.ui.Nominatim=function(){this.width=300;this.height=200;this.init=function(a){this.map=a;this.div=this.createWindow();khtml.maplib.base.helpers.eventAttach(this.map.mapParent,"keydown",this.start,this,!1)};this.render=function(){};var a=this;this.keyup=function(b){this.focus();b.keyCode==27&&this.stop();b=a.input.value;if(b.length<=2)for(;a.div.firstChild;)a.div.removeChild(a.div.firstChild);else b="http://nominatim.openstreetmap.org/search?q="+b+"&format=json&polygon=1&addressdetails=1&json_callback=searchResult",
this.scriptElement&&this.scriptElement.parentNode&&this.scriptElement.parentNode.removeChild(this.scriptElement),this.ajaxload.style.display="",a.close.style.display="none",this.scriptElement=khtml.maplib.util.scriptTagProxy(b,a.showResult)};this.focus=function(){if(!this.started)this.input.value="";this.started=!0;this.input.style.color="black"};this.showResult=function(b){a.ajaxload.style.display="none";a.close.style.display="";for(a.div.style.display="";a.div.firstChild;)a.div.removeChild(a.div.firstChild);
for(var e=0;e<b.length;e++){var c=b[e],f=document.createElement("div"),d=document.createTextNode(c.display_name);f.appendChild(d);f.style.fontSize="12px";f.style.width="1200px";f.style.cursor="pointer";a.div.appendChild(f);khtml.maplib.base.helpers.eventAttach(f,"mouseover",a.highlight,f,!1);khtml.maplib.base.helpers.eventAttach(f,"mouseout",a.lowlight,f,!1);khtml.maplib.base.helpers.eventAttach(f,"mousedown",a.select,c,!1)}};this.hideResult=function(){this.timeout=setTimeout(function(){a.div.style.display=
"none"},1E3)};this.unhideResult=function(){a.div.style.display="";clearTimeout(this.timeout)};this.highlight=function(){this.style.backgroundColor="yellow"};this.lowlight=function(){this.style.backgroundColor=""};this.select=function(){var b=new khtml.maplib.LatLng(this.boundingbox[0],this.boundingbox[2]),e=new khtml.maplib.LatLng(this.boundingbox[1],this.boundingbox[3]);b=new khtml.maplib.geometry.Bounds(b,e);a.map.bounds(b);a.div.style.display="none";a.showPoly(this.polygonpoints)};this.showPoly=
function(a){this.poly&&this.map.featureCollection.removeChild(this.poly);this.poly=new khtml.maplib.geometry.Feature({type:"LineString",coordinates:a});this.poly.style.fill="none";this.poly.style.stroke="red";this.poly.style.strokeWidth="4";this.map.featureCollection.appendChild(this.poly)};this.stop=function(){this.started=!1;this.win.style.display="none";this.map.mapParent.focus()};this.start=function(a){if(a.keyCode==70){this.win.style.display="";if(a.target!=this.input)this.started=!1;this.input.focus()}};
this.createWindow=function(){this.win=document.createElement("div");this.win.style.display="none";this.ajaxload=document.createElement("img");this.ajaxload.setAttribute("src",khtml.maplib.base.helpers.ajaxload);this.ajaxload.style.display="none";this.ajaxload.style.position="relative";this.ajaxload.style.top="2px";this.ajaxload.style.left="-20px";this.close=document.createElement("img");this.close.setAttribute("src",khtml.maplib.base.helpers.close);this.close.style.position="relative";this.close.style.top=
"3px";this.close.style.left="-18px";khtml.maplib.base.helpers.eventAttach(this.close,"mousedown",this.stop,this,!1);this.input=document.createElement("input");this.input.style.width="300px";this.input.style.height="20px";this.input.style.border="1px solid lightgray";this.input.style.color="lightgrey";this.input.value="nominatim search";this.win.appendChild(this.input);this.win.appendChild(this.close);this.win.appendChild(this.ajaxload);khtml.maplib.base.helpers.eventAttach(this.input,"keyup",this.keyup,
this,!1);var a=document.createElement("div");this.win.style.position="absolute";a.style.width=this.width+"px";var e=this.map.size.left;this.win.style.top=this.map.size.top+"px";this.win.style.left=e+"px";a.style.border="1px solid lightgrey";a.style.backgroundColor="white";a.style.opacity=0.8;a.style.display="none";a.style.overflow="hidden";a.style.borderBottomRightRadius="10px";a.style.borderBottomLeftRadius="10px";a.style.boxShadow="1px 1px 15px #ccc";khtml.maplib.base.helpers.eventAttach(this.win,
"mouseout",this.hideResult,this,!1);khtml.maplib.base.helpers.eventAttach(this.win,"mouseover",this.unhideResult,this,!1);this.win.appendChild(a);this.map.mapParent.parentNode.appendChild(this.win);return a}};
