// --------------------------------------------------------------------------------------------
// khtml javascript library
// --------------------------------------------------------------------------------------------
// (C) Copyright 2010-2011 by Bernhard Zwischenbrugger, Florian Hengartner, Stefan Kemper
//
// Project Info:  http://www.khtml.org
//				  http://www.khtml.org/iphonemap/help.php
//
// This library is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
// 
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU Lesser General Public License for more details.
// 
// You should have received a copy of the GNU Lesser General Public License
// along with this library.  If not, see <http://www.gnu.org/licenses/>.
// --------------------------------------------------------------------------------------------
var khtml={};khtml.maplib={};khtml.maplib.base={};khtml.maplib.geometry={};khtml.maplib.overlay={};khtml.maplib.overlay.renderer={};khtml.maplib.parser={};khtml.maplib.ui={};khtml.maplib.util={};khtml.maplib.overlay.renderer={};khtml.maplib.version=function(){return"khtmlib_hsr v0.02"};khtml.maplib.Map=function(a){return new khtml.maplib.base.Map(a)};khtml.maplib.LatLng=function(a,e){return new khtml.maplib.geometry.LatLng(a,e)};khtml.maplib.standardimagepath="http://maplib.khtml.org/img/";khtml.maplib.base.helpers={};khtml.maplib.base.helpers.parseXml=function(a){var e;window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(a)):document.implementation&&document.implementation.createDocument&&(e=(new DOMParser).parseFromString(a,"text/xml"));return e};
khtml.maplib.base.helpers.contains=function(a,e){var d=[a.sw().lat(),a.ne().lat()],b=[a.sw().lng(),a.ne().lng()];return(khtml.maplib.base.helpers.between(d,e.sw().lat())||khtml.maplib.base.helpers.between(d,e.ne().lat()))&&(khtml.maplib.base.helpers.between(b,e.sw().lng())||khtml.maplib.base.helpers.between(b,e.ne().lng()))?!0:!1};khtml.maplib.base.helpers.overlaps=function(a,e){return a.sw().lng()>e.ne().lng()||a.ne().lng()<e.sw().lng()||a.sw().lat()>e.ne().lat()||a.ne().lat()<e.sw().lat()?!1:!0};
khtml.maplib.base.helpers.overlapsBuggy=function(a,e){var d=[a.sw().lat(),a.ne().lat()],b=[a.sw().lng(),a.ne().lng()],f=[e.sw().lat(),e.ne().lat()],g=[e.sw().lng(),e.ne().lng()];return(khtml.maplib.base.helpers.between(d,e.sw().lat())||khtml.maplib.base.helpers.between(d,e.ne().lat()))&&(khtml.maplib.base.helpers.between(b,e.sw().lng())||khtml.maplib.base.helpers.between(b,e.ne().lng()))||(khtml.maplib.base.helpers.between(f,a.sw().lat())||khtml.maplib.base.helpers.between(f,a.ne().lat()))&&(khtml.maplib.base.helpers.between(g,
a.sw().lng())||khtml.maplib.base.helpers.between(g,a.ne().lng()))?!0:!1};
khtml.maplib.base.helpers.extendBBox=function(a,e){if(!(a instanceof khtml.maplib.geometry.Bounds)){var d=new khtml.maplib.geometry.LatLng(-90,-180),b=new khtml.maplib.geometry.LatLng(90,180);a=new khtml.maplib.geometry.Bounds(b,d)}if(!e)return a;e instanceof khtml.maplib.geometry.LatLng?a=khtml.maplib.base.helpers.extendBBoxByPoint(a,e):(a=khtml.maplib.base.helpers.extendBBoxByPoint(a,e.sw()),a=khtml.maplib.base.helpers.extendBBoxByPoint(a,e.ne()));return a};
khtml.maplib.base.helpers.extendBBoxByPoint=function(a,e){var d=a.sw().lng(),b=a.ne().lat(),f=a.sw().lat(),g=a.ne().lng();e.lat()>b&&(b=e.lat());e.lat()<f&&(f=e.lat());e.lng()<d&&(d=e.lng());e.lng()>g&&(g=e.lng());d=new khtml.maplib.geometry.LatLng(f,d);b=new khtml.maplib.geometry.LatLng(b,g);return new khtml.maplib.geometry.Bounds(d,b)};khtml.maplib.base.helpers.between=function(a,e){return a[0]<=e&&e<=a[1]?!0:!1};
khtml.maplib.base.helpers.cloneObject=function(a){var e={},d;for(d in a)e[d]=typeof a[d]=="object"?khtml.maplib.base.helpers.cloneObject(a[d]):a[d];return e};khtml.maplib.base.helpers.convertObjectToArray=function(a){for(var e=[],d=0,b=a.length;d<b;d++)e.push(a[d]);return e};
khtml.maplib.base.helpers.eventAttach=function(a,e,d,b,f){var g=arguments.length>5?$a(arguments).slice(5,arguments.length):[],c=function(c){g.unshift(c||window.event);return d.apply(b?b:a,g)};a.addEventListener?(navigator.appName.indexOf("Netscape")==-1&&e=="DOMMouseScroll"&&(e="mousewheel"),navigator.userAgent.indexOf("Safari")!=-1?e=="DOMMouseScroll"?a.onmousewheel=c:a.addEventListener(e,c,f):a.addEventListener(e,c,f)):(e=e=="DOMMouseScroll"?"onmousewheel":"on"+e,a.attachEvent(e,c));return{o:a,
type:e,fn:c,c:f}};khtml.maplib.base.helpers.eventRemove=function(a){a.o.removeEventListener&&a.o.removeEventListener(a.type,a.fn,a.c)};khtml.maplib.base.helpers.mixin=function(a,e,d){if(d)if(d instanceof Array)for(var b=0;b<d.length;b++)a[d[b]]=e[d[b]];else e[d]&&(a[d]=e[d]);else for(b in e)a[b]=e[b]};
khtml.maplib.base.helpers.showOnMap=function(a,e){var d=[];a instanceof khtml.maplib.geometry.Bounds&&(khtml.maplib.base.Log.log("Bounds"),khtml.maplib.base.Log.log("Northwest / Topleft",a.nw()),khtml.maplib.base.Log.log("Northeast / Topright",a.ne()),khtml.maplib.base.Log.log("Southeast / Bottomright",a.se()),khtml.maplib.base.Log.log("Southwest / Bottomleft",a.sw()),d.push(a.nw()),d.push(a.ne()),d.push(a.se()),d.push(a.sw()));for(var b=0;b<d.length;b++){var f=document.createElement("div");f.style.width=
"1px";f.style.height="1px";f.style.color="red";f.style["font-size"]="2em";f.textContent="X";f=new khtml.maplib.overlay.Marker(d[b],f);e.addOverlay(f)}};khtml.maplib.base.helpers.cancelEvent=function(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation()};khtml.maplib.base.helpers.stopEventPropagation=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};khtml.maplib.base.helpers.isIE=function(){return navigator.userAgent.indexOf("MSIE")!=-1};
khtml.maplib.base.helpers.isParentNodeEmpty=function(a){if(khtml.maplib.base.helpers.isIE())return a.parentNode.nodeValue==null;return!a.parentNode};
khtml.maplib.base.helpers.parseLine=function(a){if(a){if(typeof a=="string")a=khtml.maplib.base.helpers.parseLineString;if(typeof a=="object"){if(typeof a[0]=="string"&&typeof a[1]=="string"&&!isNaN(parseFloat(a[0]))&&!isNaN(parseFloat(a[1]))&&a.length==2){var e=parseFloat(a[1]),d=parseFloat(a[0]),b=khtml.maplib.LatLng(e,d);return b}if(typeof a[0]=="number"&&typeof a[0]=="number"&&a.length==2)a=new khtml.maplib.LatLng(a[0],a[1]);else for(b in a){var f=a[b];f instanceof khtml.maplib.geometry.LatLng||
(e=f[1],d=f[0],a[b]=typeof e=="number"&&typeof d=="number"&&f.length==2?new khtml.maplib.LatLng(e,d):khtml.maplib.base.helpers.parseLine(a[b]))}e=a}}else e=[];return e};khtml.maplib.base.helpers.parseLineString=function(a){if(typeof a=="string"){points=[];a=a.split(" ");for(var e=0;e<a.length;e++){var d=a[e].split(",");d.length==2&&(d[0]=parseFloat(d[0]),d[1]=parseFloat(d[1]),points.push(new khtml.maplib.LatLng(d[0],d[1])))}}return points};
khtml.maplib.base.helpers.parseMultiLine=function(a){if(a&&typeof a=="object")for(var e in a){var d=a[e],b;for(b in d){var f=d[b];if(!(f instanceof khtml.maplib.geometry.LatLng)){var g=f[0];f=f[1];typeof g=="number"&&typeof f=="number"&&(d[b]=new khtml.maplib.LatLng(g,f))}}}else a=[];return a};var stop=0;
khtml.maplib.base.helpers.stringify=function(a,e,d){var b=!0;typeof a.push=="undefined"&&(b=!1);for(var f="",g=e?e+1:e===!1?!1:1,c=f="",k=0;k<g-1;k++)c+="   ";e!==!1&&(c="\n"+c,f=c+"   ");e="";for(var h in a)if(h!="owner"&&typeof a[h]!="function")if(a[h]instanceof khtml.maplib.geometry.Bounds)e+=f+'"bbox":',e+="["+a[h].sw().lng()+","+a[h].sw().lat()+",",e+=""+a[h].ne().lng()+","+a[h].ne().lat()+"]",e+=",";else if(a[h]instanceof khtml.maplib.geometry.LatLng)a.type!="Marker"&&(a.type=="Point"&&(e+=
'"coordinates":'),e+="["+a[h].lng()+","+a[h].lat()+"],");else if(typeof a[h]=="string"){if((h=="type"||d)&&h!="animVal")a[h]!="Marker"&&(e+=f+'"'+h+'":"'+a[h]+'",')}else if(b||h=="type"||h=="features"||a[h]&&a[h].type=="Feature"||h=="geometry"||h=="coordinates"||h=="properties"||h=="bbox"||h=="className")e+=b?f+khtml.maplib.base.helpers.stringify(a[h],g)+",":h=="properties"?f+'"'+h+'":'+khtml.maplib.base.helpers.stringify(a[h],g)+",":f+'"'+h+'":'+khtml.maplib.base.helpers.stringify(a[h],g,!0)+",";
e=e.substring(0,e.length-1);return b?"["+e+"]":"{"+e+c+"}"};khtml.maplib.base.helpers.rotate=function(a,e){var d="rotate("+e+"deg)";a.style.webkitTransform=d;a.style.MozTransform=d;a.style.OTransform=d;if(document.all)rad=e*(Math.PI*2/360),costheta=Math.cos(rad),sintheta=Math.sin(rad),a.filters.item(0).M11=costheta,a.filters.item(0).M12=-sintheta,a.filters.item(0).M21=sintheta,a.filters.item(0).M22=costheta};
khtml.maplib.base.helpers.Boundingbox=function(a){this.map=a;this.div=document.createElement("div");this.div.style.border="1px solid black";this.div.style.position="absolute";this.div.style.strokeDasharray="4,4";this.div.style.zIndex=1;a.mapParent.appendChild(this.div);this.show=function(a){this.div.style.display="";var d=this.map.latlngToXY(a.sw());a=this.map.latlngToXY(a.ne());this.div.style.top=a.y-parseInt(this.div.style.borderWidth)+"px";this.div.style.left=d.x-parseInt(this.div.style.borderWidth)+
"px";this.div.style.width=a.x-d.x+"px";this.div.style.height=-a.y+d.y+"px";this.div.zIndex=10};this.hide=function(){this.div.style.display="none"}};khtml.maplib.base.helpers.imageNotSelectable=function(a){a.style.MozUserSelect="none";a.style.webkitUserSelect="none";a.style.webkitUserDrag="none";a.style.KhtmlUserSelect="none";a.style.OUserSelect="none";a.style.userSelect="none"};
khtml.maplib.base.helpers.setCursor=function(a,e){if(navigator.userAgent.indexOf("MSIE")!=-1)a.style.cursor=e=="grab"?"url('"+khtml.maplib.standardimagepath+"hand.cur'), default":e=="grabbing"?"url('"+khtml.maplib.standardimagepath+"fist.cur'), move":"pointer";else if(a.style.cursor="-moz-"+e,a.style.cursor!="-moz-"+e&&(a.style.cursor="-webkit-"+e,a.style.cursor!="-webkit-"+e&&(a.style.cursor="-ms-"+e,a.style.cursor!="-ms-"+e&&(a.style.cursor="-khtml-"+e,a.style.cursor!="-khtml-"+e&&(a.style.cursor=
e,a.style.cursor!=e)))))a.style.cursor="pointer"};khtml.maplib.base.Map=function(a){typeof a=="string"&&(a=document.getElementById(a));(typeof a!="object"||null==a)&&console.log("Error: map is null or not an object. (map: "+a+")");this.addOverlay=function(c){if(null==c||c instanceof Array)return khtml.maplib.base.Log.warn('Map.addOverlay(): Illegal argument (was "null" or "Array")'),!1;this.overlays.push(c);typeof c.init=="function"&&c.init(this);this.renderOverlay(c)};this.addOverlays=function(c){if(c instanceof Array)for(var b=0;b<c.length;b++)this.addOverlay(c[b]);
else this.addOverlay(c)};this.renderOverlay=function(c){try{c.render()}catch(b){}};this.renderOverlays=function(){for(obj in this.overlays)this.overlays[obj].render()};this._hideOverlays=function(){for(obj in this.overlays)try{this.overlays[obj].clear(f)}catch(c){}};this.removeOverlays=function(){for(;this.overlays.length>0;)this.overlays.pop().clear()};this.stopRenderOverlays=function(){for(obj in this.overlays)typeof this.overlays[obj].cancel=="function"&&this.overlays[obj].cancel()};this.removeOverlay=
function(c){for(var b=0;b<this.overlays.length;b++)if(c==this.overlays[b]){c.clear();this.overlays.splice(b,1);break}};this.callbackFunctions=[];this.addCallbackFunction=function(c){typeof c=="function"&&this.callbackFunctions.push(c)};this._executeCallbackFunctions=function(){for(var c=0;c<this.callbackFunctions.length;c++)this.callbackFunctions[c].call(this)};this.myTimer=function(c){this.reset=function(){this._isRunning=!1};this.isTimeRunning=function(){if(!1==this._isRunning)return!1;if(this.time+
this.myInterval>(new Date).getTime())return!1;this._isRunning=!1;return!0};this.start=function(){this._isRunning=!0;this.time=(new Date).getTime()};this.interval=function(c){if(typeof c!="undefined")this.myInterval=parseInt(c);return this.myInterval};this.reset();this.interval(c);return this};this.oldMoveY=this.oldMoveX=0;this._start=function(c){c.preventDefault?c.preventDefault():c.returnValue=!1;this.moveAnimationBlocked=!0;if(c.touches.length==1){this.startMoveX=this.moveX-this.pageX(c.touches[0])/
this.faktor/this.sc;this.startMoveY=this.moveY-this.pageY(c.touches[0])/this.faktor/this.sc;if(this.mousedownTime!=null&&(new Date).getTime()-this.mousedownTime<this._doubleclickTime){var b=Math.ceil(0.01+this._getZoom()-this.intZoom);this._autoZoomIn(this.pageX(c.touches[0]),this.pageY(c.touches[0]),b)}this.mousedownTime=(new Date).getTime();clearTimeout(this.zoomOutInterval);this.zoomOutInterval=window.setInterval(function(){},20)}if(c.touches.length==2){window.clearInterval(this.zoomOutInterval);
this.moveok=!1;b=this.pageX(c.touches[0]);var a=this.pageY(c.touches[0]),f=this.pageX(c.touches[1]);c=this.pageY(c.touches[1]);this.startDistance=Math.sqrt(Math.pow(f-b,2)+Math.pow(c-a,2));this.startZZ=this.position.zoom;c=(a+c)/2/this.faktor/this.sc;this.startMoveX=this.moveX-(b+f)/2/this.faktor/this.sc;this.startMoveY=this.moveY-c}this.oldMoveX=this.moveX;this.oldMoveY=this.moveY};this.moveok=!0;this._move=function(c){c.preventDefault?c.preventDefault():c.returnValue=!1;if(c.touches.length==1&&
this.moveok){this.lastMoveX=this.moveX;this.lastMoveY=this.moveY;this.lastMoveTime=new Date(c.timeStamp);this.moveX=this.pageX(c.touches[0])/this.faktor/this.sc+this.startMoveX;this.moveY=this.pageY(c.touches[0])/this.faktor/this.sc+this.startMoveY;if(!this.zoomOutStarted){if(Math.abs(this.moveX-this.oldMoveX)>5||Math.abs(this.moveY-this.oldMoveY)>5)window.clearInterval(this.zoomOutInterval),this.zoomOutSpeed=0.01,this.mousedownTime=null;var b=new khtml.maplib.LatLng(this.lat,this.lng);this.setCenter2(b,
this.position.zoom);this.moveAnimationBlocked=!1}if(Math.abs(this.moveX-this.oldMoveX)>5||Math.abs(this.moveY-this.oldMoveY)>5)this.mousedownTime=null}if(c.touches.length==2){this.mousedownTime=null;var a=this.pageX(c.touches[0]),f=this.pageY(c.touches[0]),d=this.pageX(c.touches[1]),g=this.pageY(c.touches[1]);b=Math.sqrt(Math.pow(d-a,2)+Math.pow(g-f,2))/this.startDistance;c=this.startZZ+b-1;c>this.tileSource.maxzoom?(c=this.tileSource.maxzoom,b=this.zoomDeltaOld):this.zoomDeltaOld=b;a=(a+d)/2;f=(f+
g)/2;faktor=Math.pow(2,c);d=a/faktor-this.width/2;g=f/faktor-this.height/2;b=Math.pow(2,b-1);this.moveX=(a+(d-d*b))/faktor+this.startMoveX;this.moveY=(f+(g-g*b))/faktor+this.startMoveY;b=new khtml.maplib.LatLng(this.lat,this.lng);this.setCenter2(b,c)}};this._end=function(c){c.preventDefault?c.preventDefault():c.returnValue=!1;window.clearInterval(this.zoomOutInterval);this.zoomOutStarted=!1;this.zoomOutSpeed=0.01;if(c.touches.length==0&&(this.moveok=!0,this.moveAnimationMobile&&this.moveAnimationBlocked==
!1)){var b=new Date(c.timeStamp)-this.lastMoveTime,a=(this.lastMoveX-this.moveX)/b*4;b=(this.lastMoveY-this.moveY)/b*4;var f=this.wheelSpeedConfig.animateMaxSpeed;a>f&&(a=f);b>f&&(b=f);a<-f&&(a=-f);b<-f&&(b=-f);f=Math.pow(2,this.zoom());(Math.abs(a)>this.wheelSpeedConfig.animateMinSpeed/f||Math.abs(b)>this.wheelSpeedConfig.animateMinSpeed/f)&&this._animateMove(a,b,f)}if(c.touches.length==1)this.startMoveX=this.moveX-c.touches[0].pageX/this.faktor/this.sc,this.startMoveY=this.moveY-c.touches[0].pageY/
this.faktor/this.sc};this.pageX=function(c){try{return(c.pageX===void 0?c.clientX+document.body.scrollLeft:c.pageX)-this.mapLeft}catch(b){return this.lastMouseX}};this.pageY=function(c){try{return(c.pageY===void 0?c.clientY+document.body.scrollTop:c.pageY)-this.mapTop}catch(b){return this.lastMouseY}};this.doubleclickBlocked=!1;this._doubleclick=function(c){var b;if(!c)c=window.event;c.which?b=c.which==3:c.button&&(b=c.button==2);b?this._discretZoom(-1,this.pageX(c),this.pageY(c)):this._discretZoom(1,
this.pageX(c),this.pageY(c))};this._mousedown=function(c){this.mapParent.focus();c.preventDefault?c.preventDefault():window.event.returnValue=!1;this.lastMouseX=this.pageX(c);this.lastMouseY=this.pageY(c);this.moveAnimationBlocked=!0;if(this.mousedownTime2!=null&&(new Date).getTime()-this.mousedownTime2<this.doubleclickTime2)this._doubleclick(c);else{this.mousedownTime2=(new Date).getTime();if(c.shiftKey){this.selectRectLeft=this.pageX(c);this.selectRectTop=this.pageY(c);this.selectRect=document.createElement("div");
this.selectRect.style.left=this.selectRectLeft+"px";this.selectRect.style.top=this.selectRectTop+"px";this.selectRect.style.border="1px solid gray";if(!this.internetExplorer)this.selectRect.style.opacity=0.5,this.selectRect.style.backgroundColor="white";this.selectRect.style.position="absolute";this.map.parentNode.appendChild(this.selectRect);khtml.maplib.base.helpers.setCursor(this.mapParent,"crosshair")}else this.startMoveX=this.moveX-this.pageX(c)/this.faktor/this.sc,this.startMoveY=this.moveY-
this.pageY(c)/this.faktor/this.sc,this.movestarted=!0,khtml.maplib.base.helpers.setCursor(this.mapParent,"grabbing");return!1}};this._mousemove=function(c){c.preventDefault?c.preventDefault():window.event.returnValue=!1;this.lastMouseX=this.pageX(c);this.lastMouseY=this.pageY(c);if(c.shiftKey){if(this.selectRect){this.selectRect.style.width=Math.abs(this.pageX(c)-this.selectRectLeft)+"px";this.selectRect.style.height=Math.abs(this.pageY(c)-this.selectRectTop)+"px";if(this.pageX(c)<this.selectRectLeft)this.selectRect.style.left=
this.pageX(c)+"px";if(this.pageY(c)<this.selectRectTop)this.selectRect.style.top=this.pageY(c)+"px"}}else if(this.movestarted)this.lastMoveX=this.moveX,this.lastMoveY=this.moveY,this.lastMoveTime=new Date(c.timeStamp),this.moveX=this.pageX(c)/this.faktor/this.sc+this.startMoveX,this.moveY=this.pageY(c)/this.faktor/this.sc+this.startMoveY,this.setCenter2(new khtml.maplib.LatLng(this.lat,this.lng),this.position.zoom),this.moveAnimationBlocked=!1;return!1};this._mouseup=function(c){c.preventDefault?
c.preventDefault():c.returnValue=!1;khtml.maplib.base.helpers.setCursor(this.mapParent,"grab");this.lastMouseX=this.pageX(c);this.lastMouseY=this.pageY(c);if(this.moveMarker)this.moveMarker=null;if(this.selectRect){var b=this.XYTolatlng(this.selectRect.offsetLeft,this.selectRect.offsetTop+this.selectRect.offsetHeight),a=this.XYTolatlng(this.selectRect.offsetLeft+this.selectRect.offsetWidth,this.selectRect.offsetTop);this._setBounds(new khtml.maplib.geometry.Bounds(b,a));this.selectRect.parentNode.removeChild(this.selectRect);
this.selectRect=null}b=new Date(c.timeStamp)-this.lastMoveTime;if(this.wheelSpeedConfig.moveAnimateDesktop&&b!=0&&this.movestarted&&this.moveAnimationBlocked==!1)c=(this.lastMoveX-this.moveX)/b,b=(this.lastMoveY-this.moveY)/b,a=this.wheelSpeedConfig.animateMaxSpeed,c>a&&(c=a),b>a&&(b=a),c<-a&&(c=-a),b<-a&&(b=-a),a=Math.pow(2,this.zoom()),(Math.abs(c)>this.wheelSpeedConfig.animateMinSpeed/a||Math.abs(b)>this.wheelSpeedConfig.animateMinSpeed/a)&&this._animateMove(c,b,a);var f=this;setTimeout(function(){f.movestarted=
!1},1)};this._mouseupIE=function(c){c.preventDefault?c.preventDefault():c.returnValue=!1;this.lastMouseX=this.pageX(c);this.lastMouseY=this.pageY(c);this.setCenter2(this.XYTolatlng(this.lastMouseX,this.lastMouseY),this.zoom())};this.startZoomTime=null;this._mousewheel=function(c){c.preventDefault?c.preventDefault():c.returnValue=!1;this.mapParent.focus();if(!c)c=window.event;if(c.wheelDelta)var b=c.wheelDelta/60;else if(c.detail)b=-c.detail/3,this.lastWheelDelta*b<0&&(this.wheelSpeedConfig.digizoom||
(b=0)),this.lastWheelDelta=-c.detail/3;b=b<0?-1:1;if(this.wheelSpeedConfig.digizoom)this._discretZoom(b,this.pageX(c),this.pageY(c));else{if(!this.startZoomTime)this.startZoomTime=new Date,this.startZoomTime2=new Date,this.oldZoom=this.zoom(),this.speed=1;var a=new Date-this.startZoomTime,f=new Date-this.startZoomTime2;this.startZoomTime=new Date;if(a>300)this.startZoomTime2=new Date,this.oldZoom=this.zoom(),this.speed=1,f=0.1;this.speed*=2;if(this.speed>5)this.speed=5;b=this.oldZoom+f/3E3*this.speed*
b;if(b>this.position.maxZoom)b=this.position.maxZoom;if(b<this.position.minZoom)b=this.position.minZoom;this.centerAndZoomXY(this.center(),b,this.pageX(c),this.pageY(c))}};this._shiftkeydown=function(c){c.shiftKey&&khtml.maplib.base.helpers.setCursor(this.mapParent,"crosshair")};this._shiftkeyup=function(){khtml.maplib.base.helpers.setCursor(this.mapParent,"grab")};this.zoomTimeouts=[];this.discretZoomBlocked=!1;this._discretZoom=function(c,b,a){if(!this.discretZoomBlocked){var f=this;this.discretZoomBlockedTimeout=
setTimeout(function(){f.discretZoomBlocked=!1},200);this.discretZoomBlocked=!0;for(var d=1;d<=20;d++)this.zoomTimeouts[d]&&clearTimeout(this.zoomTimeouts[d]);d=this.zoom();var g=c==1?Math.ceil(this.zoom()+0.9):Math.floor(this.zoom()-0.9);g=Math.abs(d-g);var e=0;for(d=1;d<=20;d++){var n=c*Math.sin(d/20*Math.PI/2)*g;this.zoomTimeouts[d]=this._discretZoomExec(b,a,n-e,d,20);e=n}}};this._discretZoomExec=function(c,b,a,f,d){var g=this;return setTimeout(function(){var e=g.zoom()+a;f==d&&(e=Math.round(e));
g.centerAndZoomXY(g.center(),e,c,b)},f*20)};this.digizoomblocked=!1;this.wheelZoomTimeout=this.digizoomblockedTimeout=null;this._animateMove=function(c,b,a){clearTimeout(this.animateMoveTimeout);if(!(Math.abs(c)<this.wheelSpeedConfig.animateMinSpeed/a&&Math.abs(b)<this.wheelSpeedConfig.animateMinSpeed/a)){this.moveX+=-c;this.moveY+=-b;var f=this,d=Math.sqrt(Math.pow(c,2)+Math.pow(b,2)),g=c/d,e=b/d;this.animateMoveTimeout=window.setTimeout(function(){f._animateMove(c-g*f.wheelSpeedConfig.moveAnimationSlowdown/
a,b-e*f.wheelSpeedConfig.moveAnimationSlowdown/a,a)},20);this.setCenter2(this.position.center,this.position.zoom)}};this.autoZoomStartTime=this.autoZoomInTimeout=null;this._autoZoomIn=function(c,b,a){this.autoZoomInTimeout&&window.clearTimeout(this.autoZoomInTimeout);var f=0.2;a<0&&(f=-f);zoomGap=!1;Math.abs(a)<=Math.abs(f)&&(zoomGap=!0);var d=this.position.zoom+f;d=Math.round(d*1E3)/1E3;zoomGap&&(d=a<0?Math.floor(d):Math.ceil(d-0.2),f=d-this.position.zoom);faktor=Math.pow(2,d);var g=c-this.mapLeft-
this.width/2,e=b-this.mapTop-this.height/2,n=Math.pow(2,f);g-=g*n;e-=e*n;var x=this;n=(new Date).getMilliseconds();var t=this.autoZoomStartTime?n-this.autoZoomStartTime:0;this.autoZoomStartTime=n;if(t<100||zoomGap){d>=this.tileSource.minzoom&&d<=this.tileSource.maxzoom&&(this.moveX+=g/faktor,this.moveY+=e/faktor);var q=new khtml.maplib.LatLng(this.lat,this.lng);if(d>this.tileSource.maxzoom)d=this.tileSource.maxzoom;if(d<this.tileSource.minzoom)d=this.tileSource.minzoom;setTimeout(function(){x.setCenter2(q,
d)},1)}var u=a-f;zoomGap?this.digizoomblocked=!1:this.autoZoomInTimeout=window.setTimeout(function(){x._autoZoomIn(c,b,u)},40)};this.centerAndZoomXY=function(c,b,a,f){faktor=Math.pow(2,b);c=a-this.size.width/2;f-=this.size.height/2;a=b-this.zoom();a=Math.pow(2,a);c-=c*a;f-=f*a;b>=this.tileSource.minzoom&&b<=this.tileSource.maxzoom&&(this.moveX+=c/faktor,this.moveY+=f/faktor);c=new khtml.maplib.LatLng(this.lat,this.lng);if(b>this.tileSource.maxzoom)b=this.tileSource.maxzoom;if(b<this.tileSource.minzoom)b=
this.tileSource.minzoom;this.setCenter2(c,b)};this.centerAndZoom=function(c,b){this.moveY=this.moveX=0;if(b>this.tileSource.maxzoom)b=this.tileSource.maxzoom;if(b<this.tileSource.minzoom)b=this.tileSource.minzoom;this.record();this.setCenterNoLog(c,b)};this.render=function(){this.center(this.center())};this._setCenter3=function(c,b){this.moveY=this.moveX=0;this.setCenterNoLog(c,b)};this.setCenter2=function(c,b){this.record();this.setCenterNoLog(c,b)};this.setCenterNoLog=function(c,b){this.position.center=
c;this.lat=c.lat();this.lng=c.lng();b=parseFloat(b);if(b>this.tileSource.maxzoom)b=this.tileSource.maxzoom;if(b<this.tileSource.minzoom)b=this.tileSource.minzoom;this.position.center=c;this.position.zoom=b;this.layer(this.map,this.lat,this.lng,this.moveX,this.moveY,b);this._executeCallbackFunctions();this._getBounds()};this.center=function(c){typeof c!="undefined"&&this.centerAndZoom(c,this._getZoom());if(this.moveX!=0||this.moveY!=0)return c=new khtml.maplib.LatLng(this.movedLat,this.movedLng);return this.position.center};
this.zoom=function(c){typeof c!="undefined"&&this.centerAndZoom(this.position.center,c);return this.position.zoom};this.moveXY=function(c,b){this.moveX=parseFloat(c)/this.faktor/this.sc+this.moveDelayedX;this.moveY=parseFloat(b)/this.faktor/this.sc+this.moveDelayedY;this.setCenter2(this.center(),this.zoom())};this.tiles=function(c){this.clearMap();this.tileSource=c};this.tileOverlays=[];this.addTilesOverlay=function(c){this.tileOverlays.push(c);c=this.tileOverlays[this.tileOverlays.length-1];this.clearMap();
return c};this.removeTilesOverlay=function(c){for(var b=0;b<this.tileOverlays.length;b++)if(c==this.tileOverlays[b]){this.tileOverlays.splice(b,1);break}this.clearMap()};this._getCenter=function(){if(this.moveX!=0||this.moveY!=0)var c=new khtml.maplib.LatLng(this.movedLat,this.movedLng);else if(this.position.center)c=this.position.center;return c};this.bounds=function(c){if(typeof c!="undefined")this._setBounds(c);else return this.mapBounds};this.mapBounds=null;this._getBounds=function(){var c=this.XYTolatlng(0,
this.height),b=this.XYTolatlng(this.width,0);this.mapBounds=new khtml.maplib.geometry.Bounds(c,b)};this._setBounds=function(c){if(typeof khtml.maplib.geometry.Bounds=="undefined"||!(c instanceof khtml.maplib.geometry.Bounds))return!1;var a=c.sw();c=c.ne();var f=a.lat(),g=c.lat();a=a.lng();c=c.lng();f=d(f);var e=d(g);g=(a+c)/2;var m=b((f+e)/2);g=new khtml.maplib.LatLng(m,g);f=Math.abs(e-f);a=Math.abs(c-a);a/this.width>f/this.height?c=this.width:(a=f,c=this.height);a=Math.log(360/a/(512/c))/Math.log(2)+
1;if(a>this.tileSource.maxzoom)a=this.tileSource.maxzoom;if(a<this.tileSource.minzoom)a=this.tileSource.minzoom;this.position.center?this.wheelSpeedConfig.rectShiftAnimate?this.animatedGoto(g,a,this.wheelSpeedConfig.rectShiftAnimationTime):this.centerAndZoom(g,a):this.centerAndZoom(g,a)};this.animatedGotoStep=null;this.animatedGotoTimeout=[];this.animatedGoto=function(c,b,a){a/=10;var f=this._getCenter(),d=c.lat();c=c.lng();var g=f.lat(),e=f.lng(),n=this._getZoom(),x=(d-g)/a,t=(c-e)/a,q=(b-n)/a,u=
this.moveX/a,B=this.moveY/a,H=this.moveX,w=this.moveY;this.animatedGotoStep=0;for(var z=this;timeout=this.animatedGotoTimeout.pop();)clearTimeout(timeout);for(b=0;b<=a;b++)this.animatedGotoTimeout[b]=window.setTimeout(function(){z._animatedGotoExec(g,e,n,x,t,q,H,w,u,B)},10*b)};this._animatedGotoExec=function(c,b,a,f,d,g,e,n,x,t){this.moveX=-x;this.moveY=-t;c+=f*this.animatedGotoStep;b+=d*this.animatedGotoStep;a+=g*this.animatedGotoStep;this.animatedGotoStep++;this.centerAndZoom(new khtml.maplib.LatLng(c,
b),a)};this._getZoom=function(){return this.position.zoom};this._getIntZoom=function(){return this.intZoom};this.latlngToXY=function(c){var b=c.lat(),a=c.lng();b>90&&(b-=180);b<-90&&(b+=180);c=this._getIntZoom();tileTest=e(b,a,c);b=this._getCenter();c=e(b.lat(),b.lng(),c);b=(c[0]-tileTest[0])*this.tileW*this.sc-this.width/2;a=(c[1]-tileTest[1])*this.tileW*this.sc-this.height/2;c=[];c.x=-b;c.y=-a;return c};this.XYTolatlng=function(c,a){var f=this._getCenter();if(f){var d=Math.pow(2,this.intZoom),g=
f.lat();f=f.lng();f=e(g,f,this.intZoom);g=(f[0]+(c-this.width/2)/this.tileW/this.sc)/d*360-180;d=-b((f[1]+(a-this.height/2)/this.tileH/this.sc)/d*360-180)+0;return new khtml.maplib.LatLng(d,g)}};this.mouseToLatLng=function(c){var b=this.pageX(c);c=this.pageY(c);return this.XYTolatlng(b,c)};this.reSize=function(){var c=this;window.setTimeout(function(){c._getSize(c)},1050)};this._getSize=function(){this.width=this.map.parentNode.offsetWidth;this.height=this.map.parentNode.offsetHeight;var c=this.map,
b=0,a=0;do b+=c.offsetLeft,a+=c.offsetTop,c=c.offsetParent;while(c.offsetParent);this.mapTop=a;this.mapLeft=b};this.recordArray=[];this.record=function(){var c=this._getCenter();if(c){var b=c.lat();c=c.lng();var a=this._getZoom();this.recordArray.push([b,c,a])}};this.play=function(c){if(!(c<1)&&!(c>this.recordArray.length-1)){c=this.recordArray[c];var b=new khtml.maplib.LatLng(c[0],c[1]);this.moveY=this.moveX=0;this._setCenter3(b,c[2])}};this.layerDrawLastFrame=null;this.doTheOverlayes=!0;this.finalDraw=
!1;this.moveDelayedY=this.moveDelayedX=this.layerOldZoom=0;this.layerTimer=new this.myTimer(300);this.layer=function(c,b,a,f,d,g){this.stopRenderOverlays();g||(g=this._getZoom());if(this.layerDrawLastFrame)window.clearTimeout(this.layerDrawLastFrame),this.layerDrawLastFrame=null;if(this.layerTimer.isTimeRunning()||this.finalDraw==!1){var e=this,n=function(){e.finalDraw=!0;e.layer(c,b,a,f,d,g)};if(!e.finalDraw)this.layerDrawLastFrame=window.setTimeout(n,100);if(this.layerTimer.isTimeRunning()){this.moveDelayedX=
f;this.moveDelayedY=d;return}}this.layerTimer.start();for(n=this.moveDelayedY=this.moveDelayedX=0;n<22;n++)if(this.layers[n])this.layers[n].layerDiv.style.visibility="hidden";n=this.wheelSpeedConfig.digizoom?Math.floor(g):Math.round(g);if(this.layerOldZoom>g&&!this.finalDraw&&this.layers[n]&&!this.layers[n].loadComplete)this.visibleZoom=n+1;this.intZoom=n;if(n>this.tileSource.maxzoom)n=this.tileSource.maxzoom;if(!this.visibleZoom)this.oldIntZoom=this.visibleZoom=n;this.faktor=Math.pow(2,n);this.sc=
Math.pow(2,g-n);this.loadingZoomLevel=n;if(this.visibleZoom<n&&Math.abs(this.visibleZoom-n)<4)this.loadingZoomLevel=parseInt(this.visibleZoom)+1;this.draw(this.map,b,a,f,d,this.loadingZoomLevel,g,this.tileSource.src);this.layers[this.loadingZoomLevel].layerDiv.style.visibility="";if(n!=this.visibleZoom)this.visibleZoom<n+2?(this.draw(this.map,b,a,f,d,this.visibleZoom,g,this.tileSource.src),this.layers[this.visibleZoom].layerDiv.style.visibility=""):this.layers[this.visibleZoom].layerDiv.style.visibility=
"hidden";if(n==this.visibleZoom)this.draw(this.map,b,a,f,d,this.visibleZoom-1,g,this.tileSource.src),this.layers[this.visibleZoom-1].layerDiv.style.visibility="hidden";if(this.layers[this.loadingZoomLevel].loadComplete&&this.visibleLayer!=n)this.layers[this.loadingZoomLevel].loadComplete=!1,this._hideLayer(this.visibleZoom),this.visibleZoom=this.loadingZoomLevel;this.quadtreeTimeout&&clearTimeout(this.quadtreeTimeout);if(this.loadingZoomLevel!=n)e=this,this.quadtreeTimeout=window.setTimeout(function(){e.layer(c,
b,a,f,d)},200);this.oldIntZoom!=this.intZoom&&this.oldIntZoom!=this.visibleZoom&&this._hideLayer(this.oldIntZoom);this.oldIntZoom=n;this.delayedOverlay&&window.clearTimeout(this.delayedOverlay);this.doTheOverlayes||this.finalDraw||this.layerOldZoom==this.zoom()?(n=new Date,this.lastDX=this.moveX,this.lastDY=this.moveY,this.renderOverlays(),this.layerOldZoom=this.zoom(),this.doTheOverlayes=new Date-n>10&&!this.finalDraw?!1:!0):this._hideOverlays();e=this;this.layerBlockTimeout&&clearTimeout(this.layerBlockTimeout);
this.layerBlockTimeout=window.setTimeout(function(){e.layerTimer.reset()},20);this.finalDraw=!1};this.draw=function(c,a,f,g,o,m,p,n){this.framesCounter++;var x=this;window.setTimeout(function(){x.framesCounter--},1E3);var t=Math.pow(2,m);if(this.layers[m])q=this.layers[m].layerDiv,u=d(a)-this.layers[m].startLat,f-=this.layers[m].startLng;else{u=e(a,f,m);this.layers[m]=[];this.layers[m].startTileX=u[0];this.layers[m].startTileY=u[1];this.layers[m].startLat=d(a);this.layers[m].startLng=f;this.layers[m].images=
{};var q=document.createElement("div");q.setAttribute("zoomlevel",m);q.style.position="absolute";u=c.childNodes;c=!1;for(f=u.length-1;f>=0;f--)a=u.item(f),a.getAttribute("zoomlevel")<m&&(this.map.insertBefore(q,a),c=!0);c||this.map.appendChild(q);this.layers[m].layerDiv=q;var u=0;f=0}q.style.visibility="hidden";q.style.opacity=1;q.style.filter="alpha(opacity=100)";this.movedLng=(this.layers[m].startTileX/t-g/this.tileW)*360-180+f;this.movedLat=-b((this.layers[m].startTileY/t-o/this.tileH)*360-180-
u);u=e(this.movedLat,this.movedLng,m);g=u[0];f=u[1];o=Math.floor(g);c=Math.floor(f);a=this.layers[m].startTileX;var B=this.layers[m].startTileY;g=g-a-(-a+Math.floor(a));var H=f-B-(-B+Math.floor(B)),w;for(w in this.layers[m].images)this.layers[m].images[w].visibility=!1;f=this.width;var z=this.height;C=Math.pow(2,p-m);minX=Math.floor(-f/2/C/this.tileW+g);maxX=Math.ceil(f/2/C/this.tileW+g);minY=Math.floor(-z/2/C/this.tileH+H);maxY=Math.ceil(z/2/C/this.tileH+H);for(f=minX;f<maxX;f++)for(z=minY;z<maxY;z++){var y=
Math.floor(a+f),s=Math.floor(B+z),D=y%t,A=s;D<0&&(D+=t);if(!(A<0)&&!(A>=t)){var F=n(D,A,m);y=F+"-"+y+"-"+s;minsc=this.wheelSpeedConfig.digizoom?1:0.5;if(this.layers[m].images[y]==null&&C>=minsc){s=document.createElement("img");s.style.visibility="hidden";s.style.position="absolute";s.style.left=f*this.tileW+"px";s.style.top=z*this.tileH+"px";s.style.width=this.tileW+"px";s.style.height=this.tileH+"px";if(this.tileSource.opacity)s.style.opacity=this.tileSource.opacity;q.childNodes.length>0?q.insertBefore(s,
q.childNodes.item(0)):q.appendChild(s);this.layers[m].images[y]={};this.layers[m].images[y].img=s;this.layers[m].images[y].array=[];this.layers[m].images[y].array.push(s);this.layers[m].loadComplete=!1;for(ov in this.tileOverlays){var G=this.tileOverlays[ov],E=s.cloneNode(!0);G=G.src(D,A,m);E.setAttribute("overlay",ov);khtml.maplib.base.helpers.eventAttach(E,"load",this._imgLoaded,this,!1);q.appendChild(E);E.setAttribute("src",G);this.layers[m].images[y].array.push(E)}khtml.maplib.base.helpers.eventAttach(s,
"load",this._imgLoaded,this,!1);khtml.maplib.base.helpers.eventAttach(s,"error",this._imgError,this,!1);s.setAttribute("src",F)}if(!this.css3d&&this.layers[m].images[y]){D=this.layers[m].images[y].array;for(A=0;A<D.length;A++){var I=u[0]-o+Math.floor(g);E=u[1]-c+Math.floor(H);var J=Math.round(this.tileW*C);G=Math.round(this.tileH*C);F=Math.floor(-I*J+f*J);s=Math.floor(-E*G+z*G);I=Math.floor(-I*J+(f+1)*J);E=Math.floor(-E*G+(z+1)*G);D[A].style.left=F+"px";D[A].style.top=s+"px";D[A].style.height=I-F+
"px";D[A].style.width=E-s+"px"}}this.layers[m].images[y]&&(this.layers[m].images[y].visibility=!0)}}for(w in this.layers[m].images)if(this.layers[m].images[w].visibility){if(this.layers[m].images[w].array[0].getAttribute("loaded")=="yes"){n=this.layers[m].images[w].array;for(t=0;t<n.length;t++)if(n[t].getAttribute("loaded")=="yes")n[t].style.visibility=""}}else{n=this.layers[m].images[w].array;for(t=0;t<n.length;t++)this.layers[m].images[w].array[t].style.visibility="hidden",this.layers[m].images[w].array[t].getAttribute("loaded")!=
"yes"&&q.removeChild(this.layers[m].images[w].array[t]);delete this.layers[m].images[w].img;delete this.layers[m].images[w]}var C=Math.pow(2,p-m);F=-g*this.tileW;s=-H*this.tileH;if(this.css3d)q.style["-webkit-transform-origin"]=-1*F+"px "+-1*s+"px",q.style.webkitTransform="translate3d("+F+"px,"+s+"px,0px)  "+(" scale3d("+C+","+C+",1) ");q.style.visibility="";q.style.opacity=1;q.style.filter="";q=p=0;for(w in this.layers[this.loadingZoomLevel].images)q++,s=this.layers[this.loadingZoomLevel].images[w].array[0],
s.getAttribute("loaded")!="yes"&&p++;this.notLoadedImages=p;p<1&&(this.layers[this.loadingZoomLevel].loadComplete=!0);this.loadingZoomLevel==m&&this._imgLoadInfo(q,p)};this.fadeOutTimeout=null;this._fadeOut=function(c,b){this.fadeOutTimeout&&clearTimeout(this.fadeOutTimeout);if(b>0){c.style.opacity=b;c.style.filter="alpha( opacity="+b*100+" )";var a=this;this.fadeOutTimeout=setTimeout(function(){a._fadeOut(c,b-0.2)},40)}else c.style.visibility="hidden"};this._hideLayer=function(b){if(this.intZoom!=
b&&this.layers[b])this.layers[b].layerDiv.style.opacity=1,this.layers[b].layerDiv.style.filter="alpha(opacity=100)",this._fadeOut(this.layers[b].layerDiv,1);if(this.layers[b])for(var a in this.layers[b].images)if(this.layers[b].images[a]&&this.layers[b].images[a].img&&this.layers[b].images[a].img.getAttribute("loaded")!="yes"&&b!=this.intZoom){for(var f=this.layers[b].images[a].array,d=0;d<f.length;d++)this.layers[b].layerDiv.removeChild(this.layers[b].images[a].array[d]);delete this.layers[b].images[a].img;
delete this.layers[b].images[a]}};this._imgLoaded=function(b){b=b.target?b.target:b.srcElement;var a=!0;b.style.visibility="";b.setAttribute("loaded","yes");if(b.parentNode){for(var f=0,d=0,g=b.parentNode.getAttribute("zoomlevel"),e=0;e<b.parentNode.getElementsByTagName("img").length;e++){var p=b.parentNode.getElementsByTagName("img").item(e);p.getAttribute("overlay")||(d++,p.getAttribute("loaded")!="yes"&&(f++,a=!1))}this.notLoadedImages=f;this.loadingZoomLevel==g&&this._imgLoadInfo(d,f);if((this.layers[g].loadComplete=
a)&&this.loadingZoomLevel==g)this._hideLayer(this.visibleZoom),this._hideLayer(this.visibleZoom+1),this.visibleZoom=g}};this._imgError=function(b){var a=b.target?b.target:b.srcElement;a.parentNode&&(a.src!="http://khtml.org/notfound.png"&&a.setAttribute("src","http://khtml.org/notfound.png"),this._imgLoaded(b))};var e=function(b,a,f){return[(a+180)/360*(1<<f),(1-Math.log(Math.tan(b*Math.PI/180)+1/Math.cos(b*Math.PI/180))/Math.PI)/2*(1<<f)]};this._calculateMapSize=function(){var b=this.mapParent;if(b.currentStyle)var a=
b.currentStyle;else window.getComputedStyle&&(a=document.defaultView.getComputedStyle(b,null));var f=parseInt(a.borderTopWidth);isNaN(f)&&(f=0);var d=parseInt(a.borderLeftWidth);isNaN(d)&&(d=0);var g=parseInt(a.borderRightWidth);isNaN(g)&&(g=0);var e=parseInt(a.borderBottomWidth);isNaN(e)&&(e=0);var p=parseInt(a.paddingTop),n=parseInt(a.paddingBottom),x=parseInt(a.paddingLeft),t=parseInt(a.paddingRight),q=p,u=x;g=b.offsetWidth-d-g-x-t;e=b.offsetHeight-f-e-n-p;p=f+p;x=d+x;for(var B=!0;b&&!isNaN(b.offsetLeft)&&
!isNaN(b.offsetTop);)x+=b.offsetLeft-b.scrollLeft,p+=b.offsetTop-b.scrollTop,b.currentStyle?a=b.currentStyle:window.getComputedStyle&&(a=document.defaultView.getComputedStyle(b,null)),B&&(a&&a.position=="absolute"&&(B=!1),B&&(u+=b.offsetLeft+b.scrollLeft,q+=b.offsetTop+b.scrollTop),u+=d/2,q+=f/2),b=b.offsetParent;return{top:p,left:x,width:g,height:e,deltaTop:q,deltaLeft:u,deltaBottom:n,deltaRight:t}};this.redraw=function(){this._setMapPosition()};this._setMapPosition=function(){this.size=this._calculateMapSize();
var b=this.mapParent;b.currentStyle||window.getComputedStyle&&document.defaultView.getComputedStyle(b,null);this.mapTop=this.size.top;this.mapLeft=this.size.left;this.width=this.size.width;this.height=this.size.height;relativetop=this.size.deltaTop;relativeleft=this.size.deltaLeft;this.clone.style.top=relativetop+"px";this.clone.style.left=relativeleft+"px";this.clone.style.width=this.size.width+"px";this.clone.style.height=this.size.height+"px";this.clone.style.position="absolute";this.clone.style.overflow=
"hidden";this.map.style.left=this.size.width/2+"px";this.map.style.top=this.size.height/2+"px";this._getCenter()&&this._getZoom()&&this.centerAndZoom(this._getCenter(),this._getZoom());this._copyright()};this.clearMap=function(){if(this.map){for(;this.map.firstChild;)this.map.removeChild(this.map.firstChild);for(;this.layers.length>0;)this.layers.pop();this.redraw()}};var d=function(b){return 180/Math.PI*Math.log(Math.tan(Math.PI/4+b*(Math.PI/180)/2))},b=function(b){return 180/Math.PI*(2*Math.atan(Math.exp(b*
Math.PI/180))-Math.PI/2)};this._imgLoadInfo=function(b,a){if(!this.loadInfoDiv)this.loadInfoDiv=document.createElement("div"),this.loadInfoDiv.style.position="absolute",this.loadInfoDiv.style.top="0px",this.loadInfoDiv.style.right="0px",this.loadInfoDiv.style.backgroundColor="white",this.loadInfoDiv.style.border="1px solid gray",this.loadInfoDiv.style.fontSize="10px",this.map.parentNode.appendChild(this.loadInfoDiv);if(a==0)this.loadInfoDiv.style.display="none";else{for(this.loadInfoDiv.style.display=
"";this.loadInfoDiv.firstChild;)this.loadInfoDiv.removeChild(this.loadInfoDiv.firstChild);this.loadInfoDiv.appendChild(document.createTextNode(a+" images to load"))}};this.copyrightdiv=null;this._copyright=function(){if(this.copyrightdiv==null)this.copyrightdiv=document.createElement("div"),this.mapParent.appendChild(this.copyrightdiv);for(;this.copyrightdiv.firstChild;)this.copyrightdiv.removeChild(this.copyrightdiv.firstChild);var b=document.createElement("img"),a=document.createElement("a");a.setAttribute("href",
"http://maplib.khtml.org");a.setAttribute("target","_blank");b.setAttribute("src","http://maplib.khtml.org/favicon.png");b.style.zIndex=10;b.style.border="0px solid black";b.style.position="absolute";var f=this.size.height+this.size.deltaTop-24,d=this.size.deltaLeft+0;b.style.top=f+"px";b.style.left=d+"px";b.style.width="24px";b.style.height="24px";a.appendChild(b);this.copyrightdiv.appendChild(a);b=document.createElement("a");b.appendChild(document.createTextNode("openstreetmap"));b.style.position=
"absolute";b.style.top=f+2+"px";b.style.left=d+25+"px";b.style.textDecoration="none";b.style.color="gray";b.setAttribute("href","http://www.openstreetmap.org/copyright");this.copyrightdiv.appendChild(b)};this.internetExplorer=!1;if(navigator.userAgent.indexOf("MSIE")!=-1)this.internetExplorer=!0;if(navigator.userAgent.indexOf("Android")!=-1){var f=this;setInterval(function(){f.layerTimer.reset()},300)}this.position={};this.tiles({maxzoom:18,minzoom:1,src:function(b,a,f){switch((b+a)%3){case 0:var d=
"a";break;case 1:d="b";break;case 2:d="c";break;default:d="f"}return"http://"+d+".tile.openstreetmap.org/"+f+"/"+b+"/"+a+".png"},copyright:"osm"});this.wheelSpeedConfig=[];this.wheelSpeedConfig.acceleration=2;this.wheelSpeedConfig.maxSpeed=2;this.wheelSpeedConfig.animate=!1;navigator.userAgent.indexOf("AppleWebKit")!=-1&&(this.wheelSpeedConfig.animate=!0);navigator.userAgent.indexOf("Opera")!=-1&&(this.wheelSpeedConfig.animate=!1);this.wheelSpeedConfig.animate=!1;this.wheelSpeedConfig.digizoom=!0;
this.wheelSpeedConfig.zoomAnimationSlowdown=0.02;this.wheelSpeedConfig.animationFPS=50;this.wheelSpeedConfig.moveAnimateDesktop=!0;this.wheelSpeedConfig.rectShiftAnimate=!1;this.wheelSpeedConfig.rectShiftAnimationTime=500;this.wheelSpeedConfig.animateMinSpeed=0.4;this.wheelSpeedConfig.animateMaxSpeed=200;this.wheelSpeedConfig.moveAnimationSlowdown=0.4;this.framesCounter=this.wheelEventCounter=0;this.mapParent=a;khtml.maplib.base.helpers.setCursor(this.mapParent,"grab");this.clone=a.cloneNode(!0);
this.clone=document.createElement("div");this.clone.removeAttribute("id");a.firstChild?a.insertBefore(this.clone,a.firstChild):a.appendChild(this.clone);this.map=document.createElement("div");this.map.style.position="absolute";this.clone.appendChild(this.map);this._setMapPosition();this.overlayDiv=document.createElement("div");this.overlayDiv.style.position="absolute";this.clone.appendChild(this.overlayDiv);this.overlays=[];if(khtml.maplib.overlay.FeatureCollection)this.backend="svg",this.featureCollection=
new khtml.maplib.overlay.FeatureCollection,this.featureCollection.realLayer=!0,this.featureCollection.map=this,this.addOverlay(this.featureCollection);this.distanceMeasuring="no";this.measureLine=this.moveMarker=null;this.moveAnimationMobile=!0;this.moveAnimationBlocked=this.moveAnimationDesktop=!1;this.lastMouseX=this.width/2;this.lastMouseY=this.height/2;this.layers=[];this.intZoom=this.oldVisibleZoom=this.visibleZoom=null;this.lastMoveTime=this.lastMoveY=this.lastMoveX=this.moveY=this.moveX=0;
this.zoomDeltaOld=1;this.startMoveY=this.startMoveX=0;this.sc=1;this.blocked=!1;this.tileH=this.tileW=256;this.position.zoom=1;this.movestarted=!1;this.mousedownTime=null;this.doubleclickTime=400;this.mousedownTime2=null;this.doubleclickTime2=500;this.zoomOutTime=1E3;this.zoomOutSpeed=0.01;this.zoomOutInterval=null;this.zoomOutStarted=!1;this.zoomSpeedTimer=null;this.zoomAcceleration=1;this.css3d=!1;if(navigator.userAgent.indexOf("iPhone OS")!=-1)this.css3d=!0;if(navigator.userAgent.indexOf("iPad")!=
-1)this.css3d=!1;if(navigator.userAgent.indexOf("Safari")!=-1)this.css3d=navigator.userAgent.indexOf("Mac")!=-1?!1:!0;if(navigator.userAgent.indexOf("iPhone OS")!=-1)this.css3d=!0;if(navigator.userAgent.indexOf("Android")!=-1)this.css3d=!1;if(this.internetExplorer){var g=a;navigator.userAgent.indexOf("Windows Phone OS")!=-1&&khtml.maplib.base.helpers.eventAttach(g,"mouseup",this._mouseupIE,this,!1)}else g=window;khtml.maplib.base.helpers.eventAttach(window,"resize",this._setMapPosition,this,!1);navigator.userAgent.indexOf("Konqueror")!=
-1&&(g=a);khtml.maplib.base.helpers.eventAttach(a,"touchstart",this._start,this,!1);khtml.maplib.base.helpers.eventAttach(a,"touchmove",this._move,this,!1);khtml.maplib.base.helpers.eventAttach(a,"touchend",this._end,this,!1);khtml.maplib.base.helpers.eventAttach(g,"mousemove",this._mousemove,this,!1);khtml.maplib.base.helpers.eventAttach(a,"mousedown",this._mousedown,this,!1);khtml.maplib.base.helpers.eventAttach(g,"mouseup",this._mouseup,this,!1);khtml.maplib.base.helpers.eventAttach(g,"orientationchange",
this.reSize,this,!1);khtml.maplib.base.helpers.eventAttach(a,"DOMMouseScroll",this._mousewheel,this,!1);khtml.maplib.base.helpers.eventAttach(a,"dblclick",this._doubleclick,this,!1);khtml.maplib.base.helpers.eventAttach(g,"keydown",this._shiftkeydown,this,!1);khtml.maplib.base.helpers.eventAttach(g,"keyup",this._shiftkeyup,this,!1);khtml.maplib.base.helpers.eventAttach(a,"contextmenu",function(b){b.preventDefault()},this,!1)};khtml.maplib.geometry.Bounds=function(a,e){this.enlarge=function(b){b.lng()>this.southwest.lng()&&b.lng()>this.northeast.lng()&&this.northeast.lng(b.lng());b.lng()<this.southwest.lng()&&b.lng()<this.northeast.lng()&&this.southwest.lng(b.lng());b.lat()>this.southwest.lat()&&b.lat()>this.northeast.lat()&&this.northeast.lat(b.lat());b.lat()<this.southwest.lat()&&b.lat()<this.northeast.lat()&&this.southwest.lat(b.lat())};this.sw=function(){return this.southwest};this.se=function(){return new khtml.maplib.LatLng(this.southwest.lat(),
this.northeast.lng())};this.ne=function(){return this.northeast};this.nw=function(){return new khtml.maplib.LatLng(this.northeast.lat(),this.southwest.lng())};this.getCenter=function(){return this.center};this.getOpticalCenter=function(b){var a=b.latlngToXY(this.southwest),d=b.latlngToXY(this.northeast);return b.XYTolatlng(Math.abs(a.x+d.x)/2,Math.abs(a.y+d.y)/2)};this.getZoomLevel=function(b){origZoom=b.getZoom();var a=b.latlngToXY(this.southwest),d=b.latlngToXY(this.northeast),c=b.width/Math.abs(a.x-
d.x);b=b.height/Math.abs(a.y-d.y);if(c>b)var e=b;c<=b&&(e=c);return origZoom+Math.log(e)/Math.log(2)};this.getDistance=function(){return this.distance(this.southwest.lat(),this.southwest.lng(),this.northeast.lat(),this.northeast.lng())};this.getInnerRadius=function(){var b=this.distance(this.center.lat(),this.southwest.lng(),this.center.lat(),this.northeast.lng()),a=this.distance(this.southwest.lat(),this.center.lng(),this.northeast.lat(),this.center.lng());return b>a?a/2:b/2};this.distance=function(b,
a,d,c){b=b*Math.PI/180;d=d*Math.PI/180;return Math.acos(Math.sin(b)*Math.sin(d)+Math.cos(b)*Math.cos(d)*Math.cos(c*Math.PI/180-a*Math.PI/180))*180/Math.PI/360*4E7};this.intersects=function(b){if(!(b instanceof khtml.maplib.geometry.Bounds))return khtml.maplib.base.Log.warn('Bounds.intersects(): Illegal argument. Has to be "khtml.maplib.geometry.Bounds"!'),!1;var a=Math.min(this.sw().lat(),this.ne().lat()),d=Math.max(this.sw().lat(),this.ne().lat()),c=Math.min(this.sw().lng(),this.ne().lng()),e=Math.max(this.sw().lng(),
this.ne().lng()),h=[];h.push(b.ne());h.push(b.se());h.push(b.sw());h.push(b.nw());for(b=0;b<h.length;b++){var l=h[b],o=l.lat()>=a&&l.lat()<=d;l=l.lng()>=c&&l.lng()<=e;if(o&&l)return!0}return!1};this.createBoundsFrom2Points=function(b,a){var d=new khtml.maplib.LatLng(Math.min(b.lat(),a.lat()),Math.min(b.lng(),a.lng())),c=new khtml.maplib.LatLng(Math.max(b.lat(),a.lat()),Math.max(b.lng(),a.lng()));return{sw:d,ne:c}};var d=this.createBoundsFrom2Points(a,e);this.southwest=d.sw;this.northeast=d.ne;this.center=
new khtml.maplib.LatLng((this.southwest.lat()+this.northeast.lat())/2,(this.southwest.lng()+this.northeast.lng())/2)};khtml.maplib.geometry.LatLng=function(a,e){this.callbackFunctions=[];this.addCallbackFunction=function(a){typeof a=="function"&&this.callbackFunctions.push(a)};this._executeCallbackFunctions=function(){for(var a=0;a<this.callbackFunctions.length;a++)this.callbackFunctions[a].call(this)};this.lat=function(a){if(typeof a=="number")this.latitude=a,this._executeCallbackFunctions();if(typeof a=="string")this.latitude=parseFloat(a),this._executeCallbackFunctions();return this.latitude};this.lng=function(a){if(typeof a==
"number")this.longitude=a,this._executeCallbackFunctions();if(typeof a=="string")this.longitude=parseFloat(a),this._executeCallbackFunctions();return this.longitude};this.equals=function(a){if(null==a)return!1;if(!(a instanceof khtml.maplib.LatLng))return khtml.maplib.base.Log.warn("Point.equals(): Error - illegal argument!",a),!1;return a.lat()===this.lat()&&a.lng()===this.lng()};a instanceof khtml.maplib.geometry.LatLng?(this.lat(a.lat()),this.lng(a.lng())):typeof a=="object"?(a.lat&&this.lat(a.lat),
a.lng&&this.lng(a.lng)):(this.lat(a),this.lng(e))};khtml.maplib.geometry.Feature=function(a){this.type="Feature";this.geometry={};this.geometry.coordinates=[];this.properties={};this.events={};this.style={};this.className={};this.text={};this.text.style={};this.text.className={};this.className.baseVal="khtml_vector_line";if(typeof a=="object"&&a.type)if(a.type=="Feature"){this.geometry.type=a.geometry.type;this.geometry.coordinates=khtml.maplib.base.helpers.parseLine(a.geometry.coordinates);if(a.className)this.className.baseVal=a.className.baseVal;
if(a.geometry.type=="FeatureCollection"){for(var e=new khtml.maplib.overlay.FeatureCollection,d=0;d<a.features.length;d++){var b=a.features[d];e.appendChild(new khtml.maplib.geometry.Feature(b))}return e}}else{this.geometry.type=a.type;if(a.coordinates){this.geometry.coordinates=khtml.maplib.base.helpers.parseLine(a.coordinates);return}if(a.type=="FeatureCollection"){e=new khtml.maplib.overlay.FeatureCollection;if(a.feature)for(d=0;d<a.features.length;d++)b=a.features[d],e.appendChild(new khtml.maplib.geometry.Feature(b));
return e}}if(typeof a=="string")this.geometry.type=a;this.setPoints=function(b){this.geometry.coordinates=khtml.maplib.base.helpers.parseLine(b)};this.geojson=function(){return khtml.maplib.base.helpers.stringify(this)};this.cloneNode=function(){return khtml.maplib.base.helpers.cloneObject(this)}};khtml.maplib.overlay.Vector=function(a){function e(b){if(b.features)for(var a=0;a<b.features.length;a++)e(b.features[a]);a={};for(var d=["fill","stroke","strokeWidth","opacity","fillOpacity","strokeOpacity"],c=0;c<d.length;c++){var k=d[c];b.style[k]!="undefined"&&(a[k]=b.style[k])}b.style=a;b.vectorEl&&b.vectorEl.parentNode&&b.vectorEl.parentNode.removeChild(b.vectorEl);delete b.vectorEl;delete b.vectorLayer;delete b.map}function d(){var b=-1;navigator.appName=="Microsoft Internet Explorer"&&/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)!=
null&&(b=parseFloat(RegExp.$1));return b}this.vectorPointsPerIteration=this.minVectorPointsPerIteration=2E3;this.lineArray=[];this.stopit=!1;this.backend=a?a:"svg";if(navigator.userAgent.indexOf("Android")!=-1)this.backend="canvas";this.svgStyleInterface=!1;if(navigator.userAgent.indexOf("MSIE")!=-1){if(d()<9)this.backend="vml";if(document.documentMode<9)this.backend="vml"}this.canvasClassStyles=[];this.boundsSouth=90;this.boundsNorth=-90;this.boundsWest=180;this.boundsEast=-180;this.renderbackend=
function(b){if(b)this.remove(),this.backend=b,this.owner.init(this.themap);return this.backend};this.createVirtualVectorElement=function(b){switch(this.backend){case "canvas":case "vml":return b;case "svg":b=document.createElementNS("http://www.w3.org/2000/svg","g");if(this.owner.className&&this.owner.className.baseVal)b.className.baseVal=this.owner.className.baseVal;this.owner.className=b.className;return b;default:alert("unknown backend: "+this.backend)}};this.createVectorElement=function(b){switch(this.backend){case "canvas":var a=
document.createElement("canvas");this.ctx=a.getContext("2d");break;case "svg":a=document.createElementNS("http://www.w3.org/2000/svg","svg");break;case "vml":document.namespaces&&document.namespaces.v==null&&(document.namespaces.add("v","urn:schemas-microsoft-com:vml"),a=document.createStyleSheet(),a.addRule("v\\:group","behavior: url(#default#VML);"),a.addRule("v\\:polyline","behavior: url(#default#VML);"),a.addRule("v\\:stroke","behavior: url(#default#VML);"),a.addRule("v\\:fill","behavior: url(#default#VML);"),
a.addRule("v\\:shape","behavior: url(#default#VML);display:inline-block"),a.addRule("v\\:path","behavior: url(#default#VML);"));a=document.createElement("v:group");a.setAttribute("debug","soso");break;default:alert("error: unknown vector backend")}a.style.width=b.size.width+"px";a.style.height=b.size.height+"px";a.setAttribute("height",b.size.height+"px");a.setAttribute("width",b.size.width+"px");a.style.position="absolute";a.style.top="0";a.style.left="0";return a};this.init=function(b,a){this.owner=
b;this.themap=b instanceof khtml.maplib.base.Map?b:b.map;if(a){var d=this.createVirtualVectorElement(a.vectorEl);this.backend=="svg"&&a.vectorEl.appendChild(d);if(this.backend=="vml")d=a.vectorEl;if(this.backend=="canvas")this.ctx=a.vectorLayer.ctx}else d=this.createVectorElement(this.themap),this.owner.overlayDiv.appendChild(d);return d};this.createPolyline=function(b){b.tags=[];if(!b.close)b.close=!1;b.id=null;if(!b.geometry.coordinates)b.geometry.coordinates=[];b.calculateCenter=function(){for(var a=
0,f=0,d=0;d<b.points.length;d++)a+=b.points[d].lat(),f+=b.points[d].lng();return new khtml.maplib.LatLng(a/b.points.length,f/b.points.length)};var a=this;b.bbox=this.makeBounds(b.geometry.coordinates);b.render=function(){a.render(b)};b.clear=function(){a.backend=="svg"&&b.path&&b.path.parentNode&&b.path.parentNode.removeChild(b.path)};for(var d=b.owner;d&&!d.realLayer;)d=d.owner;d&&d.vectorLayer.lineArray.unshift(b);return b};this.cancel=function(){this.stopit=!0};this.renderCount=0;this.render=function(b){var a=
Math.floor(this.themap.zoom());if(this.owner.vectorEl||this.backend=="canvas"){this.owner.vectorEl&&this.owner.vectorEl.localName=="svg"&&this.owner.vectorEl.setAttribute("class","z"+a);if(this.stopit&&(this.stopit=!1,b!=null)){if(this.oldVectorEl&&this.oldVectorEl.parentNode)try{this.oldVectorEl.parentNode.removeChild(this.oldVectorEl),this.owner.vectorEl=this.createVectorElement(this.themap),this.themap.overlayDiv.appendChild(this.owner.vectorEl)}catch(d){alert(this.oldVectorEl.tagName),alert(this.oldVectorEl.parentNode.tagName)}return}if(b==
null)this.backend=="canvas"&&this.ctx.beginPath(),this.oldtimestamp=(new Date).getTime(),this.starttimestamp=(new Date).getTime(),this.renderCount=this.totalLinesCounter=this.totalPointsCounter=0,this.oldZoom=this.themap.zoom(),b=this.lineArray.length-1,this.lastMoveX=this.themap.moveX,this.lastMoveY=this.themap.moveY;if(b<0){if(this.backend=="canvas"&&(this.ctx.fill(),this.ctx.stroke()),this.timestamp=(new Date).getTime(),this.renderIterationTime=this.timestamp-this.starttimestamp,this.totalPoints=
this.totalPointsCounter,this.totalLines=this.totalLinesCounter,this.oldVectorEl&&this.oldVectorEl.parentNode)this.oldVectorEl.parentNode.replaceChild(this.owner.vectorEl,this.oldVectorEl),this.owner.vectorEl.style.display=""}else{a=typeof b=="number"?this.lineArray[b]:b;if(khtml.maplib.base.helpers.overlaps(this.themap.bounds(),a.bbox)){switch(this.backend){case "svg":if(a.path)c=a.path;else{var c=khtml.maplib.overlay.renderer.SVG._renderInitPolyline(a);a.geometry.type=="Polygon"||a.geometry.type==
"MultiPolygon"||a.geometry.type=="Polyline"&&a.close?a.close="true":a.style.fill="none";a.close="false";a.path=c;c.owner=a}break;case "vml":var e=document.createElement("v:shape");e.style.top="0px";e.style.left="0px";e.style.position="relative"}switch(this.backend){case "svg":var h=khtml.maplib.overlay.renderer.SVG._calculatePath(a.geometry.coordinates,a.geometry.type,this.themap);h.d!=""&&c.setAttribute("d",h.d);for(var l in a.properties)c.setAttribute("mapcss_"+l,a.properties[l]);c.style.fillRule=
"evenodd";a.owner.vectorEl.appendChild(c);a.svgtext=this.addText(a);break;case "canvas":h=khtml.maplib.overlay.renderer.Canvas._renderPath(a.geometry.coordinates,a,this.ctx,this.themap);break;case "vml":h=khtml.maplib.overlay.renderer.VML._calculatePath(a.geometry.coordinates,a.geometry.type,this.themap);if(!this.themap.styler)this.themap.styler=new khtml.maplib.overlay.renderer.Styler;c=this.themap.styler.makeCanvasStyle(a);if(h.d!=void 0){e.setAttribute("path",h.d+" x e");e.setAttribute("fillcolor",
c.fillRGB);e.setAttribute("strokecolor",c.strokeRGB);e.setAttribute("strokeweight",c.lineWidth);a.geometry.type=="Polygon"||a.geometry.type=="MultiPolygon"||a.geometry.type=="LinearRing"?e.setAttribute("filled",!0):e.setAttribute("filled",!1);c=document.createElement("div");c.style.position="absolute";l=a.bbox.ne().lat();var o=a.bbox.sw().lng(),m=a.bbox.ne().lng();a=a.bbox.sw().lat();this.themap.latlngToXY(new khtml.maplib.LatLng(l,o));this.themap.latlngToXY(new khtml.maplib.LatLng(a,m));e.style.height=
"1680px";e.style.width="1250px";e.coordsize="1000 1000";this.owner.vectorEl.appendChild(e);c.style.border="1px solid red";this.themap.finalDraw&&this.themap.overlayDiv.appendChild(this.owner.vectorEl)}break;default:console.log("error: unknow backend")}this.renderCount+=h.points;this.totalPointsCounter+=h.points;this.totalLinesCounter+=h.lines}else a.clear();if(typeof b!="number"){if(this.backend=="canvas"){this.canvasRenderTimeout&&clearTimeout(this.canvasRenderTimeout);var p=this;this.canvasRenderTimeout=
setTimeout(function(){p.ctx.stroke();p.ctx.fill()},1)}}else if(this.timestamp=(new Date).getTime(),this.iterationTime=this.timestamp-this.oldtimestamp,this.renderCount>this.vectorPointsPerIteration){this.vectorPointsPerIteration=Math.ceil(this.vectorPointsPerIteration*100/this.iterationTime);if(this.vectorPointsPerIteration<this.minVectorPointsPerIteration)this.vectorPointsPerIteration=this.minVectorPointsPerIteration;this.oldtimestamp=this.timestamp;this.renderCount=0;p=this;setTimeout(function(){p.render(b-
1)},0)}else this.render(b-1)}}};this.makeBounds=function(a){for(var f=90,d=-90,c=180,e=-180,h=0;h<a.length;h++)if(a[h]instanceof khtml.maplib.geometry.LatLng){var l=a[h].lng(),o=a[h].lat();o>d&&(d=o);o<f&&(f=o);l>e&&(e=l);l<c&&(c=l)}else l=this.makeBounds(a[h]),l.sw().lat()<f&&(f=l.sw().lat()),l.sw().lng()<c&&(c=l.sw().lng()),l.ne().lat()>d&&(d=l.ne().lat()),l.ne().lng()>e&&(e=l.ne().lng());a=new khtml.maplib.LatLng(f,c);d=new khtml.maplib.LatLng(d,e);return new khtml.maplib.geometry.Bounds(a,d)};
this.addText=function(a){a.textEl&&a.textEl.parentNode.removeChild(a.textEl);if(a.text&&a.text.value){var f=a.text.value,d=document.createElementNS("http://www.w3.org/2000/svg","text"),c=document.createElementNS("http://www.w3.org/2000/svg","textPath");c.setAttribute("startOffset","50%");d.appendChild(c);c.appendChild(document.createTextNode(f));for(var e in a.text.style)d.style[e]=a.text.style[e];a.text.style=d.style;d.className.baseVal=a.text.className.baseVal;a.text.className.baseVal=d.className.baseVal;
f=a.text.style.fontSize?parseFloat(a.text.style.fontSize)/2:0;d.setAttribute("dy",f*0.7);f="maplib_khtml_textpath_"+Math.random();a.path.setAttribute("id",f);c.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+f);this.owner.vectorEl.appendChild(d);return d}};this.bounds=function(){var a=new khtml.maplib.LatLng(this.boundsSouth,this.boundsWest),d=new khtml.maplib.LatLng(this.boundsNorth,this.boundsEast);return new khtml.maplib.geometry.Bounds(a,d)};this.clear=function(){this.ctx&&this.ctx.clearRect(0,
0,this.themap.size.width,this.themap.size.height);if(this.backend=="svg")for(var a=0;a<this.owner.vectorEl.childNodes.length;a++){var d=this.owner.vectorEl.childNodes[a];d&&d.tagName!="g"&&this.owner.vectorEl.removeChild(d)}if(this.backend=="vml")for(;this.owner.vectorEl.firstChild;)this.owner.vectorEl.removeChild(this.owner.vectorEl.firstChild)};this.remove=function(){this.clear();e(this.owner);this.lineArray=[]}};khtml.maplib.overlay.MarkerImage=function(a,e,d,b){if(a)this.url=a;if(e)this.size=e;if(d)this.origin=d;if(b)this.anchor=b};khtml.maplib.overlay.MarkerOptions=function(a,e,d,b,f,g,c,k,h,l,o,m,p){if(b)this.draggable=b;if(g)this.icon=g;if(c)this.map=c;if(h)this.position=h;if(l)this.raiseOnDrag=l;if(o)this.shadow=o;if(m)this.shape=m;if(p)this.title=p};
khtml.maplib.overlay.Marker=function(a){this.setPosition=function(a){a&&(this.position.lat(a.lat()),this.position.lng(a.lng()),this.render());return this.position};this.getPosition=function(){return this.position};this.pixelOffset=function(){var a=[];!isNaN(parseInt(this.marker.style.width))&&!isNaN(parseInt(this.marker.style.height))?(a.x=parseInt(this.marker.style.width)/2,a.y=parseInt(this.marker.style.height)):a={x:0,y:0};return a};this.clear=function(){if(this.marker&&this.marker.parentNode)try{this.owner.overlayDiv.markerDiv.removeChild(this.marker),
this.shadow&&this.owner.overlayDiv.shadowDiv.removeChild(this.shadow)}catch(a){}};this.destroy=function(){this.mapObj.removeOverlay(this)};this.callbackFunctions=[];this.addCallbackFunction=function(a){typeof a=="function"&&this.callbackFunctions.push(a)};this._executeCallbackFunctions=function(){for(var a=0;a<this.callbackFunctions.length;a++)this.callbackFunctions[a].call(this)};this._setCursor=function(a){this.MarkerOptions.shape&&navigator.userAgent.indexOf("MSIE")==-1&&navigator.userAgent.indexOf("iPhone")==
-1&&navigator.userAgent.indexOf("iPad")==-1?(khtml.maplib.base.helpers.setCursor(this.marker,""),khtml.maplib.base.helpers.setCursor(this.area,a)):khtml.maplib.base.helpers.setCursor(this.marker,a)};this.moving=!1;this._mousedown=function(a){this.moving=!0;this.clickx=this.marker.offsetLeft-this.mapObj.pageX(a)+this.dx;this.clicky=this.marker.offsetTop-this.mapObj.pageY(a)+this.dy;a.preventDefault?a.preventDefault():window.event.returnValue=!1;a.stopPropagation?a.stopPropagation():window.event.cancelBubble=
!0;a=navigator.userAgent.indexOf("MSIE")!=-1?this.mapObj.mapParent:window;khtml.maplib.base.helpers.eventAttach(a,"mousemove",this._mousemove,this,!1);khtml.maplib.base.helpers.eventAttach(a,"mouseup",this._mouseup,this,!1);khtml.maplib.base.helpers.setCursor(this.mapObj.mapParent,"grabbing");this._setCursor("grabbing")};this._mousemove=function(a){if(this.moving){this.x=this.mapObj.pageX(a)+this.clickx;this.y=this.mapObj.pageY(a)+this.clicky;this.position.lat(this.mapObj.XYTolatlng(this.x,this.y).lat());
this.position.lng(this.mapObj.XYTolatlng(this.x,this.y).lng());this.render();a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0;this.marker.style.zIndex=1E6;if(this.shadow)this.shadow.style.zIndex=1E6;if((this.MarkerOptions.raiseOnDrag==null||this.MarkerOptions.raiseOnDrag==!0)&&!this.raised){this.dragcross=document.createElement("div");this.dragcross.style.position="absolute";this.dragcross.dx=8;this.dragcross.dy=8;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?(a=document.createElement("div"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+dragcross_image+"')",a.style.width="100%",a.style.height="100%"):(a=document.createElement("img"),a.setAttribute("src",dragcross_image));this.dragcross.style.width="16px";this.dragcross.style.height="16px";this.dragcross.appendChild(a);this.dragcross.style.left=this.x-this.dragcross.dx+"px";this.dragcross.style.top=this.y-this.dragcross.dy+"px";this.owner.overlayDiv.markerDiv.appendChild(this.dragcross);
var b=this;window.clearInterval(this.markerDropInterval);this.markerRaiseInterval=window.setInterval(function(){b._raiseMarker()},5);this.raised=!0}this._mousemoveMap()}};this._mouseup=function(){if(this.moving)this.position.lat(this.mapObj.XYTolatlng(this.x,this.y).lat()),this.position.lng(this.mapObj.XYTolatlng(this.x,this.y).lng()),this.moving=!1,d=e=mapMoveSpeed=1,window.clearInterval(this.mapmoveInterval);var a=this.mapObj.latlngToXY(this.position);this.marker.style.zIndex=this.mapObj.size.height+
a.y;if(this.shadow)this.shadow.style.zIndex=a.y;if((this.MarkerOptions.raiseOnDrag==null||this.MarkerOptions.raiseOnDrag==!0)&&this.raised){this.owner.overlayDiv.markerDiv.removeChild(this.dragcross);var b=this;window.clearInterval(this.markerRaiseInterval);this.markerDropInterval=window.setInterval(function(){b._dropMarker()},5);this.raised=!1}khtml.maplib.base.helpers.setCursor(this.mapObj.mapParent,"grab");this._setCursor("pointer");this.render();this._executeCallbackFunctions()};this._touchstart=
function(a){a.touches.length==1?(this.moving=!0,this.touchx=this.marker.offsetLeft-this.mapObj.pageX(a.touches[0]),this.touchy=this.marker.offsetTop-this.mapObj.pageY(a.touches[0]),khtml.maplib.base.helpers.eventAttach(window,"touchmove",this._touchmove,this,!0),khtml.maplib.base.helpers.eventAttach(window,"touchend",this._touchend,this,!0)):this.moving=!1};this._touchmove=function(a){if(a.touches.length==1&&this.moving){this.x=this.mapObj.pageX(a.touches[0])+this.touchx+this.dx;this.y=this.mapObj.pageY(a.touches[0])+
this.touchy+this.dy;this.position.lat(this.mapObj.XYTolatlng(this.x,this.y).lat());this.position.lng(this.mapObj.XYTolatlng(this.x,this.y).lng());this.render();if(!this.clicked)a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0;this.marker.style.zIndex=1E6;if(this.shadow)this.shadow.style.zIndex=1E6;if((this.MarkerOptions.raiseOnDrag==null||this.MarkerOptions.raiseOnDrag==!0)&&!this.raised){this.dragcross=document.createElement("div");this.dragcross.style.position="absolute";this.dragcross.dx=
8;this.dragcross.dy=8;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(a=document.createElement("div"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+dragcross_image+"')",a.style.width="100%",a.style.height="100%"):(a=document.createElement("img"),a.setAttribute("src",dragcross_image));this.dragcross.style.width="16px";this.dragcross.style.height="16px";this.dragcross.appendChild(a);this.dragcross.style.left=
this.x-this.dragcross.dx+"px";this.dragcross.style.top=this.y-this.dragcross.dy+"px";this.owner.overlayDiv.markerDiv.appendChild(this.dragcross);var b=this;window.clearInterval(this.markerDropInterval);this.markerRaiseInterval=window.setInterval(function(){b._raiseMarker()},20);this.raised=!0}this._mousemoveMap()}};this._touchend=function(){if(this.moving)this.position.lat(this.mapObj.XYTolatlng(this.x,this.y).lat()),this.position.lng(this.mapObj.XYTolatlng(this.x,this.y).lng()),this.moving=!1,d=
e=mapMoveSpeed=1,window.clearInterval(this.mapmoveInterval);var a=this.mapObj.latlngToXY(this.position);this.marker.style.zIndex=a.y;if(this.shadow)this.shadow.style.zIndex=a.y;if((this.MarkerOptions.raiseOnDrag==null||this.MarkerOptions.raiseOnDrag==!0)&&this.raised){this.owner.overlayDiv.markerDiv.removeChild(this.dragcross);var b=this;window.clearInterval(this.markerRaiseInterval);this.markerDropInterval=window.setInterval(function(){b._dropMarker()},20);this.raised=!1}window.clearInterval(this.mapmoveInterval);
this.render()};this._raiseMarker=function(){this.dy+=5;this.shadow&&(this.shadow.dx-=3.75,this.shadow.dy+=3.75);this.render();if(isNaN(this.i))this.i=0;this.i+=5;this.i>20&&window.clearInterval(this.markerRaiseInterval)};this._dropMarker=function(){isNaN(this.i)?this.i=0:this.i>=5?(this.i-=5,this.dy-=5,this.shadow&&(this.shadow.dx+=3.75,this.shadow.dy-=3.75),this.render()):window.clearInterval(this.markerDropInterval)};var e=1,d=1;this._mousemoveMap=function(){var a=this;this.mapObj.latlngToXY(this.position).x<
this.mapObj.size.width/10?(e=(1-this.mapObj.latlngToXY(this.position).x/(this.mapObj.size.width/10))*10,this.mapObj.latlngToXY(this.position).y<this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),d=(1-this.mapObj.latlngToXY(this.position).y/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(e,d)},10)):this.mapObj.latlngToXY(this.position).y>this.mapObj.size.height-this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),
d=(1-(this.mapObj.size.height-this.mapObj.latlngToXY(this.position).y)/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(e,-d)},10)):(window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(e,0)},10))):this.mapObj.latlngToXY(this.position).x>this.mapObj.size.width-this.mapObj.size.width/10?(e=(1-(this.mapObj.size.width-this.mapObj.latlngToXY(this.position).x)/(this.mapObj.size.width/10))*10,this.mapObj.latlngToXY(this.position).y<
this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),d=(1-this.mapObj.latlngToXY(this.position).y/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-e,d)},10)):this.mapObj.latlngToXY(this.position).y>this.mapObj.size.height-this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),d=(1-(this.mapObj.size.height-this.mapObj.latlngToXY(this.position).y)/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-e,
-d)},10)):(window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-e,0)},10))):this.mapObj.latlngToXY(this.position).y<this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),d=(1-this.mapObj.latlngToXY(this.position).y/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(0,d)},10)):this.mapObj.latlngToXY(this.position).y>this.mapObj.size.height-this.mapObj.size.height/10?(window.clearInterval(this.mapmoveInterval),
d=(1-(this.mapObj.size.height-this.mapObj.latlngToXY(this.position).y)/(this.mapObj.size.height/10))*10,this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(0,-d)},10)):(window.clearInterval(this.mapmoveInterval),d=e=1)};this.makeMoveable=function(){this.MarkerOptions.shape?(khtml.maplib.base.helpers.eventAttach(this.area,"mousedown",this._mousedown,this,!1),khtml.maplib.base.helpers.eventAttach(this.area,"touchstart",this._touchstart,this,!1)):(khtml.maplib.base.helpers.eventAttach(this.marker,
"mousedown",this._mousedown,this,!1),khtml.maplib.base.helpers.eventAttach(this.marker,"touchstart",this._touchstart,this,!1));this.MarkerOptions.draggable=!0};this.clickDetectY=this.clickDetectX=-1;this._touchclickdetectstart=function(a){if(a.touches.length==1)this.clickDetectY=this.clickDetectX=-1,this.clicked=!0};this._touchclickdetectmove=function(a){if(a.touches.length==1&&(this.clickDetectX=a.touches[0].pageX,this.clickDetectY=a.touches[0].pageY,this.MarkerOptions.draggable))a.stopPropagation?
a.stopPropagation():window.event.cancelBubble=!0};this._touchclickdetectstop=function(a){if(a.touches.length==0&&this.clickDetectX==-1&&this.clickDetectY==-1)this.originalClickFunction(),this.clicked=!1};this._mouseclickdetectstart=function(a){this.leftclick=!1;if(!a)a=window.event;if(a.which)this.leftclick=a.which==1;else if(a.button)this.leftclick=a.button==0||a.button==1};this._mouseclickdetectmove=function(){this.leftclick=!1};this._mouseclickdetectstop=function(){this.leftclick&&this.originalClickFunction()};
this.attachEvent=function(a,b,d,f){d||(d=this);f||(f=!1);if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){if(a=="click")this.originalClickFunction=b,this.MarkerOptions.shape?(khtml.maplib.base.helpers.eventAttach(this.area,"touchstart",this._touchclickdetectstart,d,f),khtml.maplib.base.helpers.eventAttach(this.area,"touchmove",this._touchclickdetectmove,d,f),khtml.maplib.base.helpers.eventAttach(this.area,"touchend",this._touchclickdetectstop,
d,f)):(khtml.maplib.base.helpers.eventAttach(this.marker,"touchstart",this._touchclickdetectstart,d,f),khtml.maplib.base.helpers.eventAttach(this.marker,"touchmove",this._touchclickdetectmove,d,f),khtml.maplib.base.helpers.eventAttach(this.marker,"touchend",this._touchclickdetectstop,d,f))}else if(a=="click")this.originalClickFunction=b,this.MarkerOptions.shape?(khtml.maplib.base.helpers.eventAttach(this.area,"mousedown",this._mouseclickdetectstart,d,f),khtml.maplib.base.helpers.eventAttach(this.area,
"mousemove",this._mouseclickdetectmove,d,f),khtml.maplib.base.helpers.eventAttach(this.area,"mouseup",this._mouseclickdetectstop,d,f)):(khtml.maplib.base.helpers.eventAttach(this.marker,"mousedown",this._mouseclickdetectstart,d,f),khtml.maplib.base.helpers.eventAttach(this.marker,"mousemove",this._mouseclickdetectmove,d,f),khtml.maplib.base.helpers.eventAttach(this.marker,"mouseup",this._mouseclickdetectstop,d,f))};this.init=function(a){this.owner=a;this.mapObj=a instanceof khtml.maplib.base.Map?
a:a.map;this.x=this.mapObj.latlngToXY(this.position).x;this.y=this.mapObj.latlngToXY(this.position).y;if(!this.owner.overlayDiv.markerDiv)this.owner.overlayDiv.markerDiv=document.createElement("div"),this.owner.overlayDiv.appendChild(this.owner.overlayDiv.markerDiv),this.owner.overlayDiv.markerDiv.setAttribute("id","markerDiv");if(this.shadow&&!this.owner.overlayDiv.shadowDiv)this.owner.overlayDiv.shadowDiv=document.createElement("div"),this.owner.overlayDiv.insertBefore(this.owner.overlayDiv.shadowDiv,
this.owner.overlayDiv.markerDiv),this.owner.overlayDiv.shadowDiv.setAttribute("id","shadowDiv");this.owner.overlayDiv.markerDiv.appendChild(this.marker);this.shadow&&this.owner.overlayDiv.shadowDiv.appendChild(this.shadow);this.MarkerOptions.draggable==!0?this.makeMoveable():(khtml.maplib.base.helpers.eventAttach(this.marker,"mousedown",function(){if(!this.MarkerOptions.draggable)this.clicked=!0},this,!1),khtml.maplib.base.helpers.eventAttach(this.marker,"mousemove",function(){this.MarkerOptions.draggable||
(this.clicked==!0?this._setCursor("grabbing"):this._setCursor("pointer"))},this,!1),a=navigator.userAgent.indexOf("MSIE")!=-1?this.mapObj.mapParent:window,khtml.maplib.base.helpers.eventAttach(a,"mouseup",function(){if(!this.MarkerOptions.draggable)this.clicked=!1,this._setCursor("pointer")},this,!1))};this.render=function(){if(this.marker&&this.position&&!isNaN(this.position.lat())&&!isNaN(this.position.lng())){if(this.moving)var a=this.x,b=this.y;else b=this.mapObj.latlngToXY(this.position),a=b.x,
b=b.y,this.x=a,this.y=b;if((a<-this.width||b<-this.height||a>this.mapObj.size.width+this.width||b>this.mapObj.size.height+this.height)&&!this.moving){if(this.marker.style.display="none",this.shadow)this.shadow.style.display="none"}else{this.marker.style.display="";this.marker.style.left=a-this.dx+"px";this.marker.style.top=b-this.dy+"px";if(this.shadow)this.shadow.style.display="",this.shadow.style.left=a-this.shadow.dx+"px",this.shadow.style.top=b-this.shadow.dy+"px";if(this.dragcross)this.dragcross.style.left=
a-this.dragcross.dx+"px",this.dragcross.style.top=b-this.dragcross.dy+"px";if(!this.moving&&(this.marker.style.zIndex=this.mapObj.size.height+parseInt(b),this.shadow))this.shadow.style.zIndex=parseInt(b)}if(!this.owner.overlayDiv.markerDiv)this.owner.overlayDiv.markerDiv=document.createElement("div"),this.owner.overlayDiv.appendChild(this.owner.overlayDiv.markerDiv),this.owner.overlayDiv.markerDiv.setAttribute("id","markerDiv");if(this.shadow&&!this.owner.overlayDiv.shadowDiv)this.owner.overlayDiv.shadowDiv=
document.createElement("div"),this.owner.overlayDiv.insertBefore(this.owner.overlayDiv.shadowDiv,this.owner.overlayDiv.markerDiv),this.owner.overlayDiv.shadowDiv.setAttribute("id","shadowDiv");this.marker.parentNode||this.owner.overlayDiv.markerDiv.appendChild(this.marker);this.shadow&&!this.shadow.parentNode&&this.owner.overlayDiv.shadowDiv.appendChild(this.shadow)}};this.nodeName=this.nodeType="Marker";this.geometry={};this.geometry.type="Point";this.type="Marker";this.constructor.number++;var b=
document.createElement("div");b.style.position="absolute";this.marker=b;if(a){this.MarkerOptions=a;if(a.position)this.position=a.position,this.geometry.coordinates=a.position;if(a.icon){if((typeof a.icon=="string"||typeof a.icon=="object")&&!a.icon.url)a.icon.url=a.icon;typeof a.icon.url=="object"&&(b.appendChild(a.icon.url),a.title&&b.setAttribute("title",a.title),this._setCursor("pointer"));if(typeof a.icon.url=="string"){var f=document.createElement("img");f.setAttribute("src",a.icon.url);if(a.icon.origin){if(a.icon.origin.x)f.style.left=
a.icon.origin.x;if(a.icon.origin.y)f.style.top=a.icon.origin.y}f.style.border=0;f.style.margin=0;f.style.padding=0;khtml.maplib.base.helpers.imageNotSelectable(f);b.appendChild(f);a.shape&&navigator.userAgent.indexOf("MSIE")==-1&&navigator.userAgent.indexOf("iPhone")==-1&&navigator.userAgent.indexOf("iPad")==-1?(f.setAttribute("usemap","#shapemap"+this.constructor.number),f=document.createElement("map"),f.setAttribute("id","shapemap"+this.constructor.number),f.setAttribute("name","shapemap"+this.constructor.number),
g=document.createElement("area"),g.setAttribute("shape",a.shape.type),g.setAttribute("coords",a.shape.coord),a.title&&g.setAttribute("title",a.title),g.style.cursor="pointer",g.style.display="block",f.appendChild(g),b.appendChild(f),this.area=g):(this.area=this.MarkerOptions.shape=null,a.title&&f.setAttribute("title",a.title),this._setCursor("pointer"))}a.icon.anchor?(this.dy=a.icon.anchor.y?Math.abs(parseInt(a.icon.anchor.y)):0,this.dx=a.icon.anchor.x?Math.abs(parseInt(a.icon.anchor.x)):0):this.dy=
this.dx=0;a.icon.size?(a.icon.size.width?(this.width=Math.abs(parseInt(a.icon.size.width)),b.style.width=this.width+"px",b.style.overflow="hidden"):b.style.width="auto",a.icon.size.height?(this.height=Math.abs(parseInt(a.icon.size.height)),b.style.height=this.height+"px",b.style.overflow="hidden"):b.style.height="auto"):(b.style.width="auto",b.style.height="auto");if(a.shadow){g=document.createElement("div");g.style.position="absolute";this.shadow=g;if((typeof a.shadow=="string"||typeof a.shadow==
"object")&&!a.shadow.url)a.shadow.url=a.shadow;if(a.shadow.url){this.shadow.dy=a.shadow.anchor.y?Math.abs(parseInt(a.shadow.anchor.y)):0;this.shadow.dx=a.shadow.anchor.x?Math.abs(parseInt(a.shadow.anchor.x)):0;if(a.shadow.size.width)g.style.width=Math.abs(parseInt(a.shadow.size.width))+"px",g.style.overflow="hidden";if(a.shadow.size.height)g.style.height=Math.abs(parseInt(a.shadow.size.height))+"px",g.style.overflow="hidden";if(typeof a.shadow.url=="object")g.appendChild(a.shadow.url);else if(typeof a.shadow.url==
"string")f=document.createElement("img"),f.setAttribute("src",a.shadow.url),f.style.position="absolute",f.style.left=a.shadow.origin.x?a.shadow.origin.x+"px":0,f.style.top=a.shadow.origin.y?a.shadow.origin.y+"px":0,khtml.maplib.base.helpers.imageNotSelectable(f),g.appendChild(f);this.shadow.dx=this.dx;this.shadow.dy=this.dy}}}else{g=document.createElement("div");g.style.position="absolute";this.shadow=g;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?(f=document.createElement("div"),f.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',src='"+standardmarker_shadow+"')",f.style.width="100%",f.style.height="100%"):(f=document.createElement("img"),f.setAttribute("src",standardmarker_shadow));f.style.position="absolute";f.style.left="0px";f.style.top="0px";khtml.maplib.base.helpers.imageNotSelectable(f);g.style.width="42px";g.style.height="36px";g.appendChild(f);this.shadow.dx=2;this.shadow.dy=36;navigator.userAgent.indexOf("MSIE")!=
-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(f=document.createElement("div"),f.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',src='"+standardmarker_image+"')",f.style.width="100%",f.style.height="100%"):(f=document.createElement("img"),f.setAttribute("src",standardmarker_image));f.style.border=0;f.style.margin=0;f.style.padding=0;khtml.maplib.base.helpers.imageNotSelectable(f);navigator.userAgent.indexOf("MSIE")==-1?f.setAttribute("usemap",
"#shapemap"+this.constructor.number):a&&a.title&&f.setAttribute("title",a.title);b.style.width="20px";b.style.height="36px";b.appendChild(f);if(navigator.userAgent.indexOf("MSIE")==-1&&navigator.userAgent.indexOf("iPhone")==-1&&navigator.userAgent.indexOf("iPad")==-1){f=document.createElement("map");f.setAttribute("id","shapemap"+this.constructor.number);f.setAttribute("name","shapemap"+this.constructor.number);var g=document.createElement("area");g.setAttribute("href","javascript:void(0)");g.setAttribute("shape",
standardmarker_shape.type);g.setAttribute("coords",standardmarker_shape.coord);a&&a.title&&g.setAttribute("title",a.title);g.style.cursor="pointer";g.style.display="block";f.appendChild(g);b.appendChild(f);this.area=g;this.MarkerOptions.shape={}}else this.area=this.MarkerOptions.shape=null,this._setCursor("pointer");this.dx=2;this.dy=36;b.style.width="20px";b.style.height="36px"}a.map&&a.map.addOverlay(this)}else this.MarkerOptions={},this.MarkerOptions.draggable=!1,this.dy=this.dx=0,this._setCursor("pointer")};
khtml.maplib.overlay.Marker.number=0;
navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(dragcross_image=khtml.maplib.standardimagepath+"./dragcross_nor.png",standardmarker_image=khtml.maplib.standardimagepath+"./standardmarker_nor.png",standardmarker_shadow=khtml.maplib.standardimagepath+"./standardmarkershadow_nor.png"):(dragcross_image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxMTAxQzYzNzA4MjI2ODExOERCQkMxRjgyMEJGMzlFNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxNjVGMDcwMEMxMDAxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxNjVGMDZGRkMxMDAxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjExMDFDNjM3MDgyMjY4MTE4REJCQzFGODIwQkYzOUU1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjExMDFDNjM3MDgyMjY4MTE4REJCQzFGODIwQkYzOUU1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/o5aeQAAAThJREFUeNpi8fX1ZaAEMEFpUSCWJkGfChDzwwzgBOItQHwMiHWJ0GwPxCeBeCkQM8MM+A7EclBDnPBoTgDiXUAsBNIM0gsy4B0QuwHxMiDmAeLtUIXooB2I5wMxGxB3ALEnEH+BhcEvII6GSrBBFTZC5UAuXA3EFVB1iUBcCTOVBc0WkMR9IJ4GxHVArAnFOlCXBgHxQWQNLFicOguIHwHxOiAOhYrdA2J3IL6DKxrRAQ+a3A+o8xmIMaAC6md2KH0FiLVwRTOyAbDAa0cKjzAgtoH6WxpqiAc2AySAeC80+r5D/d4BlfsIjeYFUK9tRI5mkAGK0JRlAw08ByBeg+ZSWPR1oLsUZMBTaOieAmJzKI0LVEIN+gtNueBoBJnuDxX8TkReAHnlJhCfRU4HX0jMxcdhDIAAAwCWaUA1qBZjTAAAAABJRU5ErkJggg==",standardmarker_image=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA69pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wUmlnaHRzPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvcmlnaHRzLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcFJpZ2h0czpNYXJrZWQ9IkZhbHNlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InV1aWQ6RkNCNEU4MzM0OTA4REYxMUE2MURCMjI3RURERjU5RjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTY1RjA3MDRDMTAwMTFFMDhDNzNDM0Y5QTQ5QjQ1OTgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTY1RjA3MDNDMTAwMTFFMDhDNzNDM0Y5QTQ5QjQ1OTgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0RTM3MEU5QkUxMjM2ODExOERCQkMxRjgyMEJGMzlFNSIgc3RSZWY6ZG9jdW1lbnRJRD0idXVpZDpGQ0I0RTgzMzQ5MDhERjExQTYxREIyMjdFRERGNTlGOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PthdB7IAAAZnSURBVHjalJZZbBxFGse/qu7pYy4P8cGEhERcMSTEUXAEGAVpV7yghQeQEIeMEJHyggAhAS+88AZCIISQFh6QInjgFCAedjm0SChCXhKcxCQmEEJiB40dZ/B4ZuyZnumruot/9XiC1wmLKelT9VRX/fr/HVU1TEqpEZEOs2CZZbMa1ar12b59N589dWqwUavlPccRvuuejYX4Joqi/7z27bcRXaQxAE30aVgetm6+VLrs6w8/3FMtl+/sz6abWdfReL1meK0m1Zx28IvjhvPNdoaRfCkm9vLfm3OOTyyBjf5YSoC5ZVjf+Oef33ZqYuLZazdtFINZo1fnGonKrxT8fIL8xTp5rRa5vk9VEdMRNy5NLTY51t1xc7M82QWqgRTMHvvkk5tOjo+/MDJ4VWqoJ91rcE48DIhXK6SLkIzQJxOm+oIIaCQVb9pRSOclsf9+k1u/veuyAurH9u/f8MPY2IsjW68RlxtammI4E4ZEv84RdxqkuW3SPJd0Zb5HWuDhYx5tYSK/PWcJuP8vQNd1gbT//fce37HlSm+zqduEr1NjieS5s0S1GlGzQeQ0ibsuMd8lHgTofSLPJ4n+ChkUNmXsgJN8JknKO889N/TT+Ph3Tw9vYYadYRzqCC5KqErA9RrFzSaJtkMBAK6IyMGcFqY5iLGn6bAUfekyfIUu008cPHjb5nz6DKvXr4obDZUlwkqSbQBbDhFAMdQlYwHCEKFaYkngkQQ81hBFXVKvkZmtBuJ23VlauvHyXMqMmsuwKExcYp4HUDsBkRAYDikGIIpiiqBQYG4oOYUCPcYLlmFUie3WMfHSbOBnIukRU64CwLGYIcMygYgOKBYkAAuhMAQwkowElAomk17nvk3cKuqo+rweCR4KP4HpAEgkhoURyQiwOAJIQTpKFCyAOh+9UijguvoY0xAKg7Iqy+WaiNpqcoCFQSgowLMPcGJqDMoCFHOQwDp9qKKjFAqlOib4pZJSVnt4bNqPrr1aj0jDSw2qONQReomJcRQlMVMKfcBc1SMjIVQGUuUH2w7PS3rKA+uAUvjpmXaYdsFQk9uAtAFpQWVbdPpWtGx47wHmJUB8EyYRQ5XLJa73KJZS+L0f+KcmTJNtk7Ko6oHFndkSigXUxViBZBKKBu52ekSNMKQqiM5l8nOYc+S18fGSAoLBnjjcDA712JpXQKokgg3vElN1rjKaQBPQ76aADcNqz1mZPjw/eX7roR3FwKOTzP5pnlKhg687gDoAOTGnFmAtTHDx24eFMOVmQ7fc2WxhCo+jw5XSaVo+WLvtjfm2Z8yT/uoVISv3ML0YQaIFHTrOYJkoksu6OJXTuXMlK6eUvbRrYeYjYp0zUQ+GhlYeuP80JiePzOYueavC2CVWLMxsu0Wm50bKFaxp1k27UU9ZJlwuA/YPwI6uBCQKIyHOD7hbtx54YO/e2w+++/aEVq2apdKMI1JWnUuJSSzkMv4qYPxNTB2/2BXAVw889tTT7OjhQ6Nl0y4Udt8aFTZvfL617fpNgmtXCs4HA01/5I9gq2OYtLlfzmSri0t3r9+4kQ5Ofs9i3TysxgfbDSrMz5FIp4lxltwici0KOee5RqNxnWWaZKfTNWQ8Af64Y5hqA0XsJkH/r10AdBxnyPM8u7qwQGEYTti6XlfjtXyB2nYaWQyom9E/Bd53//1GqVR6qK+vj2ZnZ3HC+x903/VqjBaGhsnpH8C94q8NmEql0rVa7W89PT2UzWZbUDrWfRcDsmha9N3wLdTK5cnG4WviwkoO5T9KShzHfYuLi8VcNqu22jTOyml8pVNOOMHVKd5MGXRs284EFuoGbT9xlCw8y25hd2GjDz7Ijx8/fq9t22xmZkaGQvzbtqzzGcAfgs4ewSHcSGdJZnIUGiZxHHOGum9WAwEy4e49fb29VJEyaFYqX6T03x0wTfOCeElszR927abkpgRvdCVQ0zQT7m5dX0RpcF5Bhg+tBIbq4l/9xwhWN9VuZ/8bw4f37GEnT568AYvMc+WyWnwgbdveqvhePK2rxhMgSoWdPn36roGBAVqs1yPXdd9aXWmZTIbW0hIgag73fH1kw4YNZNn22SAMv/TU5b6iWZa1duDU1JTactsWKhWEg70OWHhhAuTagWgjKGoX204vFouv1KrVCybu3LnzLwG39/f3H4PKj89MTwcX3VKcrwn4mwADAMJX5X8+GDAaAAAAAElFTkSuQmCC",
standardmarker_shadow="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAkCAYAAAD/yagrAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpGREJEQjUxMTUyMjQ2ODExOERCQkMxRjgyMEJGMzlFNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxNjVGMDcwOEMxMDAxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxNjVGMDcwN0MxMDAxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZEQkRCNTExNTIyNDY4MTE4REJCQzFGODIwQkYzOUU1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZEQkRCNTExNTIyNDY4MTE4REJCQzFGODIwQkYzOUU1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+aE6NVAAAAhZJREFUeNrslutugkAQhVlQvGvTS9offf93a9PGajUIsrudjWeSyQYRAds0WZKTVSHycebMLMpaG/2HQwXQABpAA2gADaABNIAG0DagSqne/rNiVeK7PGyFTic8A/sEZZiEFGMdQAkkgQ1Jk0pSQTrisz1x9g+qBFhKGpHG0AhKARzjegtQB3cg7UjfWB208Um7gjKgg5mR5qQF1gl+HwpXlQfqHM1JW9IH6Z20cQ/ggw46upgCcEW6xzqDm6mIgZ9bmc8jHqYUrpYyr21BOYdjgD2QHkl3cHFYkce6RpL5teJc1BU0BqQDfCY9kZb4Lanp8KrDoPSc0Qxudh5PCrlzZX4lvQBy5JW47uB8lgDbIJtvpDXAjd/1gxZlH6JZVlgvQVoPUKOz96QvNNEnHC1wTdS19KpmgNuaQc4O5nBxB8g1Oj5DU5lzN74W1IqSOQemohkYiOF4mB/hFM9L1l4A6qoG6tpMRtx0DmcNYErcVO44Oa7PsB7ELnQR8NpmUiKfEzE3F4DcA5zdkdtj6YEZf1+vLF2LLVSJ7XGOLl+gGgUiwDnTZ140bBO4tqC+i0sxL9nFDZzMa8rY6j2yKagSe7h0MRZ7s9+tvb7YNgGNUVbOIruo4d62gYs3B41R6ikgOYu5yCJ3rb0V5CVQJZxcAlaJUZShefQtAZuCsptjnOc5WHgdHf01aCJecrXQrwGeA/0RYACGHUt80iKakgAAAABJRU5ErkJggg==");
standardmarker_shape={coord:[13,0,15,1,16,2,17,3,18,4,18,5,19,6,19,7,19,8,19,9,19,10,19,11,19,12,19,13,18,14,18,15,17,16,16,17,15,18,13,19,8,20,8,21,8,22,7,23,7,24,7,25,7,26,6,27,6,28,6,29,5,30,5,31,5,32,4,33,4,34,3,35,1,35,1,34,1,33,1,32,1,31,1,30,2,29,2,28,2,27,3,26,3,25,3,24,4,23,4,22,4,21,4,20,5,19,4,18,3,17,2,16,1,15,1,14,0,13,0,6,1,4,2,3,3,2,4,1,6,0,13,0],type:"poly"};khtml.maplib.overlay.InfoWindowOptions=function(a,e,d,b,f){if(a)this.content=a;if(f)this.position=f};
khtml.maplib.overlay.InfoWindow=function(a){this.infobox=document.createElement("div");this.infobox.style.position="absolute";this.infobox.style.minWidth="210px";this.infobox.style.minHeight="80px";this.infobox.style.whiteSpace="nowrap";upperleftdiv=document.createElement("div");upperleftdiv.style.position="absolute";upperleftdiv.style.width="10px";upperleftdiv.style.height="10px";upperleftdiv.style.top=0;upperleftdiv.style.left=0;upperleftdiv.style.overflow="hidden";navigator.userAgent.indexOf("MSIE")!=
-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(upperleftimg=document.createElement("div"),upperleftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+corner_image+"')",upperleftimg.style.width="100%",upperleftimg.style.height="100%"):(upperleftimg=document.createElement("img"),upperleftimg.setAttribute("src",corner_image));upperleftimg.style.position="absolute";upperleftimg.style.top=0;upperleftimg.style.left=0;khtml.maplib.base.helpers.imageNotSelectable(upperleftimg);
upperleftdiv.appendChild(upperleftimg);this.infobox.appendChild(upperleftdiv);this.upperdiv=document.createElement("div");this.upperdiv.style.position="absolute";this.upperdiv.style.height="10px";this.upperdiv.style.left="10px";this.upperdiv.style.top=0;this.upperdiv.style.borderTop="1px solid gray";this.upperdiv.style.backgroundColor="white";this.infobox.appendChild(this.upperdiv);upperrightdiv=document.createElement("div");upperrightdiv.style.position="absolute";upperrightdiv.style.width="10px";
upperrightdiv.style.height="10px";upperrightdiv.style.top=0;upperrightdiv.style.right=0;upperrightdiv.style.overflow="hidden";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(upperrightimg=document.createElement("div"),upperrightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+corner_image+"')",upperrightimg.style.width="100%",upperrightimg.style.height="100%"):(upperrightimg=document.createElement("img"),
upperrightimg.setAttribute("src",corner_image));upperrightimg.style.position="absolute";upperrightimg.style.top=0;upperrightimg.style.right=0;khtml.maplib.base.helpers.imageNotSelectable(upperrightimg);upperrightdiv.appendChild(upperrightimg);this.infobox.appendChild(upperrightdiv);this.leftdiv=document.createElement("div");this.leftdiv.style.position="absolute";this.leftdiv.style.width="10px";this.leftdiv.style.top="10px";this.leftdiv.style.left=0;this.leftdiv.style.borderLeft="1px solid gray";this.leftdiv.style.backgroundColor=
"white";this.infobox.appendChild(this.leftdiv);lowerleftdiv=document.createElement("div");lowerleftdiv.style.position="absolute";lowerleftdiv.style.width="10px";lowerleftdiv.style.height="10px";lowerleftdiv.style.bottom=0;lowerleftdiv.style.left=0;lowerleftdiv.style.overflow="hidden";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(lowerleftimg=document.createElement("div"),lowerleftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
corner_image+"')",lowerleftimg.style.width="100%",lowerleftimg.style.height="100%"):(lowerleftimg=document.createElement("img"),lowerleftimg.setAttribute("src",corner_image));lowerleftimg.style.position="absolute";lowerleftimg.style.bottom=0;lowerleftimg.style.left=0;khtml.maplib.base.helpers.imageNotSelectable(lowerleftimg);lowerleftdiv.appendChild(lowerleftimg);this.infobox.appendChild(lowerleftdiv);this.rightdiv=document.createElement("div");this.rightdiv.style.position="absolute";this.rightdiv.style.width=
"10px";this.rightdiv.style.top="10px";this.rightdiv.style.right=0;this.rightdiv.style.borderRight="1px solid gray";this.rightdiv.style.backgroundColor="white";this.infobox.appendChild(this.rightdiv);lowerrightdiv=document.createElement("div");lowerrightdiv.style.position="absolute";lowerrightdiv.style.width="10px";lowerrightdiv.style.height="10px";lowerrightdiv.style.bottom=0;lowerrightdiv.style.right=0;lowerrightdiv.style.overflow="hidden";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?(lowerrightimg=document.createElement("div"),lowerrightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+corner_image+"')",lowerrightimg.style.width="100%",lowerrightimg.style.height="100%"):(lowerrightimg=document.createElement("img"),lowerrightimg.setAttribute("src",corner_image));lowerrightimg.style.position="absolute";lowerrightimg.style.bottom=0;lowerrightimg.style.right=0;khtml.maplib.base.helpers.imageNotSelectable(lowerrightimg);lowerrightdiv.appendChild(lowerrightimg);
this.infobox.appendChild(lowerrightdiv);this.lowerdiv=document.createElement("div");this.lowerdiv.style.position="absolute";this.lowerdiv.style.height="10px";this.lowerdiv.style.left="10px";this.lowerdiv.style.bottom=0;this.lowerdiv.style.borderBottom="1px solid gray";this.lowerdiv.style.backgroundColor="white";this.infobox.appendChild(this.lowerdiv);khtml.maplib.base.helpers.setCursor(this.infobox,"default");this.infobox.content=document.createElement("div");this.infobox.content.style.position="absolute";
this.infobox.content.style.backgroundColor="white";if(a.content)this.infobox.content.innerHTML=a.content;this.infobox.appendChild(this.infobox.content);this.infobox.pointer=document.createElement("div");this.infobox.pointer.style.position="absolute";this.infobox.pointer.style.bottom="0";this.infobox.pointer.style.left="0";for(var e=0;e<10;e++){el=document.createElement("div");el.style.position="absolute";el.style.overflow="hidden";el.style.cursor="default";el.style.height=pointerheight/10+1+"px";
el.style.width=pointerwidth/2+4-pointerwidth/10/2*e+2+"px";el.style.bottom=-(e+1)*pointerheight/10+"px";el.style.left=pointerwidth/2-5*e-(10-e)/2+"px";if(navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7){var d=document.createElement("div");d.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+pointer_image+"')";d.style.width="100%";d.style.height="100%"}else d=document.createElement("img"),d.setAttribute("src",
pointer_image);d.style.cursor="default";d.style.position="absolute";d.style.top=-e*pointerheight/10+"px";d.style.left=-pointerwidth/2+5*e+(10-e)/2+"px";d.style.zIndex=0;khtml.maplib.base.helpers.imageNotSelectable(d);el.appendChild(d);this.infobox.pointer.appendChild(el)}this.infobox.appendChild(this.infobox.pointer);this.closebutton=document.createElement("div");this.closebutton.style.position="absolute";navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)?
(this.closebutton.style.height="28px",this.closebutton.style.width="28px",this.closebutton.style.top="0px",this.closebutton.style.right="0px"):(this.closebutton.style.height="10px",this.closebutton.style.width="10px",this.closebutton.style.top="4px",this.closebutton.style.right="4px");this.closebutton.style.padding="0";this.closebutton.style.zIndex="10000";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?(el=document.createElement("div"),
el.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+close_image+"')",el.style.width="100%",el.style.height="100%"):(el=document.createElement("img"),el.setAttribute("src",close_image));el.style.opacity=0.6;el.style.cursor="pointer";el.style.position="absolute";navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)?(el.style.width="20px",el.style.height="20px",el.style.top="4px",el.style.right="4px"):(el.style.width="10px",
el.style.height="10px",el.style.top=0,el.style.right=0);khtml.maplib.base.helpers.imageNotSelectable(el);el.setAttribute("onmouseover","javascript:this.style.opacity='1'");el.setAttribute("onmouseout","javascript:this.style.opacity='0.6'");this.closebutton.appendChild(el);this.infobox.appendChild(this.closebutton);khtml.maplib.base.helpers.eventAttach(this.closebutton,"click",function(){this.close()},this,!1);shadow={};this.shadow=document.createElement("div");this.shadow.style.position="absolute";
this.shadow.upperleftdiv=document.createElement("div");this.shadow.upperleftdiv.style.position="absolute";this.shadow.upperleftdiv.style.width="30px";this.shadow.upperleftdiv.style.height="20px";this.shadow.upperleftdiv.style.top=0;this.shadow.upperleftdiv.style.overflow="hidden";shadow.upperleftimg=document.createElement("img");shadow.upperleftimg.style.position="absolute";shadow.upperleftimg.style.top=0;shadow.upperleftimg.style.left="-309px";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?shadow.upperleftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.upperleftimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.upperleftimg);this.shadow.upperleftdiv.appendChild(shadow.upperleftimg);this.shadow.appendChild(this.shadow.upperleftdiv);this.shadow.upperrightdiv=document.createElement("div");this.shadow.upperrightdiv.style.position="absolute";this.shadow.upperrightdiv.style.width="30px";this.shadow.upperrightdiv.style.height=
"20px";this.shadow.upperrightdiv.style.top=0;this.shadow.upperrightdiv.style.right=0;this.shadow.upperrightdiv.style.overflow="hidden";shadow.upperrightimg=document.createElement("img");shadow.upperrightimg.style.position="absolute";shadow.upperrightimg.style.top=0;shadow.upperrightimg.style.right=0;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.upperrightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
shadow_image+"')":shadow.upperrightimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.upperrightimg);this.shadow.upperrightdiv.appendChild(shadow.upperrightimg);this.shadow.appendChild(this.shadow.upperrightdiv);this.shadow.upperdiv=document.createElement("div");this.shadow.upperdiv.style.position="absolute";this.shadow.upperdiv.style.height=this.shadow.upperrightdiv.style.height;this.shadow.upperdiv.style.top=this.shadow.upperleftdiv.style.top;this.shadow.upperdiv.style.overflow=
"hidden";shadow.upperimg=document.createElement("img");shadow.upperimg.style.position="absolute";shadow.upperimg.style.top=0;shadow.upperimg.style.right="-"+this.shadow.upperrightdiv.style.width;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.upperimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.upperimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.upperimg);
this.shadow.upperdiv.appendChild(shadow.upperimg);this.shadow.appendChild(this.shadow.upperdiv);this.shadow.lowerleftdiv=document.createElement("div");this.shadow.lowerleftdiv.style.position="absolute";this.shadow.lowerleftdiv.style.height="54px";this.shadow.lowerleftdiv.style.bottom=0;this.shadow.lowerleftdiv.style.left=0;this.shadow.lowerleftdiv.style.overflow="hidden";shadow.lowerleftimg=document.createElement("img");shadow.lowerleftimg.style.position="absolute";shadow.lowerleftimg.style.bottom=
0;shadow.lowerleftimg.style.left=0;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.lowerleftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.lowerleftimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.lowerleftimg);this.shadow.lowerleftdiv.appendChild(shadow.lowerleftimg);this.shadow.appendChild(this.shadow.lowerleftdiv);this.shadow.lowerrightdiv=
document.createElement("div");this.shadow.lowerrightdiv.style.position="absolute";this.shadow.lowerrightdiv.style.height="54px";this.shadow.lowerrightdiv.style.bottom=0;this.shadow.lowerrightdiv.style.overflow="hidden";shadow.lowerrightimg=document.createElement("img");shadow.lowerrightimg.style.position="absolute";shadow.lowerrightimg.style.bottom=0;shadow.lowerrightimg.style.right="-300px";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+
5))<=7?shadow.lowerrightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.lowerrightimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.lowerrightimg);this.shadow.lowerrightdiv.appendChild(shadow.lowerrightimg);this.shadow.appendChild(this.shadow.lowerrightdiv);this.shadow.rightdiv=document.createElement("div");this.shadow.rightdiv.style.position="absolute";this.shadow.rightdiv.style.top=this.shadow.upperrightdiv.style.height;
this.shadow.rightdiv.style.right=0;this.shadow.rightdiv.style.overflow="hidden";shadow.rightimg=document.createElement("img");shadow.rightimg.style.position="absolute";shadow.rightimg.style.top="-"+this.shadow.upperrightdiv.style.height;shadow.rightimg.style.right=0;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.rightimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.rightimg.setAttribute("src",
shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.rightimg);this.shadow.rightdiv.appendChild(shadow.rightimg);this.shadow.appendChild(this.shadow.rightdiv);this.shadow.leftdiv=document.createElement("div");this.shadow.leftdiv.style.position="absolute";this.shadow.leftdiv.style.top=this.shadow.upperleftdiv.style.height;this.shadow.leftdiv.style.left=0;this.shadow.leftdiv.style.overflow="hidden";shadow.leftimg=document.createElement("img");shadow.leftimg.style.position="absolute";shadow.leftimg.style.bottom=
"-"+this.shadow.lowerleftdiv.style.height;shadow.leftimg.style.left=0;navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.leftimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.leftimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.leftimg);this.shadow.leftdiv.appendChild(shadow.leftimg);this.shadow.appendChild(this.shadow.leftdiv);this.shadow.middlediv=
document.createElement("div");this.shadow.middlediv.style.position="absolute";this.shadow.middlediv.style.top=this.shadow.upperleftdiv.style.height;this.shadow.middlediv.style.overflow="hidden";shadow.middleimg=document.createElement("img");shadow.middleimg.style.position="absolute";shadow.middleimg.style.top="-"+this.shadow.upperleftdiv.style.height;shadow.middleimg.style.left=parseInt(shadow.upperleftimg.style.left)-parseInt(this.shadow.upperleftdiv.style.height)+"px";navigator.userAgent.indexOf("MSIE")!=
-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.middleimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+shadow_image+"')":shadow.middleimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.middleimg);this.shadow.middlediv.appendChild(shadow.middleimg);this.shadow.appendChild(this.shadow.middlediv);this.shadow.pointer=document.createElement("div");this.shadow.pointer.style.position="absolute";
this.shadow.pointer.style.overflow="hidden";this.shadow.pointer.style.width="140px";this.shadow.pointer.style.height="54px";this.shadow.pointer.style.bottom=0;shadow.pointerimg=document.createElement("img");shadow.pointerimg.style.position="absolute";shadow.pointerimg.style.bottom=0;shadow.pointerimg.style.left="-255px";navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7?shadow.pointerimg.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
shadow_image+"')":shadow.pointerimg.setAttribute("src",shadow_image);khtml.maplib.base.helpers.imageNotSelectable(shadow.pointerimg);this.shadow.pointer.appendChild(shadow.pointerimg);this.shadow.appendChild(this.shadow.pointer);this.render=function(){typeof this.anchorObject=="object"?(this.xy=this.mapObj.latlngToXY(this.anchorObject.getPosition()),this.offset=this.anchorObject.pixelOffset?this.anchorObject.pixelOffset():{x:0,y:0}):a?(this.xy=a.position?this.mapObj.latlngToXY(a.position):this.mapObj.latlngToXY(this.mapObj.getCenter()),
a.pixelOffset?(this.offset.x=a.pixelOffset.x?a.pixelOffset.x:0,this.offset.y=a.pixelOffset.y?a.pixelOffset.y:0):this.offset={x:0,y:0}):this.xy=this.mapObj.latlngToXY(this.mapObj.getCenter());this.infobox.style.left=this.xy.x+this.offset.x-(this.infobox.offsetWidth-pointerwidth)/2+"px";this.infobox.style.bottom=-this.xy.y+this.offset.y+pointerheight-1+"px";this.infobox.style.zIndex=parseInt(this.xy.y)+this.mapObj.size.height;this.shadow.style.left=parseInt(this.infobox.style.left)+pointerheight/2+
"px";this.shadow.style.bottom=parseInt(this.infobox.style.bottom)-pointerheight+"px";this.shadow.style.zIndex=parseInt(this.xy.y);this.opened&&this._moveMap()};this.open=function(a,b){this.mapObj=a;this.anchorObject=b;if(!this.mapObj.overlayDiv.infoboxShadowDiv)this.mapObj.overlayDiv.infoboxShadowDiv=document.createElement("div"),this.mapObj.overlayDiv.appendChild(this.mapObj.overlayDiv.infoboxShadowDiv),this.mapObj.overlayDiv.infoboxShadowDiv.setAttribute("id","infoboxShadowDiv");this.shadow.parentNode&&
this.shadow.parentNode.removeChild(this.shadow);this.mapObj.overlayDiv.infoboxShadowDiv.appendChild(this.shadow);if(!this.mapObj.overlayDiv.infoboxDiv)this.mapObj.overlayDiv.infoboxDiv=document.createElement("div"),this.mapObj.overlayDiv.appendChild(this.mapObj.overlayDiv.infoboxDiv),this.mapObj.overlayDiv.infoboxDiv.setAttribute("id","infoboxDiv");this.infobox.parentNode&&this.infobox.parentNode.removeChild(this.infobox);this.mapObj.overlayDiv.infoboxDiv.appendChild(this.infobox);this.mapObj.addOverlay(this);
this.opened=!0;this.infobox.style.width=parseInt(this.infobox.content.offsetWidth)>parseInt(this.infobox.style.minWidth)-20?this.infobox.content.offsetWidth+20+"px":this.infobox.style.minWidth;if(parseInt(this.infobox.content.offsetWidth)>parseInt(this.mapObj.size.width)-40)this.infobox.style.width=this.mapObj.size.width-20+"px",this.infobox.style.whiteSpace="normal";if(parseInt(this.infobox.content.offsetWidth)>640)this.infobox.style.width="660px",this.infobox.style.whiteSpace="normal";this.infobox.content.style.left=
"10px";this.infobox.content.style.width=parseInt(this.infobox.style.width)-20+"px";this.infobox.style.height=parseInt(this.infobox.content.offsetHeight)>parseInt(this.infobox.style.minHeight)-20?parseInt(this.infobox.content.offsetHeight)+20+"px":this.infobox.style.minHeight;if(parseInt(this.infobox.content.offsetHeight)>parseInt(this.mapObj.size.height)-40-pointerheight-this.offset.y)this.infobox.style.height=this.mapObj.size.height-pointerheight-this.offset.y-20+"px",this.infobox.content.style.overflowY=
"scroll";this.upperdiv.style.width=parseInt(this.infobox.style.width)-20+"px";this.leftdiv.style.height=parseInt(this.infobox.style.height)-20+"px";this.rightdiv.style.height=parseInt(this.infobox.style.height)-20+"px";this.lowerdiv.style.width=parseInt(this.infobox.style.width)-20+"px";this.infobox.content.style.top="10px";this.infobox.content.style.height=parseInt(this.infobox.style.height)-20+"px";this.infobox.pointer.style.left=(this.infobox.offsetWidth-pointerwidth)/2+"px";this.shadow.style.width=
parseInt(this.infobox.style.width)+Math.floor(parseInt(this.infobox.style.height)/2)+"px";this.shadow.style.height=Math.ceil(parseInt(this.infobox.style.height)/2)+pointerheight/2+"px";this.shadow.pointer.style.left=parseInt(this.infobox.pointer.style.left)-pointerheight/2+"px";this.shadow.lowerleftdiv.style.width=this.shadow.pointer.style.left;this.shadow.upperleftdiv.style.left=Math.floor(parseInt(this.infobox.style.height)/2)-(parseInt(this.shadow.lowerrightdiv.style.height)-pointerheight/2)-9+
"px";this.shadow.lowerrightdiv.style.left=parseInt(this.shadow.pointer.style.left)+parseInt(this.shadow.pointer.style.width)+"px";this.shadow.lowerrightdiv.style.width=parseInt(this.shadow.style.width)-parseInt(this.shadow.pointer.style.left)-parseInt(this.shadow.pointer.style.width)-parseInt(this.shadow.upperleftdiv.style.left)+9+"px";this.shadow.upperdiv.style.left=parseInt(this.shadow.upperleftdiv.style.left)+parseInt(this.shadow.upperleftdiv.style.width)+"px";this.shadow.upperdiv.style.width=
parseInt(this.shadow.style.width)-parseInt(this.shadow.upperleftdiv.style.left)-parseInt(this.shadow.upperleftdiv.style.width)-parseInt(this.shadow.upperrightdiv.style.width)+"px";this.shadow.rightdiv.style.width=Math.floor(parseInt(this.infobox.style.height)/2)+"px";this.shadow.rightdiv.style.height=parseInt(this.shadow.style.height)-74+"px";this.shadow.leftdiv.style.width=Math.floor(parseInt(this.infobox.style.height)/2)+"px";this.shadow.leftdiv.style.height=parseInt(this.shadow.style.height)-74+
"px";this.shadow.middlediv.style.left=this.shadow.leftdiv.style.width;this.shadow.middlediv.style.width=parseInt(this.shadow.style.width)-parseInt(this.shadow.leftdiv.style.width)-parseInt(this.shadow.rightdiv.style.width)+"px";this.shadow.middlediv.style.height=parseInt(this.shadow.style.height)-parseInt(this.shadow.upperdiv.style.height)-parseInt(this.shadow.lowerleftdiv.style.height)+"px";khtml.maplib.base.helpers.eventAttach(this.infobox,"DOMMouseScroll",khtml.maplib.base.helpers.cancelEvent,
this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox,"dblclick",khtml.maplib.base.helpers.cancelEvent,this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox.content,"mousedown",khtml.maplib.base.helpers.cancelEvent,this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox,"mousedown",function(a){khtml.maplib.base.helpers.stopEventPropagation(a);khtml.maplib.base.helpers.cancelEvent(a)},this,!1);khtml.maplib.base.helpers.eventAttach(this.infobox.content,"contextmenu",khtml.maplib.base.helpers.cancelEvent,
this,!1);if(this.anchorObject){var d=this;this.anchorObject.position.addCallbackFunction(function(){d.render()})}this.render()};this.close=function(){if(this.infobox&&this.infobox.parentNode)try{this.mapObj.overlayDiv.infoboxDiv.removeChild(this.infobox)}catch(a){}if(this.shadow&&this.shadow.parentNode)try{this.mapObj.overlayDiv.infoboxShadowDiv.removeChild(this.shadow)}catch(b){}this.opened=!1};var b=1,f=1;this._moveMap=function(){var a=this;this.infobox.offsetLeft+this.infobox.offsetWidth>this.mapObj.size.width-
10?(this.infobox.offsetLeft+this.infobox.offsetWidth<this.mapObj.size.width?b=10-(this.mapObj.size.width-(this.infobox.offsetLeft+this.infobox.offsetWidth)):b<20&&b++,this.infobox.offsetTop<10?(this.infobox.offsetTop>0?f=10-this.infobox.offsetTop:f<20&&f++,window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-b,f)},10)):this.xy.y>this.mapObj.size.height-10?(this.xy.y<this.mapObj.size.height?f=10-(this.mapObj.size.height-this.xy.y):f<20&&f++,
window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-b,-f)},10)):(window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(-b,0)},10))):this.infobox.offsetLeft<10?(this.infobox.offsetLeft>0?b=10-this.infobox.offsetLeft:b<20&&b++,this.infobox.offsetTop<10?(this.infobox.offsetTop>0?f=10-this.infobox.offsetTop:f<20&&f++,window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(b,
f)},10)):this.xy.y>this.mapObj.size.height-10?(this.xy.y<this.mapObj.size.height?f=10-(this.mapObj.size.height-this.xy.y):f<20&&f++,window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(b,-f)},10)):(window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(b,0)},10))):this.infobox.offsetTop<10?(this.infobox.offsetTop>0?f=10-this.infobox.offsetTop:f<20&&f++,window.clearInterval(this.mapmoveInterval),
this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(0,f)},10)):this.xy.y>this.mapObj.size.height-10?(this.xy.y<this.mapObj.size.height?f=10-(this.mapObj.size.height-this.xy.y):f<20&&f++,window.clearInterval(this.mapmoveInterval),this.mapmoveInterval=window.setInterval(function(){a.mapObj.moveXY(0,-f)},10)):(window.clearInterval(this.mapmoveInterval),mapMoveSpeed=1,this.opened=!1)};this._clickdetectstart=function(a){if(a.touches.length==1)this.clickDetectY=this.clickDetectX=-1};this._clickdetectmove=
function(a){if(a.touches.length==1)this.clickDetectX=a.touches[0].pageX,this.clickDetectY=a.touches[0].pageY};this._clickdetectstop=function(a){a.touches.length==0&&this.clickDetectX==-1&&this.clickDetectY==-1&&this.close()};khtml.maplib.base.helpers.eventAttach(this.closebutton,"touchstart",this._clickdetectstart,this,!1);khtml.maplib.base.helpers.eventAttach(this.closebutton,"touchmove",this._clickdetectmove,this,!1);khtml.maplib.base.helpers.eventAttach(this.closebutton,"touchend",this._clickdetectstop,
this,!1)};var pointerwidth=90,pointerheight=70;
if(navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))<=7)var pointer_image=khtml.maplib.standardimagepath+"./pointer_nor.png",corner_image=khtml.maplib.standardimagepath+"./corners_nor.png",shadow_image=khtml.maplib.standardimagepath+"./shadow_nor.png",close_image=khtml.maplib.standardimagepath+"./close_nor.png";else pointer_image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABGCAYAAABMvIPiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowNDgwMTE3NDA3MjA2ODExOERCQkRDOEYwREVGMEUzQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNzQ4NEUxRkMwQkMxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNzQ4NEUxRUMwQkMxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkVBRjUzOEVGN0UyMDY4MTE4REJCREM4RjBERUYwRTNBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA0ODAxMTc0MDcyMDY4MTE4REJCREM4RjBERUYwRTNBIi8+IDwvcmRmOkRlc2NyaXB0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",corner_image=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpFREY1MzhFRjdFMjA2ODExOERCQkRDOEYwREVGMEUzQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCMERGRjZBNEMwQkIxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCMERGRjZBM0MwQkIxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkYxRjUzOEVGN0UyMDY4MTE4REJCREM4RjBERUYwRTNBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkVERjUzOEVGN0UyMDY4MTE4REJCREM4RjBERUYwRTNBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+qUowwgAAAgJJREFUeNqslF1kW2EYx5+T0y1ChIRxktGrfBDGOCE3vYhcHSmj7GpUu5vdjVHKbCRh097sYlezq+1mjUQJIzLKmJBQCSHycRESJRLCiIREpbL/E++ptouk69mfv/N4znl/53m/HikWi9ECWeFn8BNYhRWRP4NL8LHweTQavTZwbQHsBXygqqrD5/OR0+kkq9U6fzEYDNa73e56rVbbqlQqB0jtCfClpCsV3oc/A7QbCARIURRaplarRcVikQA/RJWv9bwcCoX0+EswGNyJRCKXFS2T3W4nt9tNk8lkI5FI3APnJ+dN+jRR2bamafQvMpvNFA6HGfwmHo9rOpDLecfTvIssFguJsR8AlRm4jcSDVWu2TLx5Ho/Hj1Bj4KbX6yWjEoxNBqp8NIxKMFSTLMvKbXZ1lWw2Gz8emiRJov8hwZFN0+n093g8NgwcjUb86PEannY6HcNAwThlYLrRaBgGCkaagUelUqlvpEqGNZvNGsITBvLk9/mi30XoQJRMJi8QvkKTuNDv8tdyufwpm83ScDi8NazX61Eul+PwLWAnN7vND0z7vFAobOBcyi6Xayksn89TKpUaoT++BOzjogbLZb+Hv2cymW/tdvuR3+8nh8Mx742z2WxeUb/fp3q9zuv2C98+B6y1qmNX4EC1Wt2CnyJ2w4/FD8swL35a+C/9EWAAn8a43yIKi2QAAAAASUVORK5CYII=",
shadow_image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA90AAAF0CAYAAAA+QlqJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTVGMzFDQzlDMEQ3MTFFMDhDNzNDM0Y5QTQ5QjQ1OTgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTVGMzFDQzhDMEQ3MTFFMDhDNzNDM0Y5QTQ5QjQ1OTgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmRpZDo1QUJFM0JCQjU5MjA2ODExOTEwOUY4MjY5NjY1RDIxRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1QUJFM0JCQjU5MjA2ODExOTEwOUY4MjY5NjY1RDIxRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnYug9wAABhFSURBVHja7N2LUhs7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",
close_image="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowOTgwMTE3NDA3MjA2ODExOERCQkRDOEYwREVGMEUzQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNzQ4NEUyM0MwQkMxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNzQ4NEUyMkMwQkMxMUUwOEM3M0MzRjlBNDlCNDU5OCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA5ODAxMTc0MDcyMDY4MTE4REJCREM4RjBERUYwRTNBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjA5ODAxMTc0MDcyMDY4MTE4REJCREM4RjBERUYwRTNBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jr2YPQAAAUVJREFUeNpitLe3Z6AmYMIhzk+EXiFiDewF4pNALIHHMDkgPgPE0wgZ2AXERUCsDsQHcBgKMuwwECsCcSYQT8ZlYDsQlyLxYYZKI4kpQg2TQxLLAeIJ6AbCbEMHIEP3Qg1VwWIYDMRCzYAbeB+I3YD4Iw5Dj0ENk8Yi/xqInaFmoHj5FFTiI45wk8BhmAMQX8AVKWehhr4jItm8gBp2jVCyOYvHpXgNw5ewCYH/QPyd2IRtDI1ZfLlFEikt4jXQEmqYEBGulIOmU0VcBoIM247DZU+gMYov16AYCHLRLhyG3QFiC2gkvMAiLw01VAjZQFAyKcCi+CbUoKfQGMVl6CxYUkP28lwgTkHiX0MyDJsFMNAExWDAgmYTyFBmIM6HpsUXOFztDI08kPp6ZElGHCU2GxD/IqKAfUdswv5FRLLBmj0BAgwAom1FkjBGocAAAAAASUVORK5CYII=";khtml.maplib.overlay.SimpleMarker=function(a,e,d){this.nodeName=this.nodeType="Marker";this.geometry={};this.geometry.coordinates=a;this.geometry.type="Point";this.type="Marker";var b=document.createElement("div");b.appendChild(e);b.style.position="absolute";d?(d.dy?b.style.top=typeof d.dy=="number"?d.dy+"px":d.dy:b.style.left=typeof d.dx=="number"?d.dx+"px":d.dx,b.style.left=d.dx?d.dx:"0px"):(b.style.top="0px",b.style.left="0px");var f=document.createElement("div");f.style.position="absolute";f.appendChild(b);
this.marker=f;this.point=a;this.options=d;this.el=e;this.init=function(a){this.style=this.marker.style;this.marker.owner=this;this.mapObj=a instanceof khtml.maplib.base.Map?a:a.map;a.overlayDiv.appendChild(this.marker)};this.render=function(){if(this.mapObj&&this.marker&&this.point&&!isNaN(this.point.lat())&&!isNaN(this.point.lng())){var a=this.mapObj.latlngToXY(this.geometry.coordinates);a.x<0||a.y<0?this.marker.style.display="none":(this.marker.style.display="",this.marker.style.left=a.x+"px",this.marker.style.top=
a.y+"px");this.marker.parentNode||this.owner.overlayDiv.appendChild(this.marker)}};this.position=function(a){if(a)this.point=a,this.render();return this.point};this.clear=function(){if(this.marker&&this.marker.parentNode)try{this.owner.overlayDiv.removeChild(this.marker)}catch(a){}};this.moveable=function(a){(this.enabled=a)?(this.downevent=khtml.maplib.base.helpers.eventAttach(this.marker,"mousedown",this.down,this,!1),this.moveevent=khtml.maplib.base.helpers.eventAttach(window,"mousemove",this.move,
this,!0),this.upevent=khtml.maplib.base.helpers.eventAttach(window,"mouseup",this.up,this,!0)):(khtml.maplib.base.helpers.eventRemove(this.downevent),khtml.maplib.base.helpers.eventRemove(this.moveevent),khtml.maplib.base.helpers.eventRemove(this.upevent))};this.moving=!1;this.dy=this.dx=0;this.down=function(a){this.moving=!0;this.dx=this.marker.offsetLeft-this.mapObj.pageX(a);this.dy=this.marker.offsetTop-this.mapObj.pageY(a)};this.move=function(a){if(this.moving){var b=this.mapObj.pageX(a)+this.dx,
d=this.mapObj.pageY(a)+this.dy;this.point.lat(this.mapObj.XYTolatlng(b,d).lat());this.point.lng(this.mapObj.XYTolatlng(b,d).lng());this.render();a.stopPropagation()}};this.up=function(){this.moving=!1}};khtml.maplib.overlay.WMS=function(a){this.type="Feature";this.geometry={};this.geometry.type="WMS";this.options=a;this.delayTimeout=null;this.init=function(a){this.owner=a;this.map=this.owner.map instanceof khtml.maplib.Map?this.owner.map:a;this.img=document.createElement("img");this.div=document.createElement("div");this.div.style.opacity=0.6;a=this.map.bounds().getCenter();var b=-this.map.size.width/2,f=-this.map.size.height/2;this.div.appendChild(this.img);this.img.style.position="absolute";this.img.style.top=
f+"px";this.img.style.left=b+"px";this.marker=new khtml.maplib.overlay.Marker(a,this.div);this.map.featureCollection.appendChild(this.marker)};this.oldZoom=0;this.clear=function(){e.marker.style.display="none";e.map.featureCollection.removeChild(e.marker)};this.render=function(){if(map.finalDraw){this.marker.geometry.coordinates=this.map.bounds().getCenter();var a=this.map.bounds().sw().lat(),b=this.map.bounds().ne().lat(),f=this.map.bounds().sw().lng(),e=this.map.bounds().ne().lng(),c=this.map.size.width,
k=this.map.size.height,h="",l;for(l in this.options.layers)h+=this.options.layers[l]+",";h=h.substring(0,h.length-1);this.img.setAttribute("src",this.options.url+"?SERVICE=WMS&REQUEST=GetMap&VERSION=1.1.0&FORMAT="+(this.options.parameters.FORMAT?this.options.parameters.FORMAT:"image/png")+"&SRS=EPSG%3A4326&TILED=false&LAYERS="+h+"&BBOX="+f+","+a+","+e+","+b+"&WIDTH="+c+"&HEIGHT="+k);this.img.style.display="none";khtml.maplib.base.helpers.eventAttach(this.img,"load",this._imgLoaded,this.marker,!1)}else{if(this.oldZoom!=
this.map.zoom())this.marker.style.display="none";this.oldZoom=this.map.zoom()}};var e=this;this._imgLoaded=function(){this.render();this.marker.style.display="";e.img.style.display=""}};khtml.maplib.overlay.GroundOverlay=function(a,e,d){this.geometry={};this.geometry.type="GroundOverlay";this.type="Feature";this._createRenderElement=function(){var a=document.createElement("div");a.appendChild(this.el);a.style.position="absolute";a.style.top="0px";a.style.left="0px";if(this.options){if(this.options.dy)a.style.top=this.options.dy;if(this.options.dx)a.style.left=this.options.dx}return a};this._calcImageSize=function(){var a=this.map.latlngToXY(this.bbox.sw()),d=this.map.latlngToXY(this.bbox.ne()),
e=this.map.latlngToXY(this.bbox.nw());dx=d.x-a.x;dy=a.y-d.y;this.renderElement.style.width=dx;this.renderElement.style.height=dy;this.renderElement.style.left=e.x+"px";this.renderElement.style.top=e.y+"px";if((a=this.renderElement.getElementsByTagName("img")[0])&&a.tagName=="IMG")a.width=dx,a.height=dy};this.init=function(a){this.owner=a;this.map=a instanceof khtml.maplib.base.Map?a:a.map;khtml.maplib.base.helpers.rotate(this.renderElement,this.rotation*-1)};this.render=function(){this.renderElement&&
this.point&&!isNaN(this.point.lat())&&!isNaN(this.point.lng())&&this.map&&(null==this.renderElement.parentNode&&this.owner.overlayDiv.appendChild(this.renderElement),this._calcImageSize())};this.bounds=function(){if(this.rotation){khtml.maplib.base.Log.log("lng: "+this.bbox.sw().lng()+"; lat:"+this.bbox.sw().lat());var a=this._transformPoint(this.bbox.sw());khtml.maplib.base.Log.log("lng: "+a.lng()+"; lat:"+a.lat());var d=this._transformPoint(this.bbox.se()),e=this._transformPoint(this.bbox.ne()),
c=this._transformPoint(this.bbox.nw()),k=Math.min(a.lng(),d.lng(),e.lng(),c.lng()),h=Math.min(a.lat(),d.lat(),e.lat(),c.lat()),l=Math.max(a.lng(),d.lng(),e.lng(),c.lng());a=Math.max(a.lat(),d.lat(),e.lat(),c.lat());khtml.maplib.base.Log.log("in bounds");return new khtml.maplib.geometry.Bounds(new khtml.maplib.LatLng(h,k),new khtml.maplib.geometry.Point(a,l))}else return this.bbox};this._transformPoint=function(a){var d=this.bbox.getCenter(),e=d.lng();d=d.lat();var c=this.rotation*Math.PI/180;khtml.maplib.base.Log.log("theta: "+
c);khtml.maplib.base.Log.log("rotation: "+this.rotation);var k=a.lng();a=a.lat();a=new khtml.maplib.LatLng(d-(k-e)*Math.sin(c)+(a-d)*Math.cos(c),e+(k-e)*Math.cos(c)+(a-d)*Math.sin(c));e=new khtml.maplib.overlays.Marker(a,"http://www.din-5008-richtlinien.de/bilder/punkt.gif",{dx:-1,dy:-1});map.addOverlay(e);return a};this.position=function(a){if(a)this.point=a;return this.point};this.clear=function(){};this.makeMoveable=function(){khtml.maplib.base.helpers.eventAttach(this.renderElement,"mousedown",
this.down,this,!1);khtml.maplib.base.helpers.eventAttach(window,"mousemove",this.move,this,!0);khtml.maplib.base.helpers.eventAttach(window,"mouseup",this.up,this,!0)};this.moving=!1;this.dy=this.dx=0;this.down=function(a){this.moving=!0;this.dx=this.renderElement.offsetLeft-this._map.pageX(a);this.dy=this.renderElement.offsetTop-this._map.pageY(a)};this.move=function(a){if(this.moving){var d=this._map.pageX(a)+this.dx,e=this._map.pageY(a)+this.dy;this.point=this._map.XYTolatlng(d,e);this.render();
a.stopPropagation()}};this.up=function(){this.moving=!1};this.options=d;this.el=e;this.bbox=a;this.point=this.bbox.nw();if(d!=void 0&&d.rotation!=void 0)this.rotation=d.rotation;this.renderElement=this._createRenderElement()};khtml.maplib.overlay.FeatureCollection=function(){this.type="Feature";this.className={};this.realLayer=!1;this.properties={};this.geometry={};this.geometry.type="FeatureCollection";this.features=[];this.overlayDiv=document.createElement("div");this.overlayDiv.setAttribute("kazalabas","eluag");this.style={};this.init=function(a){this.owner=a;if(a instanceof khtml.maplib.base.Map)this.map=a,this.overlayDiv.parentNode||this.map.overlayDiv.appendChild(this.overlayDiv);else if(a.map)this.map=a.map,this.overlayDiv.parentNode||
this.owner.overlayDiv.appendChild(this.overlayDiv);else return;if(this.owner&&this.owner.backend)this.backend=this.owner.backend;this.vectorEl=this.makeVectorLayer(this.backend);for(var e in this.features)this.features[e].map||(a=this.features[e],a.type=="Marker"?a.init(this):a.geometry.type=="FeatureCollection"||a.geometry.type=="GroundOverlay"?a.init(this):(this.vectorLayer.createPolyline(a),this.vectorLayer.render(a)),this.extendBBox(a));this.owner&&this.owner.extendBBox&&this.owner.extendBBox(this)};
this.makeVectorLayer=function(){if(!this.vectorLayer){if(this.owner&&(this.vectorLayer=new khtml.maplib.overlay.Vector(this.backend),this.map)){vectorEl=this.owner.vectorLayer&&!this.realLayer?this.vectorLayer.init(this,this.owner):this.vectorLayer.init(this);for(var a in this.style){var e=this.style[a];this.vectorLayer.backend!="canvas"&&(vectorEl.style[a]=e)}if(this.vectorLayer.backend!="canvas")this.style=vectorEl.style}return vectorEl}};this.renderbackend=function(a){this.vectorLayer&&this.vectorLayer.remove();
this.owner.backend=a;this.init(this.owner)};this.oldStyleDisplay=null;this.render=function(){this.vectorLayer.backend=="canvas"&&this.realLayer&&this.vectorLayer.clear();this.vectorLayer.backend=="vml"&&this.realLayer&&this.vectorLayer.clear();for(var a=0;a<this.features.length;a++)this.features[a]&&(this.features[a].geometry.type=="Point"&&this.features[a].render(),this.features[a].geometry.type=="GroundOverlay"&&this.features[a].render());this.vectorLayer&&this.vectorLayer.render();if(this.oldStyleDisplay!=
null)this.style.display=this.oldStyleDisplay;this.oldStyleDisplay=null};this.clear=function(){if(this.oldStyleDisplay==null)this.oldStyleDisplay=this.style.display,this.style.display="none";for(var a=0;a<this.features.length;a++)this.features[a].type=="Marker"&&this.features[a].clear(),this.features[a].geometry.type=="FeatureCollection"&&!this.realLayer&&this.features[a].clear()};this.removeChild=function(a){var e=!1,d;for(d in this.features)this.features[d]==a&&(this.features.splice(d,1),e=!0);return e?
(delete a.owner,this.owner&&this.render(),!0):!1};this.appendChild=function(a){a.owner&&a.owner.removeChild(a);this.features.push(a);if(a.geometry)a.owner=this,a.geometry.type!=="Point"&&a.geometry.type!=="FeatureCollection"&&a.geometry.type!=="GroundOverlay"?this.vectorLayer&&(this.vectorLayer.createPolyline(a),this.vectorLayer.render(a)):a.owner.map&&(a.init(this),a.render()),this.extendBBox(a),this.owner&&this.owner.extendBBox&&this.owner.extendBBox(a)};this.extendBBox=function(a){if(a=a.point?
a.point:a.bbox)this.bbox=khtml.maplib.base.helpers.extendBBox(this.bbox,a)}};var lastStrokeStyle=null,lastFillStyle=null,lastGlobalCompositeOperation="source-over";
khtml.maplib.overlay.renderer.Canvas={_renderPath:function(a,e,d,b,f,g){if(!b.styler)b.styler=new khtml.maplib.overlay.renderer.Styler;var c=b.styler.makeCanvasStyle(e),k=e.geometry.type,h=0,l=0,o=!1;c.globalCompositeOperation=k=="Polygon"&&g>1&&f>0?"destination-out":"source-over";c.globalCompositeOperation=="source-over"&&lastGlobalCompositeOperation=="source-over"&&c.strokeStyle==lastStrokeStyle&&c.fillStyle==lastFillStyle||(d.fill(),d.stroke(),d.beginPath());lastStrokeStyle=c.strokeStyle;lastFillStyle=
c.fillStyle;lastGlobalCompositeOperation=c.globalCompositeOperation;d.strokeStyle=c.strokeStyle;d.fillStyle=c.fillStyle;d.lineWidth=c.lineWidth;d.globalCompositeOperation=c.globalCompositeOperation;for(f=0;f<a.length;f++)a[f]instanceof khtml.maplib.geometry.LatLng?(o=!0,l++,c=b.latlngToXY(a[f]),f==0?d.moveTo(c.x,c.y):d.lineTo(c.x,c.y)):(g?g++:g=1,c=this._renderPath(a[f],e,d,b,f,g),h+=c.lines,l+=c.points);(k=="Polygon"||k=="MultiPolygon"||k=="LinearRing")&&d.closePath();o&&h++;return{points:l,lines:h}}};khtml.maplib.overlay.renderer.SVG={_renderSetStyles:function(){},_renderInitPolyline:function(a){var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.polyline=a;if(a.className!=null&&a.className.baseVal)navigator.userAgent.indexOf("Konqueror")==-1?e.className.baseVal=a.className.baseVal:e.className=a.className.baseVal,e.polyline=a;a.className=e.className;a.id!=null&&e.setAttribute("id",a.id);for(var d in a.events)khtml.maplib.base.helpers.eventAttach(e,d,a.events[d],this,!1);for(var b in a.style)e.style[b]=
a.style[b];a.style=e.style;return e},_calculatePath:function(a,e,d){for(var b="",f=0,g=0,c=0;c<a.length;c++)if(a[c]instanceof khtml.maplib.geometry.LatLng){g++;var k=d.latlngToXY(a[c]);b+=c==0?"M"+k.x+","+k.y:" L"+k.x+","+k.y}else k=this._calculatePath(a[c],e,d),f+=k.lines,g+=k.points,b+=" "+k.d;f++;if(e=="Polygon"||e=="MultiPolygon"||e=="LinearRing")b+=" z";return{d:b,points:g,lines:f}}};khtml.maplib.overlay.renderer.VML={_renderSetStyles:function(){},_renderInitPolyline:function(){this._path=document.createElement("v:polyline");this._path.setAttribute("fillcolor",this._fill);this._path.setAttribute("strokecolor",this._stroke);this._path.setAttribute("strokeweight",this._strokeWidth+"px")},_calculatePath:function(a,e,d){for(var b="",f=0,g=0,c=null,k=0;k<a.length;k++)if(a[k]instanceof khtml.maplib.geometry.LatLng){g++;var h=d.latlngToXY(a[k]),l=parseInt(h.x),o=parseInt(h.y);k==0?(c=
h,b+="M"+l+" "+o):(k==1&&(b+=" L"),b+=" "+l+","+o)}else{var m=this._calculatePath(a[k],e,d);f+=m.lines;g+=m.points;b+=" "+m.d}f++;if(!c&&m&&m.startpoint)c=m.startpoint;if(c){if(e=="Polygon"||e=="MultiPolygon"||e=="LinearRing")b+=" "+parseInt(c.x)+","+parseInt(c.y);return{d:b,points:g,lines:f,startpoint:c}}else return!1}};khtml.maplib.overlay.renderer.Styler=function(){function a(a,f){if(a.search(/^rgb\(/)!=-1){khtml.maplib.base.Log.log("test1");var g;g=a.replace("rgb(","rgba(");return g=g.replace(")",","+f+")")}a[0]!="#"&&(a=="none"?(a="000000",f=0):a="#"+e[a]);g="rgba(";a.charAt(0)=="#"&&(a=a.substr(1));a.length==3&&(a=a.charAt(0)+a.charAt(0)+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2));a=a.toUpperCase();var c=0;for(i=0;i<a.length;i++){var k;for(j=0;j<d.length;j++)if(a.charAt(i)==d[j]){k=j;break}i%2==0?c=k*16:
(c+=k,g+=i==a.length-1?c+","+f+")":c+", ")}return g}this.classes=[];this.makeCanvasStyle=function(a){if(a.canvasStyle&&!a.owner.map.finalDraw)return a.canvasStyle;for(var d=a,e=null,c=[],k=a.style;d.owner;)c.push(d),d=d.owner;for(d=c.length-1;d>=0;d--){var h=c[d];if(h.className){this.classes[h.className.baseVal]||(this.classes[h.className.baseVal]=this.getCssStyles(h.className.baseVal));var l=this.classes[h.className.baseVal];e=e?this.mergeStyles(l,e):l;h.style&&(e=this.mergeStyles(h.style,e))}}e&&
(e=this.mergeStyles(k,e));if(a.geometry.type!="Polygon"&&a.geometry.type!="MultiPolygon")e.fillOpacity=0;e=this.cssToCanvas(e);return a.canvasStyle=e};this.mergeStyles=function(a,d){var e={},c;for(c in a)e[c]=a[c];e.opacity?d.opacity!=void 0&&(e.opacity*=d.opacity):e.opacity=d.opacity;e.fillOpacity?d.fillOpacity!=void 0&&(e.fillOpacity*=d.fillOpacity):e.fillOpacity=d.fillOpacity;e.strokeOpacity?d.strokeOpacity!=void 0&&(e.strokeOpacity*=d.strokeOpacity):e.strokeOpacity=d.strokeOpacity;if(!e.stroke)e.stroke=
d.stroke;if(!e.fill)e.fill=d.fill;if(!e.strokeWidth)e.strokeWidth=parseFloat(d.strokeWidth);e.strokeWidth=parseFloat(e.strokeWidth);return e};this.rgba=[];this.cssToCanvas=function(b){if(!b.stroke)b.stroke="none";if(!b.fill)b.fill="black";if(b.opacity==void 0)b.opacity=1;if(b.strokeOpacity==void 0)b.strokeOpacity=1;if(b.fillOpacity==void 0)b.fillOpacity=1;if(!b.strokeWidth)b.strokeWidth=1;if(b.stroke){var d=b.opacity*b.strokeOpacity,e=b.stroke+"X"+d;this.rgba[e]||(this.rgba[e]=a(b.stroke,d));e=b.stroke;
var c=d,k=this.rgba[b.stroke+"_"+d]}if(b.fill){d=b.opacity*b.fillOpacity;this.rgba[b.fill+"_"+d]||(this.rgba[b.fill+"_"+d]=a(b.fill,d));var h=b.fill,l=d;d=this.rgba[b.fill+"_"+d]}else h=0,l=1,d=0;return{strokeStyle:k,fillStyle:d,lineWidth:b.strokeWidth,fillRGB:h,strokeRGB:e,fillOpacity:l,strokeOpacity:c}};this.getCssStyles=function(a){for(var d={},e=0;e<document.styleSheets.length;e++){var c=document.styleSheets[e];c=c.cssRules?c.cssRules:c.rules;for(r=0;r<c.length;r++){var k=c[r].style.cssText;selectorText=
c[r].selectorText;if(selectorText=="."+a){k=k.split(";");for(var h=0;h<k.length;h++){var l=k[h].split(":");if(l.length>1){var o=l[0].replace(/^\s/,"");l=l[1].replace(/^\s/,"");if(o=="stroke")d.stroke=l;if(o=="fill")d.fill=l;if(o=="stroke-width")d.strokeWidth=parseFloat(l);if(o=="opacity")d.opacity=parseFloat(l);if(o=="fill-opacity")d.fillOpacity=parseFloat(l);if(o=="stroke-opacity")d.strokeOpacity=parseFloat(l)}}}}}return d};var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",
azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",
darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",
khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",
mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",
peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",
white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},d=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"]};khtml.maplib.parser.MapCSS=function(){function a(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}this.size="width:16px;height:16px;";this.mapcss=document.styleSheets[0]?document.styleSheets[0]:document.createStyleSheet("dyn css","projection,tv,screen");this.parse=function(e){var d=0,b="";e=("__"+e+"__").split("");var f={singleQuote:!1,doubleQuote:!1,regex:!1,blockComment:!1,lineComment:!1,condComp:!1},g=0;for(b=e.length;g<b;g++)if(f.regex){if(e[g]==="/"&&e[g-1]!=="\\")f.regex=!1}else if(f.singleQuote){if(e[g]===
"'"&&e[g-1]!=="\\")f.singleQuote=!1}else if(f.doubleQuote){if(e[g]==='"'&&e[g-1]!=="\\")f.doubleQuote=!1}else if(f.blockComment){if(e[g]==="*"&&e[g+1]==="/")e[g+1]="",f.blockComment=!1;e[g]=""}else if(f.lineComment){if(e[g+1]==="\n"||e[g+1]==="\r")f.lineComment=!1;e[g]=""}else if(f.condComp){if(e[g-2]==="@"&&e[g-1]==="*"&&e[g]==="/")f.condComp=!1}else if(f.doubleQuote=e[g]==='"',f.singleQuote=e[g]==="'",e[g]==="/")e[g+1]==="*"&&e[g+2]==="@"?f.condComp=!0:e[g+1]==="*"?(e[g]="",f.blockComment=!0):e[g+
1]==="/"?(e[g]="",f.lineComment=!0):f.regex=!0;e=e.join("").slice(2,-2);var c=e.split(/\r\n|\r|\n/);e=[];for(f=0;f<c.length;f++)g=!1,b=a(c[f]).split(/{/),b[1]&&(g=b[1].split(/}/)[0],b="",g&&(e[d]=b+c[f],d++));for(f=0;f<e.length;f++)if(b=e[f].split(/{/),b[1]){g=a(b[1].split(/}/)[0]);d=b[0];selectors=d.split(",");newstring="";for(b=0;b<selectors.length;b++){c=newstring;var k=selectors[b],h=k.split("["),l=h[0].split("|");l[1]&&(l=l[1],l=l.substring(1,l.length),l.split("-"),l.split("-")[1]&&l.split("-"));
l=h[0].substring(0,4)=="node"?"div.osm_marker":"path";for(var o=1;o<h.length;o++){var m=h[o],p=m.split("]")[0];p=p.split("|")[0];m=m.split("]")[1].split(":");p=p.replace(":","_");m=/[0-9a-zA-Z=_]*/;m=/^[0-9a-zA-Z=_]*$/;m.test(p)&&(l+="[mapcss_"+p+"]")}if((m=k.split(":"))&&m[1])m[1]=a(m[1]),m[1]=="hover"&&(l+=" :"+m[1],console.log(l));newstring=c+(l+",")}b=newstring=newstring.substring(0,newstring.length-1);g=g.split(";");c="";for(k=0;k<g.length;k++)if(h="",l=g[k])o=l.split(":"),o[1]&&(l=a(o[0]),o=
a(o[1]),l=="fill-color"&&(l="fill"),l=="color"&&(l="stroke"),l=="width"&&(l="stroke-width"),l=="icon-image"&&(l="background-image",o="url("+o+")",h="width:16px;height:16px;"),c+=l+":"+o+";"+h);g=c;c=1;k=18;d=d.split("[")[0];if(d.split("|").length>0&&(d=d.split("|")[1]))d=d.substring(1,d.length),d=d.split("-")[0],c=d[0],d[1]&&(k=d[1]);for(d=c;d<=k;d++)if(b!="path"&&b!="div"){h=".z"+d+" "+b+" {"+g+"}";if(c!=1||k!=18)h=".z"+d+" "+b+" {"+g+"}";else{h=b+" {"+g+"}";this.mapcss.insertRule(h,0);break}this.mapcss.insertRule(h,
0)}}}};khtml.maplib.parser.Osm=function(){this.featureCollection=new khtml.maplib.overlay.FeatureCollection;this.nodes=[];this.ways=[];this.data=function(){return this.featureCollection};this.add=function(a){for(var e=a.getElementsByTagName("node"),d=0;d<e.length;d++){var b=e[d],f=b.getAttribute("id");if(!this.nodes[f]){var g=b.getElementsByTagName("tag");b=new khtml.maplib.LatLng(b.getAttribute("lat"),b.getAttribute("lon"));this.nodes[f]=b;f=document.createElement("div");if(g.length>0){var c=new khtml.maplib.overlay.Marker(b,
f);c.properties={};for(b=0;b<g.length;b++){var k=g[b],h=k.getAttribute("k");k=k.getAttribute("v");f.setAttribute("mapcss_"+h,k);c.properties[h]=k}f.className="osm_marker";this.featureCollection.appendChild(c)}}}a=a.getElementsByTagName("way");for(e=0;e<a.length;e++)if(g=a[e],f=g.getAttribute("id"),!this.ways[f]){d=new khtml.maplib.geometry.Feature("MultiLineString");d.close=!0;d.id=f;b=g.getElementsByTagName("nd");for(h=0;h<b.length;h++)k=b[h].getAttribute("ref"),this.nodes[k]!=void 0&&d.geometry.coordinates.push(this.nodes[k]);
g=g.getElementsByTagName("tag");for(b=0;b<g.length;b++)if(k=g[b],h=k.getAttribute("k"),k=k.getAttribute("v"),d.properties[h]=k,h=="name")d.text.value=k,d.text.style.fill="black",d.text.style.fontSize="12",d.text.style.textAnchor="middle";this.featureCollection.appendChild(d);this.ways[f]=d}}};khtml.maplib.parser.Gpx=function(a){this.parse=function(){for(var a=[],d=this.dom.getElementsByTagName("trkseg"),b=0;b<d.length;b++){for(var f=[],g=d.item(b).getElementsByTagName("trkpt"),c=0;c<g.length;c++){var k=g.item(c),h=parseFloat(k.getAttribute("lat"));k=parseFloat(k.getAttribute("lon"));f.push([k,h])}a.push(f)}return new khtml.maplib.geometry.Feature({type:"MultiLineString",coordinates:a})};this.setDom=function(a){this.dom=typeof a=="string"?khtml.maplib.base.helpers.parseXml(a):a};this.setDom(a);
return this.parse()};khtml.maplib.parser.Kml=function(a){function e(a){var b=parseInt(a.substring(0,2),16)/256,f=parseInt(a.substring(2,4),16),e=parseInt(a.substring(4,6),16);a=parseInt(a.substring(6,8),16);return"rgba("+f+","+e+","+a+","+b+")"}this.parsed=null;this.styles=[];this.parse=function(a){if(a||null==this.parsed){if(!this.dom)return!1;if(this.dom.hasChildNodes)this.parsed=this.parseNode(this.dom.documentElement)}return this.parsed};this.parseNode=function(a){if(!a)return!1;var b=null,f=null;switch(a.nodeName){case "xml":case "#document":if(khtml.maplib.base.helpers.isIE()&&
a.childNodes.length>1)return this.parseNode(a.childNodes[1]);return this.parseNode(a.childNodes[0]);case "kml":return this.parseNode(a.getElementsByTagName("*").item(0));case "Document":b=this.parseDocument(a);break;case "Folder":"Folder"==a.nodeName&&(f=this.parseFolder(a));null==b?b=f:b.appendChild(f);break;case "Placemark":b.appendChild(this.parsePlacemark(a));break;case "GroundOverlay":null==b&&(b=new khtml.maplib.overlay.FeatureCollection),b.appendChild(this.parseGroundOverlay(a))}return b};
this.parseFolder=function(a){for(var b=new khtml.maplib.overlay.FeatureCollection,f=0;f<a.childNodes.length;f++)switch(a.childNodes[f].nodeName){case "name":b.properties.name=a.childNodes[f].childNodes[0].nodeValue;break;case "visibility":b.visible(parseInt(a.childNodes[f].childNodes[0].nodeValue)==1);break;case "description":b.properties.description=a.childNodes[f].childNodes[0].nodeValue;break;case "Folder":b.appendChild(this.parseFolder(a.childNodes[f]));break;case "Placemark":b.appendChild(this.parsePlacemark(a.childNodes[f]));
break;case "GroundOverlay":b.appendChild(this.parseGroundOverlay(a.childNodes[f]))}return b};this.parseDocument=function(a){for(var b=new khtml.maplib.overlay.FeatureCollection,f=0;f<a.childNodes.length;f++)if(a.childNodes[f].nodeType==1)switch(a.childNodes[f].nodeName){case "name":b.name=a.childNodes[f].childNodes[0].nodeValue;break;case "open":b.attribute("open",a.childNodes[f].childNodes[0].nodeValue);break;case "visibility":b.visible(parseInt(a.childNodes[f].childNodes[0].nodeValue)==1);break;
case "description":b.properties.description=a.childNodes[f].childNodes[0].nodeValue;break;case "Style":this.parseStyle(a.childNodes[f]);break;case "Folder":b.appendChild(this.parseFolder(a.childNodes[f]));break;case "GroundOverlay":b.addContent(this.parseGroundOverlay(a.childNodes[f]),!0);break;case "Placemark":var e=this.parsePlacemark(a.childNodes[f]);(e.type=="Feature"||e.type=="Marker")&&b.appendChild(e)}return b};this.parseStyle=function(a){if(!a)return!1;var b=a.getAttribute("id");this.styles[b]||
(this.styles[b]=[]);for(var f=0;f<a.childNodes.length;f++){var g=a.childNodes[f];if(g.nodeType==1){var c={};c.fill="none";c.stroke="rgba(255,0,0,0.48828125)";c.strokeWidth=3;this.styles[b][c.tagName]=c;for(var k=0;k<g.childNodes.length;k++)if(g.childNodes[k].nodeType==1){var h=g.childNodes[k].tagName;if(g.childNodes[k].firstChild)switch(h){case "color":if(g.nodeName=="LineStyle")c.stroke=e(g.childNodes[k].firstChild.nodeValue);if(g.nodeName=="PolyStyle")c.fill=e(g.childNodes[k].firstChild.nodeValue);
break;case "width":if(g.nodeName=="LineStyle")c.strokeWidth=g.childNodes[k].firstChild.nodeValue;if(g.nodeName=="PolyStyle")c.strokeWidth=g.childNodes[k].firstChild.nodeValue;break;default:console.log("not implemented",h,g[k])}}this.styles[b][g.tagName]=c}}return!1};this.parseGroundOverlay=function(a){if(!a)return!1;if(!a.nodeName=="GroundOverlay")return!1;var b=this.parseIcon(a),f=a.getElementsByTagName("LatLonBox")[0],e=f.getElementsByTagName("north")[0].childNodes[0].nodeValue,c=f.getElementsByTagName("east")[0].childNodes[0].nodeValue,
k=f.getElementsByTagName("south")[0].childNodes[0].nodeValue,h=f.getElementsByTagName("west")[0].childNodes[0].nodeValue;a={};if(f.getElementsByTagName("rotation")[0]!=void 0)f=f.getElementsByTagName("rotation")[0].childNodes[0].nodeValue,a.rotation=parseFloat(f);e=new khtml.maplib.geometry.Bounds(new khtml.maplib.LatLng(k,h),new khtml.maplib.LatLng(e,c));return new khtml.maplib.overlay.GroundOverlay(e,b,a)};this.parsePlacemark=function(a){if(!a)return!1;var b={};b.visibility=!0;for(var f=0;f<a.childNodes.length;f++){switch(a.childNodes[f].nodeName){case "name":if(a.childNodes[f].childNodes.length>
0&&typeof a.childNodes[f].childNodes[0].nodeValue!="undefined")b.name=a.childNodes[f].childNodes[0].nodeValue;break;case "description":if(a.childNodes[f].childNodes.length>0&&typeof a.childNodes[f].childNodes[0].nodeValue!="undefined")b.description=a.childNodes[f].childNodes[0].nodeValue;break;case "Point":b=this.parsePoint(a.childNodes[f]);break;case "LineString":b=this.parseLineString(a.childNodes[f]);break;case "Polygon":b=this.parsePolygon(a.childNodes[f]);break;case "gx:drawOrder":b.gxdraworder=
a.childNodes[f];break;case "visibility":b.visibility=parseInt(a.childNodes[f].childNodes[0].nodeValue)==1}var e=a.getElementsByTagName("styleUrl");if(e.length>0&&e[0].firstChild)e=e[0].firstChild.nodeValue,e.substring(1,e.length)}try{var c=a.getElementsByTagName("name").item(0).firstChild.nodeValue;b.properties.name=c}catch(k){}try{var h=a.getElementsByTagName("description").item(0).firstChild.nodeValue;b.properties.description=h}catch(l){}return b};this.parseLineString=function(a){try{var b=a.parentNode.getElementsByTagName("styleUrl").item(0).firstChild.nodeValue;
b=b.substring(1,b.length)}catch(f){}if(!a)return!1;a=this.parseCoordinates(a);a=new khtml.maplib.geometry.Feature({type:"LineString",coordinates:a[0]});a.className.baseVal="kml_linestring";this.styles[b]?a.style=this.styles[b].LineStyle.style:(a.style.stroke="blue",a.style.strokeWidth=4);return a};this.parsePolygon=function(a){if(!a)return!1;try{var b=a.parentNode.getElementsByTagName("styleUrl").item(0).firstChild.nodeValue;b=b.substring(1,b.length)}catch(f){}for(var e=new khtml.maplib.geometry.Feature({type:"Polygon"}),
c=0;c<a.childNodes.length;c++)switch(a.childNodes[c].nodeName){case "outerBoundaryIs":var k=this.parseCoordinates(a.childNodes[c]);e.geometry.coordinates=k[0];break;case "innerBoundaryIs":this.parseCoordinates(a.childNodes[c])}e.className+=" kml_polygon";if(this.styles[b])e.style=this.styles[b].PolyStyle;return e};this.parseCoordinates=function(a){a=a.getElementsByTagName("coordinates");var b=[];a.length==0&&(b[0]=[],b[0][0]=null);for(var f=0;f<a.length;f++){b[f]=[];for(var e="",c=0;c<a[f].childNodes.length;c++){var k=
a[f].childNodes[c].nodeValue;k!=null&&k.length>0&&(e+=k.trim())}e=e.split(/\s/);for(k=c=0;k<e.length;k++){var h=e[k].trim();h.length>0&&(h=h.split(","),b[f][c]=new khtml.maplib.LatLng(h[1],h[0]),c++)}}return b};this.parsePoint=function(a){var b=document.createElement("img");b.setAttribute("src","http://maps.google.com/mapfiles/kml/shapes/placemark_circle_highlight.png");a=(new this.parseCoordinates(a))[0][0];return new khtml.maplib.overlay.Marker(a,b)};this.parseIcon=function(a){var b=this._imgBasePath+
a.getElementsByTagName("href")[0].childNodes[0].nodeValue,f=null,e=document.createElement("img");e.setAttribute("src",b);if(a.getElementsByTagName("gx:x").length!=0||a.getElementsByTagName("gx:y").length!=0||a.getElementsByTagName("gx:w").length!=0||a.getElementsByTagName("gx:h").length!=0){f=document.createElement("div");b=a.getElementsByTagName("gx:w")[0].childNodes[0].nodeValue;var c=a.getElementsByTagName("gx:h")[0].childNodes[0].nodeValue;f.setAttribute("style","overflow: hidden; position: absolute; width: "+
b+"px; height: "+c+"px;");f.naturalWidth=b;f.naturalHeight=c;b=a.getElementsByTagName("gx:x")[0].childNodes[0].nodeValue;a=a.getElementsByTagName("gx:y")[0].childNodes[0].nodeValue;e.setAttribute("style","position: absolute; left: -"+b+"px; bottom: -"+a+"px;");e.naturalLeft=b*-1;e.naturalBottom=a*-1;f.appendChild(e)}else f=e;return f};this.generateFeature=function(){return!1};this.getMarkerForFeature=function(){return new khtml.maplib.displayable.ImageMarker(this.imageMarkerUrl())};this.setDom=function(a){this.dom=
typeof a=="string"?khtml.maplib.base.helpers.parseXml(a):a};this.imgBasePath=function(a){if(typeof a!="undefined")this._imgBasePath=a;return this._imgBasePath};this.imageMarkerUrl=function(a){if(typeof a!="undefined")this._imageMarkerUrl=a;return this._imageMarkerUrl};this.layers=[];this.folders=[];this._imgBasePath="";this.imageMarkerUrl("http://thydzik.com/thydzikGoogleMap/markerlink.php?color=5680FC");this.setDom(a)};khtml.maplib.ui.KeyBoard=function(){this.zoomtime=400;this.init=function(a){this.map=a;khtml.maplib.base.helpers.eventAttach(a.mapParent,"keydown",this.keydown,this,!1)};this.keydown=function(a){switch(a.keyCode){case 37:this.moveit(30,0);break;case 38:this.moveit(0,30);break;case 39:this.moveit(-30,0);break;case 40:this.moveit(0,-30);break;case 35:this.moveit(this.map.size.width*0.4,0);break;case 36:this.moveit(-this.map.size.width*0.4,0);break;case 33:this.moveit(0,this.map.size.height*0.4);break;
case 34:this.moveit(0,-this.map.size.height*0.4);break;case 187:case 61:case 43:this.zoomin();break;case 189:case 190:case 109:case 45:this.zoomout();break;default:return}a.preventDefault?a.preventDefault():a.returnValue=!1};this.render=function(){};this.zoomingIn=!1;this.zoomin=function(){var a=Math.ceil(this.map.zoom()+0.1);this.zoomingIn&&a++;this.map.animatedGoto(this.map.center(),a,this.zoomtime);var e=this;setTimeout(function(){e.zoomingIn=!1},this.zoomtime);this.zoomingIn=!0};this.zoomout=
function(){var a=Math.floor(this.map.zoom()-0.1);this.zoomingOut&&a--;this.map.animatedGoto(this.map.center(),a,this.zoomtime);var e=this;setTimeout(function(){e.zoomingOut=!1},this.zoomtime);this.zoomingOut=!0};this.keyup=function(){};this.moveit=function(a,e){for(var d=a/20,b=e/20,f=0;f<20;f++){var g=Math.cos(3*(-10+f)/20)*5;this.moveitexec(d*g,b*g,f)}};this.moveitexec=function(a,e,d){setTimeout(function(){this.map.moveXY(a,e)},20*d)}};khtml.maplib.ui.Zoombar=function(){this._cancelEvent=function(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation()};this._stopEventPropagation=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};this._calcZFromY=function(a){return 22-a/10};this._zoom=function(a){this.themap.zoom(this._calcZFromY(a.type=="touchstart"||a.type=="touchmove"?this.themap.pageY(a.touches[0]):this.themap.pageY(a)))};this._down=function(a){this._cancelEvent(a);this.moving=!0;this._zoom(a);this._stopEventPropagation(a)};
this._move=function(a){this._cancelEvent(a);this.moving&&(this._zoom(a),this.render(),this._stopEventPropagation(a))};this._up=function(a){this._cancelEvent(a);this.moving=!1;this._stopEventPropagation(a)};this.init=function(a){this.themap=a;a=a.mapParent.getElementsByTagName("*");for(var e=0;e<a.length;e++){var d=a.item(e);if(d.className=="scrollhandle")this.scrollhandle=d;if(d.className=="zoombar")this.zoombar=d}a=navigator.userAgent.indexOf("MSIE")!=-1?this.mapObj.mapParent:window;khtml.maplib.base.helpers.eventAttach(this.zoombar,
"mousedown",this.down,this,!1);khtml.maplib.base.helpers.eventAttach(this.zoombar,"mousemove",this.move,this,!1);khtml.maplib.base.helpers.eventAttach(a,"mouseup",this.up,this,!1);khtml.maplib.base.helpers.eventAttach(this.zoombar,"touchstart",this._down,this,!1);khtml.maplib.base.helpers.eventAttach(this.zoombar,"touchmove",this._move,this,!1);khtml.maplib.base.helpers.eventAttach(this.zoombar,"touchend",this._up,this,!1)};this.render=function(){this.scrollhandle.style.marginTop=(22-this.themap.zoom())*
10+"px"}};khtml.maplib.util.Http=function(){this._get=function(a,e,d,b){try{return jQuery.get(a,e,d,b)}catch(f){khtml.maplib.base.Log.warn("Exception occured! Did you include the jQuery library?"),khtml.maplib.base.Log.exception(f)}};this.get=function(a,e,d,b){return this._get(a,e,d,b).error(function(a){khtml.maplib.base.Log.error("khtml.maplib.util.Http.get(): request failed!",a)})}};khtml.maplib.util.Urlparam=function(a){HTTP_GET_VARS=[];strGET=document.location.search.substr(1,document.location.search.length);if(strGET!=""){gArr=strGET.split("&");for(i=0;i<gArr.length;++i)v="",vArr=gArr[i].split("="),vArr.length>1&&(v=vArr[1]),HTTP_GET_VARS[unescape(vArr[0])]=unescape(v)}this.GET=function(a){if(!HTTP_GET_VARS[a])return"undefined";return HTTP_GET_VARS[a]};this.GET("lat")!="undefined"&&this.GET("lon")!="undefined"&&a.center(new khtml.maplib.LatLng(parseFloat(this.GET("lat")),
parseFloat(this.GET("lon"))));this.GET("zoom")!="undefined"&&a.zoom(parseFloat(this.GET("zoom")));this.GET("mlat")!="undefined"&&this.GET("mlon")!="undefined"&&new khtml.maplib.overlay.Marker({position:new khtml.maplib.LatLng(parseFloat(this.GET("mlat")),parseFloat(this.GET("mlon"))),map:a})};
